<!DOCTYPE html> <html lang="ru"> <head> <meta charset="utf-8" /> <meta http-equiv="Content-Type" content="text/html; charset=utf-8" /> <meta name="viewport" content="width=device-width, initial-scale=1.0" /> <!--metatextblock--> <title>Главная</title> <meta property="og:url" content="http://home-secret.shop" /> <meta property="og:title" content="Главная" /> <meta property="og:description" content="" /> <meta property="og:type" content="website" /> <link rel="canonical" href="http://home-secret.shop"> <!--/metatextblock--> <meta name="format-detection" content="telephone=no" /> <meta http-equiv="x-dns-prefetch-control" content="on"> <link rel="dns-prefetch" href="https://ws.tildacdn.com"> <link rel="dns-prefetch" href="https://static.tildacdn.com"> <link rel="dns-prefetch" href="https://fonts.tildacdn.com"> <link rel="icon" type="image/png" sizes="32x32" href="https://static.tildacdn.com/tild6364-3264-4164-a132-336536326330/3.png" media="(prefers-color-scheme: light)"/> <link rel="icon" type="image/png" sizes="32x32" href="https://static.tildacdn.com/tild3664-6364-4762-b437-393033653835/3.png" media="(prefers-color-scheme: dark)"/> <!-- Assets --> <script src="https://neo.tildacdn.com/js/tilda-fallback-1.0.min.js" async charset="utf-8"></script> <link rel="stylesheet" href="https://static.tildacdn.com/css/tilda-grid-3.0.min.css" type="text/css" media="all" onerror="this.loaderr='y';"/> <link rel="stylesheet" href="https://static.tildacdn.com/ws/project13964339/tilda-blocks-page72607081.min.css?t=1764325165" type="text/css" media="all" onerror="this.loaderr='y';" /> <link rel="stylesheet" href="https://static.tildacdn.com/css/tilda-slds-1.4.min.css" type="text/css" media="print" onload="this.media='all';" onerror="this.loaderr='y';" /> <noscript><link rel="stylesheet" href="https://static.tildacdn.com/css/tilda-slds-1.4.min.css" type="text/css" media="all" /></noscript> <link rel="stylesheet" href="https://static.tildacdn.com/css/tilda-forms-1.0.min.css" type="text/css" media="all" onerror="this.loaderr='y';" /> <link rel="stylesheet" href="https://static.tildacdn.com/css/tilda-cart-1.0.min.css" type="text/css" media="all" onerror="this.loaderr='y';" /> <link rel="stylesheet" href="https://static.tildacdn.com/css/tilda-delivery-1.0.min.css" type="text/css" media="print" onload="this.media='all';" onerror="this.loaderr='y';" /> <noscript><link rel="stylesheet" href="https://static.tildacdn.com/css/tilda-delivery-1.0.min.css" type="text/css" media="all" /></noscript> <link rel="stylesheet" type="text/css" href="/custom.css?t=1764325165"> <script type="text/javascript">TildaFonts=["167","168","169","170"];</script> <script type="text/javascript" src="https://static.tildacdn.com/js/tilda-fonts.min.js" charset="utf-8" onerror="this.loaderr='y';"></script> <script nomodule src="https://static.tildacdn.com/js/tilda-polyfill-1.0.min.js" charset="utf-8"></script> <script type="text/javascript">function t_onReady(func) {if(document.readyState!='loading') {func();} else {document.addEventListener('DOMContentLoaded',func);}}
function t_onFuncLoad(funcName,okFunc,time) {if(typeof window[funcName]==='function') {okFunc();} else {setTimeout(function() {t_onFuncLoad(funcName,okFunc,time);},(time||100));}}function t_throttle(fn,threshhold,scope) {return function() {fn.apply(scope||this,arguments);};}</script> <script src="https://static.tildacdn.com/js/tilda-scripts-3.0.min.js" charset="utf-8" defer onerror="this.loaderr='y';"></script> <script src="https://static.tildacdn.com/ws/project13964339/tilda-blocks-page72607081.min.js?t=1764325165" charset="utf-8" async onerror="this.loaderr='y';"></script> <script src="https://static.tildacdn.com/js/tilda-lazyload-1.0.min.js" charset="utf-8" async onerror="this.loaderr='y';"></script> <script src="https://static.tildacdn.com/js/tilda-slds-1.4.min.js" charset="utf-8" async onerror="this.loaderr='y';"></script> <script src="https://static.tildacdn.com/js/hammer.min.js" charset="utf-8" async onerror="this.loaderr='y';"></script> <script src="https://static.tildacdn.com/js/tilda-video-1.0.min.js" charset="utf-8" async onerror="this.loaderr='y';"></script> <script src="https://static.tildacdn.com/js/tilda-forms-1.0.min.js" charset="utf-8" async onerror="this.loaderr='y';"></script> <script src="https://static.tildacdn.com/js/tilda-cart-1.1.min.js" charset="utf-8" async onerror="this.loaderr='y';"></script> <script src="https://static.tildacdn.com/js/tilda-widget-positions-1.0.min.js" charset="utf-8" async onerror="this.loaderr='y';"></script> <script src="https://static.tildacdn.com/js/tilda-delivery-1.0.min.js" charset="utf-8" async onerror="this.loaderr='y';"></script> <script src="https://static.tildacdn.com/js/tilda-events-1.0.min.js" charset="utf-8" async onerror="this.loaderr='y';"></script> <script type="text/javascript" src="https://static.tildacdn.com/js/tilda-buyer-dashboard-1.0.min.js" charset="utf-8" async onerror="this.loaderr='y';"></script> <script type="text/javascript">window.dataLayer=window.dataLayer||[];</script> <script type="text/javascript">(function() {if((/bot|google|yandex|baidu|bing|msn|duckduckbot|teoma|slurp|crawler|spider|robot|crawling|facebook/i.test(navigator.userAgent))===false&&typeof(sessionStorage)!='undefined'&&sessionStorage.getItem('visited')!=='y'&&document.visibilityState){var style=document.createElement('style');style.type='text/css';style.innerHTML='@media screen and (min-width: 980px) {.t-records {opacity: 0;}.t-records_animated {-webkit-transition: opacity ease-in-out .2s;-moz-transition: opacity ease-in-out .2s;-o-transition: opacity ease-in-out .2s;transition: opacity ease-in-out .2s;}.t-records.t-records_visible {opacity: 1;}}';document.getElementsByTagName('head')[0].appendChild(style);function t_setvisRecs(){var alr=document.querySelectorAll('.t-records');Array.prototype.forEach.call(alr,function(el) {el.classList.add("t-records_animated");});setTimeout(function() {Array.prototype.forEach.call(alr,function(el) {el.classList.add("t-records_visible");});sessionStorage.setItem("visited","y");},400);}
document.addEventListener('DOMContentLoaded',t_setvisRecs);}})();</script></head> <body class="t-body" style="margin:0;"> <!--allrecords--> <div id="allrecords" class="t-records" data-hook="blocks-collection-content-node" data-tilda-project-id="13964339" data-tilda-page-id="72607081" data-tilda-formskey="d1121d4f8ed8b2217d3e700d13964339" data-tilda-cookie="no" data-tilda-lazy="yes" data-tilda-project-lang="RU" data-tilda-root-zone="com" data-tilda-project-country="RU"> <!--header--> <header id="t-header" class="t-records" data-hook="blocks-collection-content-node" data-tilda-project-id="13964339" data-tilda-page-id="78807586" data-tilda-formskey="d1121d4f8ed8b2217d3e700d13964339" data-tilda-cookie="no" data-tilda-lazy="yes" data-tilda-project-lang="RU" data-tilda-root-zone="com" data-tilda-project-country="RU"> <div id="rec1316898641" class="r t-rec" style=" " data-animationappear="off" data-record-type="131"> <!-- T123 --> <div class="t123"> <div class="t-container_100 "> <div class="t-width t-width_100 "> <!-- nominify begin --> <!-- Шрифт: Circe --> <link rel="preload" href="REPLACE_WITH_CIRCE_REGULAR_WOFF2_URL" as="font" type="font/woff2" crossorigin> <link rel="preload" href="REPLACE_WITH_CIRCE_MEDIUM_WOFF2_URL"  as="font" type="font/woff2" crossorigin> <link rel="preload" href="REPLACE_WITH_CIRCE_BOLD_WOFF2_URL"    as="font" type="font/woff2" crossorigin> <style>
/* 1) Подключаем веса Circe (замени URL'ы на свои с Tilda Files) */
@font-face{
  font-family:"Circe";
  src:url("REPLACE_WITH_CIRCE_LIGHT_WOFF2_URL") format("woff2"),
      url("REPLACE_WITH_CIRCE_LIGHT_WOFF_URL") format("woff");
  font-weight:300;
  font-style:normal;
  font-display:swap;
}
@font-face{
  font-family:"Circe";
  src:url("REPLACE_WITH_CIRCE_REGULAR_WOFF2_URL") format("woff2"),
      url("REPLACE_WITH_CIRCE_REGULAR_WOFF_URL") format("woff");
  font-weight:400;
  font-style:normal;
  font-display:swap;
}
@font-face{
  font-family:"Circe";
  src:url("REPLACE_WITH_CIRCE_MEDIUM_WOFF2_URL") format("woff2"),
      url("REPLACE_WITH_CIRCE_MEDIUM_WOFF_URL") format("woff");
  font-weight:500;
  font-style:normal;
  font-display:swap;
}
@font-face{
  font-family:"Circe";
  src:url("REPLACE_WITH_CIRCE_BOLD_WOFF2_URL") format("woff2"),
      url("REPLACE_WITH_CIRCE_BOLD_WOFF_URL") format("woff");
  font-weight:700;
  font-style:normal;
  font-display:swap;
}

/* 2) Глобально включаем Circe */
:root{
  --hs-font:"Circe", system-ui, -apple-system, "Segoe UI", Roboto, Arial, "Noto Sans", "Helvetica Neue", "Liberation Sans", sans-serif;
}

/* Фон и базовый цвет текста для всего сайта */
html,
body{
  font-family:var(--hs-font);
  background-color:#f7f5f2;
  color:#3b332f;
  -webkit-font-smoothing:antialiased;
  -moz-osx-font-smoothing:grayscale;
  text-rendering:optimizeLegibility;
}

/* Основной контейнер Tilda тоже красим в #f7f5f2 */
.t-body{
  background-color:#f7f5f2 !important;
}

/* 3) Формы, кнопки, инпуты — наследуют Circe */
button,
input,
select,
textarea{
  font-family:inherit !important;
}

/* 4) Перебиваем локальные семейства Tilda/Zero */
.t-rec,
.t-container,
.t-popup,
.t-store,
.t706,
.t706__cartwin,
.t706__cartwin-content,
.t-input,
.t-btn,
.t-descr,
.t-title,
.t-name,
.tn-atom,
.tn-elem,
.t-menu,
.t396,
.t-card,
.t-slds,
.t-tabs,
.hs-root,
.hs-footer,
.hs-c3,
.product-card,
.product-title,
.variant-select,
.add-to-cart{
  font-family:var(--hs-font) !important;
}

/* Жёстко перебиваем inline «font-family: ...» и старые Gotham */
[class][style*="font-family"],
[style*="Gotham"],
[style*="gotham"]{
  font-family:var(--hs-font) !important;
}

/* Font Awesome и другие иконочные шрифты не трогаем */
</style> <!-- nominify end --> </div> </div> </div> </div> <div id="rec1317726611" class="r t-rec" style=" " data-animationappear="off" data-record-type="706"> <!--tcart--> <!-- @classes: t-text t-text_xs t-name t-name_xs t-name_md t-btn t-btn_sm --> <script>t_onReady(function() {setTimeout(function() {t_onFuncLoad('tcart__init',function() {tcart__init('1317726611',{cssClassName:''});});},50);var userAgent=navigator.userAgent.toLowerCase();var body=document.body;if(!body) return;if(userAgent.indexOf('instagram')!==-1&&userAgent.indexOf('iphone')!==-1) {body.style.position='relative';}
var rec=document.querySelector('#rec1317726611');if(!rec) return;var cartWindow=rec.querySelector('.t706__cartwin,.t706__cartpage');var allRecords=document.querySelector('.t-records');var currentMode=allRecords.getAttribute('data-tilda-mode');if(cartWindow&&currentMode!=='edit'&&currentMode!=='preview') {cartWindow.addEventListener('scroll',t_throttle(function() {if(window.lazy==='y'||document.querySelector('#allrecords').getAttribute('data-tilda-lazy')==='yes') {t_onFuncLoad('t_lazyload_update',function() {t_lazyload_update();});}},500));}});</script> <div class="t706" data-cart-countdown="yes" data-project-currency="р." data-project-currency-side="r" data-project-currency-sep="," data-project-currency-code="RUB" data-payment-system="yakassa" data-cart-sendevent-onadd="y"> <div class="t706__carticon t706__carticon_sm" style="top:20px;bottom:initial;right:20px;"> <div class="t706__carticon-text t-name t-name_xs"></div> <div class="t706__carticon-wrapper"> <div class="t706__carticon-imgwrap"> <div class="t706__bgimg t-bgimg" bgimgfield="img" data-original="https://static.tildacdn.com/tild3736-3964-4364-b432-373133633065/ChatGPT_Image_1__202.png" style="background-image: url('https://thb.tildacdn.com/tild3736-3964-4364-b432-373133633065/-/resizeb/20x/ChatGPT_Image_1__202.png');"></div> </div> <div class="t706__carticon-counter js-carticon-counter"></div> </div> </div> <div class="t706__cartwin" style="display: none;"> <div class="t706__close t706__cartwin-close"> <button type="button" class="t706__close-button t706__cartwin-close-wrapper" aria-label="Закрыть корзину"> <svg role="presentation" class="t706__close-icon t706__cartwin-close-icon" width="23px" height="23px" viewBox="0 0 23 23" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"> <g stroke="none" stroke-width="1" fill="#fff" fill-rule="evenodd"> <rect transform="translate(11.313708, 11.313708) rotate(-45.000000) translate(-11.313708, -11.313708) " x="10.3137085" y="-3.6862915" width="2" height="30"></rect> <rect transform="translate(11.313708, 11.313708) rotate(-315.000000) translate(-11.313708, -11.313708) " x="10.3137085" y="-3.6862915" width="2" height="30"></rect> </g> </svg> </button> </div> <div class="t706__cartwin-content"> <div class="t706__cartwin-top"> <div class="t706__cartwin-heading t-name t-name_xl"></div> </div> <div class="t706__cartwin-products"></div> <div class="t706__cartwin-bottom"> <div class="t706__cartwin-prodamount-wrap t-descr t-descr_sm"> <span class="t706__cartwin-prodamount-label"></span> <span class="t706__cartwin-prodamount"></span> </div> </div> <div class="t706__orderform "> <form
id="form1317726611" name='form1317726611' role="form" action='' method='POST' data-formactiontype="2" data-inputbox=".t-input-group" 
class="t-form js-form-proccess t-form_inputs-total_5 " data-formsended-callback="t706_onSuccessCallback"> <input type="hidden" name="formservices[]" value="736f74c12fa83a3c0bda0477b9eca6d5" class="js-formaction-services"> <input type="hidden" name="formservices[]" value="dccc884ff4da323aa9c1abf863ea49c4" class="js-formaction-services"> <input type="hidden" name="tildaspec-formname" tabindex="-1" value="Cart"> <!-- @classes t-title t-text t-btn --> <div class="js-successbox t-form__successbox t-text t-text_md"
aria-live="polite"
style="display:none;"></div> <div
class="t-form__inputsbox
t-form__inputsbox_inrow "> <div
class=" t-input-group t-input-group_nm " data-input-lid="8812535522860" data-field-type="nm" data-field-name="Name"> <label
for='input_8812535522860'
class="t-input-title t-descr t-descr_md"
id="field-title_8812535522860" data-redactor-toolbar="no"
field="li_title__8812535522860"
style="color:;font-weight:600;font-family: 'Circe';">Имя</label> <div class="t-input-block " style="border-radius:15px;"> <input
type="text"
autocomplete="name"
name="Name"
id="input_8812535522860"
class="t-input js-tilda-rule"
value="" data-tilda-req="1" aria-required="true" data-tilda-rule="name"
aria-describedby="error_8812535522860"
style="color:#000000;border:1px solid #000000;border-radius:15px;"> </div> <div class="t-input-error" aria-live="polite" id="error_8812535522860"></div> </div> <div
class=" t-input-group t-input-group_em " data-input-lid="8812535522861" data-field-type="em" data-field-name="Email"> <label
for='input_8812535522861'
class="t-input-title t-descr t-descr_md"
id="field-title_8812535522861" data-redactor-toolbar="no"
field="li_title__8812535522861"
style="color:;font-weight:600;font-family: 'Circe';">Email</label> <div class="t-input-block " style="border-radius:15px;"> <input
type="email"
autocomplete="email"
name="Email"
id="input_8812535522861"
class="t-input js-tilda-rule"
value="" data-tilda-req="1" aria-required="true" data-tilda-rule="email"
aria-describedby="error_8812535522861"
style="color:#000000;border:1px solid #000000;border-radius:15px;"> </div> <div class="t-input-error" aria-live="polite" id="error_8812535522861"></div> </div> <div
class=" t-input-group t-input-group_ph " data-input-lid="8812535522862" data-field-async="true" data-field-type="ph" data-field-name="Phone"> <div class="t-input-block " style="border-radius:15px;"> <input
type="tel"
autocomplete="tel"
name="Phone"
id="input_8812535522862" data-phonemask-init="no" data-phonemask-id="1317726611" data-phonemask-lid="8812535522862"
class="t-input js-phonemask-input js-tilda-rule"
value=""
placeholder="+1(000)000-0000" data-tilda-req="1" aria-required="true" aria-describedby="error_8812535522862"
style="color:#000000;border:1px solid #000000;border-radius:15px;"> <script type="text/javascript">t_onReady(function() {t_onFuncLoad('t_loadJsFile',function() {t_loadJsFile('https://static.tildacdn.com/js/tilda-phone-mask-1.1.min.js',function() {t_onFuncLoad('t_form_phonemask_load',function() {var phoneMasks=document.querySelectorAll('#rec1317726611 [data-phonemask-lid="8812535522862"]');t_form_phonemask_load(phoneMasks);});})})});</script> </div> <div class="t-input-error" aria-live="polite" id="error_8812535522862"></div> </div> <div
class=" t-input-group t-input-group_pc " data-input-lid="1758175454938" data-field-type="pc" data-field-name="Промокод"> <div
class="t-input-title t-descr t-descr_md"
id="field-title_1758175454938" data-redactor-toolbar="no"
field="li_title__1758175454938"
style="color:;font-weight:600;font-family: 'Circe';">Промокод</div> <div class="t-input-block " style="border-radius:15px;"> <style>.t-inputpromocode__wrapper .t-text{color:#000;}</style> <div class="t-inputpromocode__wrapper" style="display:table;width:100%;"> <input
type="text"
name="Промокод"
class="t-input t-inputpromocode js-tilda-rule"
value=""
placeholder="Введите промокод" style="display:table-cell;color:#000000;border:1px solid #000000;border-radius:15px;" data-tilda-rule="promocode"> <div
class="t-inputpromocode__btn t-btn t-btn_md"
style="display:none;position:relative;height:auto;color:#fff;background:#000;border-radius:15px; -moz-border-radius: 15px; -webkit-border-radius: 15px;">Активировать</div> </div> <script src="https://static.tildacdn.com/js/tilda-promocode-1.0.min.js"></script> <script>t_onReady(function() {try {t_onFuncLoad('t_input_promocode_init',function() {t_input_promocode_init('1317726611','1758175454938');});} catch(error) {console.error(error);}});</script> </div> <div class="t-input-error" aria-live="polite" id="error_1758175454938"></div> </div> <div
class=" t-input-group t-input-group_dl " data-input-lid="8812535522863" data-field-type="dl" data-field-name="Delivery"> <div class="t-input-block " style="border-radius:15px;"> <div
class="t-radio__wrapper t-radio__wrapper-delivery" data-delivery-variants-hook='y' data-delivery-free='5000' data-delivery-services="y"
id="customdelivery"> <div class="t-input-group t-input-group_in"> <div class="t-input-block"> <input
class="js-tilda-rule t-input" data-tilda-rule="deliveryreq"
type="hidden"
name="delivery-badresponse-comment"
value="nodelivery"
autocomplete="off" data-tilda-req="1"> <div class="t-input-error" aria-live="polite"></div> </div> </div> </div> <style>#rec1317726611 .t706 .t-form__inputsbox #customdelivery .t-input{color:#000000;border:1px solid #000000;border-radius:15px;-moz-border-radius:15px;-webkit-border-radius:15px;}#rec1317726611 .t706 .t-form__inputsbox #customdelivery .t-input-title{font-weight:600;font-family:'Circe';}</style> </div> <div class="t-input-error" aria-live="polite" id="error_8812535522863"></div> </div> <div class="t-form__errorbox-middle"> <!--noindex--> <div
class="js-errorbox-all t-form__errorbox-wrapper"
style="display:none;" data-nosnippet
tabindex="-1"
aria-label="Ошибки при заполнении формы"> <ul
role="list"
class="t-form__errorbox-text t-text t-text_md"> <li class="t-form__errorbox-item js-rule-error js-rule-error-all"></li> <li class="t-form__errorbox-item js-rule-error js-rule-error-req"></li> <li class="t-form__errorbox-item js-rule-error js-rule-error-email"></li> <li class="t-form__errorbox-item js-rule-error js-rule-error-name"></li> <li class="t-form__errorbox-item js-rule-error js-rule-error-phone"></li> <li class="t-form__errorbox-item js-rule-error js-rule-error-minlength"></li> <li class="t-form__errorbox-item js-rule-error js-rule-error-string"></li> </ul> </div> <!--/noindex--> </div> <div class="t-form__submit"> <button
class="t-submit t-btnflex t-btnflex_type_submit t-btnflex_md"
type="submit"> <span class="t-btnflex__text">Оформить заказ</span> <style>#rec1317726611 .t-btnflex.t-btnflex_type_submit {color:#ffffff;background-color:#000000;border-style:none !important;border-radius:15px;box-shadow:none !important;transition-duration:0.2s;transition-property:background-color,color,border-color,box-shadow,opacity,transform,gap;transition-timing-function:ease-in-out;}</style> </button> </div> </div> <div class="t-form__errorbox-bottom"> <!--noindex--> <div
class="js-errorbox-all t-form__errorbox-wrapper"
style="display:none;" data-nosnippet
tabindex="-1"
aria-label="Ошибки при заполнении формы"> <ul
role="list"
class="t-form__errorbox-text t-text t-text_md"> <li class="t-form__errorbox-item js-rule-error js-rule-error-all"></li> <li class="t-form__errorbox-item js-rule-error js-rule-error-req"></li> <li class="t-form__errorbox-item js-rule-error js-rule-error-email"></li> <li class="t-form__errorbox-item js-rule-error js-rule-error-name"></li> <li class="t-form__errorbox-item js-rule-error js-rule-error-phone"></li> <li class="t-form__errorbox-item js-rule-error js-rule-error-minlength"></li> <li class="t-form__errorbox-item js-rule-error js-rule-error-string"></li> </ul> </div> <!--/noindex--> </div> </form> <style>#rec1317726611 input::-webkit-input-placeholder {color:#000000;opacity:0.5;}#rec1317726611 input::-moz-placeholder{color:#000000;opacity:0.5;}#rec1317726611 input:-moz-placeholder {color:#000000;opacity:0.5;}#rec1317726611 input:-ms-input-placeholder{color:#000000;opacity:0.5;}#rec1317726611 textarea::-webkit-input-placeholder {color:#000000;opacity:0.5;}#rec1317726611 textarea::-moz-placeholder{color:#000000;opacity:0.5;}#rec1317726611 textarea:-moz-placeholder {color:#000000;opacity:0.5;}#rec1317726611 textarea:-ms-input-placeholder{color:#000000;opacity:0.5;}</style> </div> </div> </div> <div class="t706__cartdata"> </div> </div> <style></style> <!--/tcart--> </div> <div id="rec1317476821" class="r t-rec" style=" " data-animationappear="off" data-record-type="131"> <!-- T123 --> <div class="t123"> <div class="t-container_100 "> <div class="t-width t-width_100 "> <!-- nominify begin --> <!-- BLOCK 1: Global Styles + Icons (UPDATED — без шрифтов, светло-бежевый фон #f7f5f2) --> <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"> <style>
  * { margin: 0; padding: 0; box-sizing: border-box; }

  html{
    overflow-x: hidden; /* Глобально убираем горизонтальный скролл, не трогая вертикальный */
  }

  body {
    font-family: inherit;
    background-color: #f7f5f2;
    color: #000;
    padding-top: 72px;           /* было 80px — под уменьшенную шапку */
    line-height: 1.6;
  }

  /* Шапка */
  .header {
    background-color: #fff;
    padding: 16px 0;             /* было 20px — белая полоса стала чуть ниже */
    position: fixed;
    width: 100%;
    top: 0;
    z-index: 1000;
    box-shadow: 0 2px 20px rgba(0,0,0,.08);
    border-bottom: 1px solid rgba(0,0,0,.05);
  }
  .header-container {
    max-width: 1400px; margin: 0 auto; padding: 0 20px;
    display: flex; justify-content: space-between; align-items: center; position: relative;
  }
  .logo { position: absolute; left: 50%; top: 50%; transform: translate(-50%,-50%); width: 88px; /* было 100px */ z-index: 1001; }
  .logo img { width: 100%; height: auto; transition: transform .4s ease; }
  .logo:hover img { transform: scale(1.1) rotate(-5deg); }

  .nav-container { display: flex; width: 100%; justify-content: space-between; }
  .nav-left,.nav-right { display: flex; width: 45%; position: relative; }
  .nav-left { justify-content: flex-end; padding-right: 80px; }
  .nav-right { justify-content: flex-start; padding-left: 80px; }
  .nav-menu { display: flex; list-style: none; }
  .nav-item { margin: 0 15px; }
  .nav-link {
    text-decoration: none; color: #000 !important; font-size: 16px;
    letter-spacing: 1.2px; position: relative; padding: 8px 0;
    transition: all .3s ease; display: inline-block; text-transform: lowercase;
  }
  .nav-link:hover { color: #b99f94 !important; transform: translateY(-2px); }
  .nav-link::after {
    content: ''; position: absolute; bottom: 0; left: 0; width: 0; height: 1px;
    background-color: #b99f94; transition: width .4s ease;
  }
  .nav-link:hover::after { width: 100%; }

  .nav-icons { display: flex; align-items: center; gap: 20px; position: absolute; right: 20px; }
  .icon-container {
    position: relative; display:flex; align-items:center; justify-content:center;
    width: 38px; height: 38px; border-radius: 50%; background:#fff; cursor: pointer;
    transition: all .3s ease; box-shadow: 0 3px 10px rgba(0,0,0,.1);
  }
  .icon-container:hover { transform: scale(1.1); background: #f7f5f2; }
  .icon-container i { font-size: 18px; color: #333; }
  .icon-container.active i { color: #e63946; }
  .icon-badge {
    position:absolute; top:-5px; right:-5px; background:#e63946; color:#fff;
    font-size:10px; width:18px; height:18px; border-radius:50%;
    display:flex; align-items:center; justify-content:center; font-weight:bold;
  }
  .cart-icon-container i { font-size: 20px; }

  /* Панели избранного/корзины/аккаунта */
  .side-panel {
    position: fixed; top: 0; right: -450px; width: 450px; height: 100%;
    background:#fff; z-index:2000; box-shadow: -5px 0 25px rgba(0,0,0,.1);
    transition: transform .4s cubic-bezier(.22,.61,.36,1); overflow-y: auto; padding: 30px 25px;
  }
  .side-panel.active { transform: translateX(-450px); }
  .panel-overlay {
    position: fixed; top:0; left:0; width:100%; height:100%;
    background: rgba(0,0,0,.5); z-index:1999; display:none;
  }
  .panel-overlay.active { display:block; }
  .panel-header {
    display:flex; justify-content:space-between; align-items:center; margin-bottom:25px;
    padding-bottom:15px; border-bottom:1px solid #eee;
  }
  .panel-header h2 { font-size:24px; font-weight:400; color:#000; letter-spacing:1px; margin:0; }
  .close-panel { background:none; border:none; font-size:22px; cursor:pointer; color:#5a4a42; transition:all .3s ease; }
  .close-panel:hover { transform: rotate(90deg); color:#b99f94; }

  /* Аккаунт */
  .account-panel .auth-tabs { display:flex; gap:8px; margin-bottom:15px; }
  .auth-tab {
    flex:1; text-align:center; padding:10px 12px; border:1px solid #e6e0d8; border-radius:8px; cursor:pointer;
    background:#f7f5f2; font-size:14px; transition:.2s;
  }
  .auth-tab.active { background:#E8DED4; border-color:#816856; color:#000; }
  .auth-form { display:none; }
  .auth-form.active { display:block; }
  .form-row { display:flex; flex-direction:column; gap:8px; margin-bottom:14px; }
  .form-label { font-size:13px; color:#7a6d66; }
  .form-input {
    width:100%; padding:12px 14px; background:#f7f5f2; border:1px solid #e6e0d8; border-radius:8px; font-size:15px; color:#5a4a42;
    font-family: inherit;
  }
  .btn-primary {
    width:100%; padding:12px 16px; border:none; border-radius:8px; background:#5a4a42; color:#fff; font-size:15px; cursor:pointer;
    font-family: inherit;
  }
  .btn-primary:hover { background:#b99f94; }
  .auth-hint { font-size:12px; color:#7a6d66; margin-top:6px; }
  .auth-divider { text-align:center; font-size:12px; color:#7a6d66; margin:12px 0; position:relative; }
  .auth-divider:before, .auth-divider:after { content:''; position:absolute; top:50%; width:40%; height:1px; background:#eee; }
  .auth-divider:before { left:0; } .auth-divider:after { right:0; }
  .social-row { display:flex; gap:10px; }
  .btn-social {
    flex:1; display:flex; align-items:center; justify-content:center; gap:8px; padding:10px 12px; background:#f7f5f2; border:1px solid #e6e0d8; border-radius:8px; cursor:pointer;
  }
  .btn-social:hover { background:#f0ece6; }
  .account-links { display:flex; justify-content:space-between; font-size:13px; margin-top:10px; }
  .account-links a { color:#5a4a42; text-decoration:none; }
  .account-links a:hover { color:#b99f94; }

  /* Карусель (герой) */
  .carousel-container {
    position:relative; width:100%; height:100vh; overflow:hidden;
    margin-top:-72px;              /* было -80px */
    padding-top:72px;              /* было 80px */
    background:#f7f5f2;
  }
  .carousel { display:flex; height:100%; transition: transform .8s cubic-bezier(.22,.61,.36,1); }
  .carousel-slide { flex:0 0 100%; height:100%; position:relative; display:flex; justify-content:center; align-items:center; }
  .slide-content { width:100%; height:100%; position:relative; overflow:hidden; display:flex; justify-content:center; align-items:center; }
  .carousel-slide img {
    height:100%; width:auto; max-width:100%; object-fit:cover; display:block; transition: transform 1.2s ease; filter: brightness(.98);
    box-shadow: 0 25px 50px rgba(0,0,0,.15);
  }
  .slide-content:hover img { transform: scale(1.03); filter: brightness(1); }
  .slide-info {
    position:absolute; bottom:50px; left:50px; background: rgba(255,255,255,.85);
    padding:25px 35px; border-radius:8px; max-width:450px; z-index:5; opacity:0; transform: translateY(20px);
    animation: slideUpFadeIn .8s forwards .5s;
  }
  @keyframes slideUpFadeIn { from { opacity:0; transform: translateY(20px); } to { opacity:1; transform: translateY(0); } }
  .slide-info h3 { font-size:28px; margin-bottom:10px; color:#5a4a42; font-weight:400; letter-spacing:1px; }
  .slide-info p { font-size:18px; line-height:1.6; color:#7a6d66; margin-bottom:15px; }
  .slide-info p:last-child { margin-bottom:0; }

  .carousel-button {
    position:absolute; top:50%; transform: translateY(-50%); background: rgba(255,255,255,.9); border:none;
    width:60px; height:60px; border-radius:50%; cursor:pointer; z-index:10; display:flex; align-items:center; justify-content:center;
    font-size:26px; transition: all .3s ease; color:#333; box-shadow: 0 8px 20px rgba(0,0,0,.15); opacity:.8;
  }
  .carousel-button:hover { background:#fff; transform: translateY(-50%) scale(1.1); opacity:1; }
  .carousel-button.prev { left:30px; } .carousel-button.next { right:30px; }

  /* Раздел товаров */
  .products-section { padding: 100px 20px; background:#f7f5f2; max-width:1400px; margin:0 auto; overflow-x:hidden; }
  .section-title { text-align:center; font-size:32px; font-weight:400; letter-spacing:1.5px; margin-bottom:60px; color:#5a4a42; position:relative; }
  .section-title::after { content:''; display:block; width:80px; height:1px; background:#b99f94; margin:15px auto 0; }
  .products-container { display:flex; flex-wrap:wrap; justify-content:center; gap:40px; }
  .product-card {
    width:100%; max-width:380px; background:#fff; border-radius:12px; overflow:hidden;
    box-shadow: 0 15px 40px rgba(0,0,0,.08); transition: transform .4s ease, box-shadow .4s ease; position:relative; cursor:pointer;
    content-visibility: auto; contain-intrinsic-size: 480px 380px;
  }
  .product-card:hover { transform: translateY(-10px); box-shadow: 0 20px 50px rgba(0,0,0,.15); }
  .product-gallery { position:relative; height:480px; overflow:hidden; }
  .gallery-images { position:relative; height:100%; overflow:hidden; }
  .gallery-image { position:absolute; top:0; left:0; width:100%; height:100%; object-fit:cover; border-radius:12px 12px 0 0; transition: opacity .3s ease; backface-visibility:hidden; will-change: opacity; }
  .gallery-image:not(:first-child){ opacity:0; }
  .product-card:hover .gallery-image:first-child { opacity:0; }
  .product-card:hover .gallery-image:not(:first-child){ opacity:1; }

  .favorite-btn {
    position:absolute; top:20px; right:20px; width:38px; height:38px; background: rgba(255,255,255,.85);
    border-radius:50%; display:flex; align-items:center; justify-content:center; cursor:pointer; z-index:10; transition:all .3s ease; border:none;
    box-shadow: 0 3px 10px rgba(0,0,0,.1);
  }
  .favorite-btn i { font-size:18px; color:#333; transition: all .3s ease; }
  .favorite-btn:hover { transform: scale(1.1); background: rgba(255,255,255,.95); }
  .favorite-btn.active i { color:#e63946; }

  .product-info { padding:25px; }
  .product-title { font-size:22px; font-weight:400; color:#5a4a42; margin-bottom:10px; letter-spacing:.5px; }
  .product-price { font-size:20px; color:#7a6d66; margin-bottom:20px; font-weight:500; }

  .product-variants { margin-bottom:25px; position:relative; }
  .variants-label { display:block; font-size:14px; color:#7a6d66; margin-bottom:8px; letter-spacing:.5px; }
  .variant-select {
    width:100%; padding:12px 15px; background:#f7f5f2; border:1px solid #e6e0d8; border-radius:6px; font-size:15px; color:#5a4a42;
    font-family: inherit; appearance:none; position:relative;
    background-image:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='8' viewBox='0 0 12 8'%3E%3Cpath fill='%235a4a42' d='M6 8L0 0h12L6 8z'/%3E%3C/svg%3E");
    background-repeat:no-repeat; background-position:right 15px center; background-size:12px; cursor:pointer; transition: all .3s ease;
  }
  .variant-select:hover,.variant-select:focus { background:#f0ece6; border-color:#b99f94; outline:none; }

  .add-to-cart {
    display:block; width:100%; padding:12px; background:#5a4a42; color:#fff; border:none; border-radius:6px;
    font-family: inherit; font-size:15px; letter-spacing:1px; cursor:pointer; transition: all .3s ease; position:relative; overflow:hidden;
  }
  .add-to-cart:hover { background:#b99f94; transform: translateY(-2px); }
  .add-to-cart:focus:not(:active)::after {
    content:''; position:absolute; top:50%; left:50%; width:5px; height:5px; background: rgba(255,255,255,.5); opacity:0; border-radius:100%;
    transform: scale(1) translate(-50%); animation: ripple 1s ease-out;
  }
  @keyframes ripple { 0%{transform:scale(0);opacity:1}20%{transform:scale(25);opacity:0}100%{transform:scale(40);opacity:0} }

  /* Модалка товара */
  .modal { display:none; position:fixed; top:0; left:0; width:100%; height:100%; background: rgba(0,0,0,.8); z-index:2000; overflow-y:auto; padding:20px; box-sizing:border-box; }
  .modal-content { background:#fff; max-width:900px; margin:50px auto; border-radius:12px; overflow:hidden; box-shadow: 0 25px 50px rgba(0,0,0,.3); position:relative; }
  .close-modal { position:absolute; top:20px; right:20px; width:40px; height:40px; background: rgba(255,255,255,.9); border:none; border-radius:50%; cursor:pointer; z-index:10; display:flex; align-items:center; justify-content:center; font-size:22px; transition:all .3s ease; }
  .close-modal:hover { transform: rotate(90deg); background:#b99f94; color:#fff; }
  .modal-body { display:flex; flex-direction:column; }
  @media (min-width:768px){ .modal-body { flex-direction:row; } }
  .modal-gallery { flex:1; min-height:500px; position:relative; }
  .modal-info { flex:1; padding:40px; display:flex; flex-direction:column; }
  .modal-title { font-size:32px; font-weight:400; color:#5a4a42; margin-bottom:15px; }
  .modal-price { font-size:26px; color:#7a6d66; margin-bottom:25px; font-weight:500; }
  .modal-description { font-size:16px; line-height:1.7; color:#7a6d66; margin-bottom:30px; }
  .modal-variants { margin-bottom:30px; }
  .modal-add-to-cart {
    display:block; width:100%; padding:15px; background:#5a4a42; color:#fff; border:none; border-radius:6px; font-family: inherit; font-size:16px; letter-spacing:1px; cursor:pointer; transition:all .3s ease; margin-top:auto;
  }
  .modal-add-to-cart:hover { background:#b99f94; transform: translateY(-2px); }

  /* Переход страницы */
  .page-transition { position:fixed; top:0; left:0; width:100%; height:100%; background:#f7f5f2; z-index:9999; display:flex; justify-content:center; align-items:center; opacity:0; pointer-events:none; transition: opacity .6s ease; }
  .page-transition.active { opacity:1; pointer-events:all; }
  .loading-spinner { width:60px; height:60px; border:5px solid rgba(185,159,148,.3); border-radius:50%; border-top-color:#b99f94; animation: spin 1s linear infinite; }
  @keyframes spin { to { transform: rotate(360deg); } }

  /* Как выбрать аромат */
  .aroma-section { padding:40px 20px; background:#f7f5f2; max-width:1400px; margin:0 auto; overflow-x:hidden; }
  .aroma-content { display:flex; flex-direction:column; align-items:center; gap:40px; max-width:900px; margin:0 auto; }
  .aroma-intro { text-align:center; font-size:18px; line-height:1.7; color:#7a6d66; margin-bottom:30px; }
  .aroma-selector { width:100%; max-width:400px; margin-bottom:40px; }
  .aroma-label { display:block; font-size:16px; color:#5a4a42; margin-bottom:15px; text-align:center; letter-spacing:1px; }
  .aroma-select {
    width:100%; padding:15px 20px; background:#f7f5f2; border:1px solid #e6e0d8; border-radius:8px; font-size:16px; color:#5a4a42;
    font-family: inherit; appearance:none; position:relative;
    background-image:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='8' viewBox='0 0 12 8'%3E%3Cpath fill='%235a4a42' d='M6 8L0 0h12L6 8z'/%3E%3C/svg%3E");
    background-repeat:no-repeat; background-position:right 20px center; background-size:12px; cursor:pointer; transition: all .3s ease; text-align:center;
  }
  .aroma-select:hover,.aroma-select:focus { background:#f0ece6; border-color:#b99f94; outline:none; box-shadow: 0 5px 15px rgba(0,0,0,.08); }

  .pyramid-container {
    width:100%; max-width:500px; margin:0 auto; position:relative; height:400px; display:flex; justify-content:center; align-items:flex-end;
    overflow:hidden; /* Важно: обрезаем выступающую пирамиду, чтобы не было горизонтального скролла */
  }
  .pyramid { width:100%; height:100%; position:relative; display:flex; flex-direction:column; align-items:center; justify-content:flex-end; }
  .pyramid-layer {
    width:100%; position:absolute; display:flex; flex-direction:column; align-items:center; justify-content:center;
    transition: all .5s ease; text-align:center; padding:20px; box-sizing:border-box; z-index:1; border-radius:8px; background: rgba(255,255,255,.9);
    box-shadow: 0 10px 30px rgba(0,0,0,.1); border:1px solid rgba(185,159,148,.1);
  }
  .pyramid-layer.top { width:50%; height:25%; top:0; animation: fadeIn .8s forwards; z-index:4; background: rgba(255,255,255,.95); }
  .pyramid-layer.middle { width:70%; height:30%; top:25%; animation: fadeIn .8s forwards .2s; z-index:3; background: rgba(255,255,255,.92); }
  .pyramid-layer.base { width:90%; height:45%; top:55%; animation: fadeIn .8s forwards .4s; z-index:2; background: rgba(255,255,255,.9); }
  .pyramid-layer-title { font-size:18px; font-weight:500; color:#5a4a42; margin-bottom:10px; letter-spacing:1px; }
  .pyramid-layer-notes { font-size:16px; color:#b99f94; font-weight:500; line-height:1.4; }
  .pyramid-layer:hover { transform: translateY(-5px) scale(1.02); box-shadow: 0 15px 40px rgba(0,0,0,.15); z-index:10; }
  .pyramid-triangle { position:absolute; width:0; height:0; border-left:250px solid transparent; border-right:250px solid transparent; border-bottom:400px solid rgba(185,159,148,.05); z-index:0; }
  .pyramid-connector { position:absolute; height:100%; width:2px; background: rgba(185,159,148,.2); z-index:0; left:50%; transform: translateX(-50%); }
  @keyframes fadeIn { from { opacity:0; transform: translateY(20px);} to { opacity:1; transform: translateY(0);} }

  /* Обо мне */
  .about-section { padding:100px 20px; background:#fff; max-width:1400px; margin:0 auto; overflow-x:hidden; }
  .about-container { display:flex; align-items:center; gap:50px; max-width:1200px; margin:0 auto; }
  .about-text { flex:1; }
  .about-text h2 { font-size:32px; font-weight:400; letter-spacing:1.5px; margin-bottom:30px; color:#5a4a42; position:relative; }
  .about-text h2::after { content:''; display:block; width:80px; height:1px; background:#b99f94; margin:15px 0 30px; }
  .about-text p { font-size:18px; line-height:1.7; color:#5a4a42; margin-bottom:25px; }
  .about-image { flex:1; border-radius:12px; overflow:hidden; box-shadow: 0 15px 40px rgba(0,0,0,.1); }
  .about-image img { width:100%; height:auto; display:block; }

  /* Отзывы */
  .reviews-section { padding:100px 20px; background:#f7f5f2; max-width:1400px; margin:0 auto; position:relative; overflow-x:hidden; }
  .section-title-container { display:flex; align-items:center; justify-content:center; margin-bottom:60px; }
  .reviews-title { text-align:center; font-size:32px; font-weight:400; letter-spacing:1.5px; color:#5a4a42; position:relative; margin:0; }
  .reviews-title::after { content:''; display:block; width:80px; height:1px; background:#b99f94; margin:15px auto 0; }
  .reviews-nav { position:absolute; top:50%; transform: translateY(-50%); width:100%; display:flex; justify-content:space-between; padding:0 20px; z-index:10; }
  .review-nav-btn { width:50px; height:50px; background:#fff; border:none; border-radius:50%; cursor:pointer; display:flex; align-items:center; justify-content:center; font-size:24px; color:#5a4a42; transition: all .3s ease; box-shadow: 0 5px 15px rgba(0,0,0,.1); }
  .review-nav-btn:hover { background:#b99f94; color:#fff; transform: scale(1.1); }
  .reviews-container { display:grid; grid-template-columns: repeat(auto-fit,minmax(300px,1fr)); gap:30px; max-width:1200px; margin:0 auto; }
  .review { background:#fff; border-radius:12px; padding:30px; box-shadow: 0 10px 30px rgba(0,0,0,.05); position:relative; content-visibility:auto; contain-intrinsic-size: 220px 300px; }
  .review:before { content: "“"; position:absolute; top:20px; left:20px; font-size:80px; color:#b99f94; opacity:.2; font-family: Georgia, serif; line-height:1; }
  .review-content { position:relative; z-index:2; }
  .review p { font-size:16px; line-height:1.7; color:#5a4a42; margin-bottom:20px; font-style: italic; }
  .review-author { font-weight:500; color:#b99f94; text-align:right; font-size:16px; }

  /* Корзина — строки, qty и итог */
  .cart-list { display:flex; flex-direction:column; gap:14px; }
  .cart-item {
    display:flex; gap:14px; align-items:center; background:#f7f5f2; padding:12px; border-radius:10px; border:1px solid #eee;
  }
  .cart-item-image { width:70px; height:70px; border-radius:8px; overflow:hidden; flex:0 0 70px; }
  .cart-item-image img { width:100%; height:100%; object-fit:cover; }
  .cart-item-info { flex:1; min-width:0; }
  .cart-item-title { font-size:16px; color:#5a4a42; font-weight:500; white-space:nowrap; overflow:hidden; text-overflow:ellipsis; }
  .cart-item-meta { font-size:13px; color:#7a6d66; margin-top:4px; }
  .cart-line { display:flex; justify-content:space-between; align-items:center; margin-top:8px; gap:10px; }
  .qty-control { display:flex; align-items:center; gap:8px; }
  .qty-btn { width:28px; height:28px; border:1px solid #e6e0d8; border-radius:6px; background:#fff; cursor:pointer; }
  .qty-value { min-width:24px; text-align:center; font-weight:600; color:#5a4a42; }
  .remove-item { background:none; border:none; font-size:18px; color:#7a6d66; cursor:pointer; }
  .cart-line-price { font-weight:600; color:#5a4a42; white-space:nowrap; }

  .cart-summary { display:flex; justify-content:space-between; align-items:center; margin:18px 0 6px; font-size:18px; }
  .cart-summary strong { font-weight:700; color:#5a4a42; }

  /* ПОДВАЛ — новый дизайн под фирстиль */
  .footer.footer--revamp { background:#fff; border-top:1px solid rgba(0,0,0,.05); padding: 60px 20px 25px; overflow-x:hidden; }
  .footer--revamp .footer-grid {
    max-width: 1400px; margin:0 auto; display:grid; gap:40px; grid-template-columns: repeat(12,1fr);
  }
  .footer-brand { grid-column: span 4; }
  .footer-brand .brand-row { display:flex; align-items:center; gap:16px; }
  .footer-brand .brand-badge {
    width:48px; height:48px; border-radius:12px; background:#E8DED4; display:flex; align-items:center; justify-content:center;
    color:#816856; font-weight:700; letter-spacing:.5px;
  }
  .footer-brand .brand-text { font-size:14px; color:#7a6d66; margin-top:10px; }
  .payments { display:flex; gap:10px; margin-top:14px; align-items:center; flex-wrap:wrap; }
  .payments .pill { padding:6px 10px; border:1px solid #e6e0d8; border-radius:999px; font-size:12px; color:#5a4a42; background:#f7f5f2; }
  .footer-col { grid-column: span 3; }
  .footer-col h4 { font-family: inherit; font-weight:500; font-size:16px; color:#816856; margin-bottom:14px; letter-spacing:.7px; }
  .footer-col ul { list-style:none; }
  .footer-col li { margin-bottom:10px; }
  .footer-col a { color:#000; text-decoration:none; font-size:15px; }
  .footer-col a:hover { color:#816856; }

  .messengers { display:flex; gap:12px; margin-top:8px; }
  .messengers a { width:40px; height:40px; border-radius:999px; background:#f7f5f2; display:flex; align-items:center; justify-content:center; color:#000; }
  .messengers a:hover { background:#E8DED4; color:#816856; }

  .footer-cta { grid-column: span 2; }
  .footer-cta .cta-card { background:#E8DED4; border:1px solid rgba(0,0,0,.05); border-radius:12px; padding:14px; }
  .footer-cta p { font-size:14px; color:#5a4a42; margin-bottom:10px; }
  .footer-cta input[type="email"]{ width:100%; padding:10px 12px; border-radius:8px; border:1px solid #e6e0d8; background:#fff; margin-bottom:8px; }
  .footer-cta button{ width:100%; padding:10px 12px; border:none; border-radius:8px; background:#816856; color:#fff; cursor:pointer; }
  .footer-cta button:hover{ background:#5a4a42; }

  .footer-legal { max-width: 1200px; margin: 28px auto 0; border-top:1px solid rgba(0,0,0,.06); padding-top:18px; display:flex; flex-wrap:wrap; gap:12px; justify-content:space-between; font-size:13px; color:#000; }
  .policy-links { display:flex; gap:16px; }
  .policy-links a { color:#000; text-decoration:none; position:relative; }
  .policy-links a:after { content:''; position:absolute; left:0; right:0; bottom:-2px; height:1px; background:#816856; opacity:0; transition:.2s; }
  .policy-links a:hover:after { opacity:1; }

  /* Адаптив */
  @media (max-width:1200px){
    .nav-left { padding-right:70px; } .nav-right { padding-left:70px; } .nav-item{ margin:0 12px;}
    .footer--revamp .footer-grid{ grid-template-columns: repeat(8,1fr);} .footer-brand{grid-column: span 8;} .footer-col{grid-column: span 4;} .footer-cta{grid-column: span 4;}
  }
  @media (max-width:1100px){ .nav-item{ margin:0 10px; } }
  @media (max-width:992px){
    .nav-left { padding-right:60px; } .nav-right { padding-left:60px; } .nav-item{ margin:0 8px; }
    .logo { width: 82px; }       /* было 90px */
    .about-container{ flex-direction:column; } .about-image{ order:-1; }
  }
  @media (max-width:900px){ .nav-item{ margin:0 6px; } }
  @media (max-width:768px){
    body { padding-top: 64px; } /* было 70px */
    .menu-toggle { display:flex; flex-direction:column; gap:5px; cursor:pointer; }
    .menu-toggle span { display:block; width:25px; height:2px; background:#333; }
    .nav-container {
      position:absolute; top:100%; left:0; width:100%; flex-direction:column; background:#fff; box-shadow: 0 5px 15px rgba(0,0,0,.1);
      padding:30px 0; transform: translateY(-150%); transition: transform .5s ease; display:none;
    }
    .nav-container.active { transform: translateY(0); display:flex; }
    .nav-left,.nav-right { flex-direction:column; width:100%; padding:0; justify-content:center; }
    .nav-menu { flex-direction:column; width:100%; }
    .nav-item { margin:12px 0; text-align:center; }
    .nav-link { font-size:18px; padding:10px 0; color:#000 !important; }
    .logo { width: 72px; top:60%; } /* было 80px */

    .carousel-container { height:85vh; margin-top:-64px; padding-top:64px; } /* было -70/70 */
    .carousel-slide img { width:100%; height:auto; max-height:100%; }
    .carousel-button { width:45px; height:45px; font-size:20px; }
    .carousel-button.prev{ left:15px; } .carousel-button.next{ right:15px; }
    .slide-info { left:20px; right:20px; bottom:30px; max-width:none; padding:20px; }
    .slide-info h3{ font-size:22px; } .slide-info p{ font-size:16px; }

    .products-section{ padding:60px 15px; } .section-title{ font-size:26px; margin-bottom:40px; }
    .product-card{ max-width:100%; } .product-gallery{ height:400px; }

    .side-panel{ width:100%; right:-100%; } .side-panel.active{ transform: translateX(-100%); }
    .modal-gallery{ min-height:350px; } .modal-info{ padding:25px; } .modal-title{ font-size:26px; } .modal-price{ font-size:22px; }

    .aroma-section{ padding:40px 15px; } .aroma-intro{ font-size:16px; } .pyramid-container{ height:300px; }

    .about-section,.reviews-section{ padding:60px 15px; }
    .review{ padding:25px 20px; } .reviews-nav{ padding:0 10px; }
    .review-nav-btn{ width:40px; height:40px; font-size:20px; }

    .footer--revamp .footer-grid{ grid-template-columns: repeat(4,1fr);}
    .footer-brand,.footer-col,.footer-cta{ grid-column: span 4; }
    .footer-legal { flex-direction:column; align-items:flex-start; gap:8px; }
  }
</style> <!-- Фиксированная «заполненная» стрелка для всех select (тёмно-коричневая) --> <style>
  select,
  .variant-select,
  .t-form__select,
  .t-select,
  .t-inputselect{
    -webkit-appearance:none;
    -moz-appearance:none;
    appearance:none;

    padding-right:56px !important; /* место под массивную стрелку */

    /* заполненная стрелка caret — тёмно-коричневая #5B3A29 */
    background-image:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24'%3E%3Cpath fill='%235B3A29' d='M7 10l5 6 5-6H7z'/%3E%3C/svg%3E") !important;
    background-repeat:no-repeat !important;
    background-position:right 16px center !important; /* фиксируем */
    background-size:20px 20px !important;

    transform:none !important;
    transition: box-shadow .2s ease, border-color .2s ease !important;
  }

  select:hover, select:focus,
  .variant-select:hover, .variant-select:focus,
  .t-form__select:hover, .t-form__select:focus,
  .t-select:hover, .t-select:focus,
  .t-inputselect:hover, .t-inputselect:focus{
    background-position:right 16px center !important;
    transform:none !important;
  }
</style> <!-- nominify end --> </div> </div> </div> </div> <div id="rec1317494491" class="r t-rec" style=" " data-animationappear="off" data-record-type="131"> <!-- T123 --> <div class="t123"> <div class="t-container_100 "> <div class="t-width t-width_100 "> <!-- nominify begin --> <!-- BLOCK 2: Page Transition + Header (UPDATED: mobile badge overlaps icon edge + anchors go to homepage, no hash in URL) --> <style>
  /* === MOBILE ONLY: увеличить верхнюю полосу шапки, скрыть логотип,
     круглые иконки и бейдж слегка заходит на край иконки === */
  @media (max-width: 768px){
    :root{
      --header-mobile-height: 64px;
      --header-mobile-pad-y: 10px;
      --tap: 44px;          /* квадратный тап-таргет */
      --badge-shift: 34%;   /* степень вынесения бейджа наружу (30–40% ок) */
    }

    .header{
      padding-top: calc(env(safe-area-inset-top, 0px) + var(--header-mobile-pad-y));
      padding-bottom: var(--header-mobile-pad-y);
    }
    .header .header-container{
      min-height: var(--header-mobile-height);
      display: flex;
      align-items: center;
    }

    /* Логотип скрыт на мобиле */
    .header .logo{ display: none !important; }

    /* Иконки: КРУГЛЫЕ и не вытягиваются */
    .header .nav-icons{
      margin-left: auto;
      display: flex;
      align-items: center;
      gap: 10px;
    }
    .header .nav-icons .icon-container{
      width: var(--tap);
      height: var(--tap);
      flex: 0 0 var(--tap);
      border-radius: 9999px;   /* круг */
      display: grid;
      place-items: center;
      line-height: 1;
      padding: 0;
      position: relative;      /* для бейджа */
      overflow: visible;
    }
    .header .nav-icons .icon-container i{
      font-size: 18px;
    }

    /* Бейдж: слегка «заходит» на иконку, но торчит наружу */
    .header .nav-icons .icon-badge{
      position: absolute;
      top: 0;
      right: 0;
      transform: translate(var(--badge-shift), calc(-1 * var(--badge-shift)));
      min-width: 18px;
      height: 18px;
      padding: 0 6px;          /* для дву- и трёхзначных чисел */
      display: inline-flex;
      align-items: center;
      justify-content: center;
      font-size: 11px;
      line-height: 1;
      border-radius: 9999px;
      box-sizing: border-box;
      z-index: 5;              /* поверх иконки */
    }

    /* Чуть увеличить кликабельность и выравнивание гамбургера (если он есть) */
    .header .menu-toggle{
      width: var(--tap);
      height: var(--tap);
      display: flex;
      align-items: center;
      justify-content: center;
    }
  }
</style> <div class="page-transition" id="pageTransition"> <div class="loading-spinner"></div> </div> <header class="header"> <div class="header-container"> <div class="menu-toggle"><span></span><span></span><span></span></div> <div class="nav-container"> <div class="nav-left"> <ul class="nav-menu"> <li class="nav-item"> <a href="https://home-secret.shop/payment" class="nav-link">доставка и оплата</a> </li> <li class="nav-item"> <a href="https://home-secret.shop/faq" class="nav-link">важно знать</a> </li> <!-- "Наши магазины" теперь слева, ведёт на /store --> <li class="nav-item"> <a href="https://home-secret.shop/store" class="nav-link">наши магазины</a> </li> </ul> </div> <div class="nav-right"> <ul class="nav-menu"> <!-- Эти кнопки скроллят по главной (без # в URL) --> <!-- ПЕРВЫМ идёт "каталог" --> <li class="nav-item"> <a href="https://home-secret.shop/" class="nav-link store-link" data-scroll-target="#products-block-4">каталог</a> </li> <li class="nav-item"> <a href="https://home-secret.shop/" class="nav-link" data-scroll-target="#reviews">отзывы</a> </li> <!-- "обо мне" перенесён на третье место, цель скролла сохранена (#about) --> <li class="nav-item"> <a href="https://home-secret.shop/" class="nav-link" data-scroll-target="#about">обо мне</a> </li> </ul> </div> </div> <div class="logo"> <a href="https://home-secret.shop/"> <img src="https://static.tildacdn.com/tild3331-3339-4765-a532-653932333933/4.png" alt="Lumière - свечи и духи ручной работы"> </a> </div> <div class="nav-icons"> <div class="icon-container account-icon" id="headerAccount" title="Личный кабинет"> <i class="far fa-user"></i> <span class="icon-badge" style="display:none">0</span> </div> <div class="icon-container favorite-icon" id="headerFavorite" title="Избранное"> <i class="far fa-heart"></i> <span class="icon-badge">9</span> </div> <div class="icon-container cart-icon-container" id="headerCart" title="Корзина"> <i class="fas fa-shopping-bag"></i> <span class="icon-badge">12</span> </div> </div> </div> </header> <!-- T123 — Header cart icon opens ST100 (open-only) + Smart anchor handling --> <script>
(function(){
  /* ====== ST100 open-only binding for header cart ====== */
  var TARGET_SELECTORS = [
    '.hs-header-cart',
    '#headerCart',
    '.cart-icon-container',
    '.header .cart-icon',
    '.nav-icons .cart-icon',
    '.menu-cart',
    '.header-cart',
    'a[href="#cart"]'
  ];

  function $(sel, root){ return (root||document).querySelector(sel); }
  function findHeaderIcon(){
    for (var i=0;i<TARGET_SELECTORS.length;i++){
      var el = $(TARGET_SELECTORS[i]); if (el) return el;
    }
    return null;
  }

  function isPopupVisible(){
    return !!document.querySelector('.t706__cartwin.t706__cartwin_showed, .t706__cartwin_showed');
  }

  function openST100(){
    if (isPopupVisible()) return;
    if (typeof window.tcart__openPopup === 'function'){ window.tcart__openPopup(); return; }
    var icon = document.querySelector('.t706__carticon');
    if (icon) icon.click();
  }

  function waitST100(timeoutMs){
    timeoutMs = timeoutMs || 3000;
    return new Promise(function(resolve, reject){
      var t0 = Date.now();
      (function tick(){
        var ready = (typeof window.tcart__openPopup === 'function') || document.querySelector('.t706__carticon');
        if (ready) return resolve();
        if (Date.now() - t0 > timeoutMs) return reject(new Error('ST100 not found'));
        requestAnimationFrame(tick);
      })();
    });
  }

  function bindCart(el){
    if (!el || el.__hsCartBound) return;
    el.__hsCartBound = true;
    el.addEventListener('click', function(e){
      e.preventDefault();
      e.stopImmediatePropagation();
      waitST100(3000).then(openST100).catch(function(){
        alert('На странице нет блока корзины ST100. Добавьте блок «Корзина (ST100)» и опубликуйте страницу.');
      });
    });
  }

  function initCart(){
    var el = findHeaderIcon();
    if (el) { bindCart(el); return; }
    var mo = new MutationObserver(function(){
      var el2 = findHeaderIcon();
      if (el2){ bindCart(el2); mo.disconnect(); }
    });
    mo.observe(document.documentElement, { childList:true, subtree:true });
  }

  /* ====== Smart anchors: вспомогательные функции ====== */
  function onHome(){ return location.pathname === '/' || location.pathname === '/index.html'; }
  function headerOffset(){
    var h = document.querySelector('.header');
    return h ? h.getBoundingClientRect().height + 8 : 0;
  }
  function smoothScrollTo(selector){
    var el = document.querySelector(selector);
    if (!el) return;
    var top = el.getBoundingClientRect().top + window.pageYOffset - headerOffset();
    window.scrollTo({ top: top, behavior: 'smooth' });
  }

  /* ====== Память цели скролла между страницами (чтобы не было # в URL) ====== */
  var SCROLL_STORAGE_KEY = 'hs_scroll_target';

  function applyStoredScroll(){
    if (!onHome()) return;
    var targetSelector = null;
    try{
      targetSelector = window.sessionStorage.getItem(SCROLL_STORAGE_KEY);
      if (targetSelector) window.sessionStorage.removeItem(SCROLL_STORAGE_KEY);
    }catch(_){}
    if (!targetSelector) return;

    var doScroll = function(){
      smoothScrollTo(targetSelector);
    };

    if (document.readyState === 'loading'){
      document.addEventListener('DOMContentLoaded', doScroll);
    } else {
      setTimeout(doScroll, 50);
    }
  }

  /* ====== Общий перехват ссылок на главную с якорём (если вдруг где-то есть href="/#..." ) ====== */
  document.addEventListener('click', function(e){
    var a = e.target.closest('a');
    if (!a) return;
    try{
      var u = new URL(a.href);
      if (u.origin === location.origin && u.pathname === '/' && u.hash){
        if (onHome()){
          e.preventDefault();
          /* НЕ меняем адресную строку, просто скроллим */
          smoothScrollTo(u.hash);
        }
      }
    }catch(_){}
  });

  /* ====== Навигация по шапке: ОБО МНЕ / ОТЗЫВЫ / КАТАЛОГ без # в URL ====== */
  document.addEventListener('click', function(e){
    var a = e.target.closest('a[data-scroll-target]');
    if (!a) return;

    var targetSelector = a.getAttribute('data-scroll-target');
    if (!targetSelector) return;

    if (onHome()){
      /* Уже на главной: просто плавный скролл, URL не меняем */
      e.preventDefault();
      smoothScrollTo(targetSelector);
    } else {
      /* Не на главной: запоминаем цель и даём уйти на /
         На главной после загрузки applyStoredScroll сделает скролл */
      try{
        window.sessionStorage.setItem(SCROLL_STORAGE_KEY, targetSelector);
      }catch(_){}
      /* default-поведение: переход по href без # */
    }
  });

  (document.readyState !== 'loading')
    ? initCart()
    : document.addEventListener('DOMContentLoaded', initCart);

  applyStoredScroll();
})();
</script> <!-- nominify end --> </div> </div> </div> </div> <div id="rec1317506081" class="r t-rec" style=" " data-animationappear="off" data-record-type="131"> <!-- T123 --> <div class="t123"> <div class="t-container_100 "> <div class="t-width t-width_100 "> <!-- nominify begin --> <!-- BLOCK 10: Side Panels & Modal (ES5-STABLE, instant favorites, hearts sync, final price only) --> <div class="panel-overlay" id="panelOverlay"></div> <!-- NEW: Account Panel --> <div class="side-panel account-panel" id="accountPanel"> <div class="panel-header"> <h2>Личный кабинет</h2> <button class="close-panel" aria-label="Закрыть">&times;</button> </div> <div class="auth-tabs"> <button class="auth-tab active" data-target="auth-login">Войти</button> <button class="auth-tab" data-target="auth-register">Регистрация</button> </div> <form class="auth-form active" id="auth-login"> <div class="form-row"> <label class="form-label">Email</label> <input class="form-input" type="email" required placeholder="you@example.com"> </div> <div class="form-row"> <label class="form-label">Пароль</label> <input class="form-input" type="password" required placeholder="••••••••"> </div> <button class="btn-primary" type="submit">Войти</button> <div class="account-links"> <a href="#">Забыли пароль?</a> <a href="#">Настроить TG-уведомления</a> </div> <div class="auth-divider">или</div> <div class="social-row"> <button type="button" class="btn-social"><i class="fa-brands fa-telegram"></i> Telegram</button> <button type="button" class="btn-social"><i class="fa-brands fa-vk"></i> VK ID</button> </div> <p class="auth-hint">* Интеграция с CRM/оплатой настраивается в админке. Этот блок — UI.</p> </form> <form class="auth-form" id="auth-register"> <div class="form-row"> <label class="form-label">Имя</label> <input class="form-input" type="text" required placeholder="Ваше имя"> </div> <div class="form-row"> <label class="form-label">Email</label> <input class="form-input" type="email" required placeholder="you@example.com"> </div> <div class="form-row"> <label class="form-label">Пароль</label> <input class="form-input" type="password" required placeholder="••••••••"> </div> <button class="btn-primary" type="submit">Создать аккаунт</button> </form> </div> <!-- FAVORITES PANEL --> <div class="side-panel" id="favoritesPanel"> <div class="panel-header"> <h2>Избранное</h2> <button class="close-panel" aria-label="Закрыть" title="Закрыть"> <i class="fa-solid fa-xmark"></i> </button> </div> <style>
    /* header close */
    #favoritesPanel .panel-header .close-panel{
      width:34px;height:34px;border-radius:999px;border:1px solid rgba(0,0,0,.12);background:#fff;
      display:grid;place-items:center;cursor:pointer;transition:transform .12s ease,box-shadow .2s ease,border-color .2s ease,background .2s ease;
    }
    #favoritesPanel .panel-header .close-panel i{font-size:18px;line-height:1}
    #favoritesPanel .panel-header .close-panel:hover{transform:translateY(-1px);box-shadow:0 6px 18px rgba(0,0,0,.12);border-color:rgba(0,0,0,.2);background:#fafafa}

    /* list/empty */
    #favoritesPanel .favorites-empty{
      display:none;text-align:center;color:rgba(0,0,0,.6);border:1px dashed rgba(0,0,0,.12);border-radius:14px;padding:16px;margin:8px 16px 12px;
    }
    #favoritesPanel .favorites-list{display:grid;gap:10px;padding:16px}

    #favoritesPanel .favorite-item{
      display:flex;align-items:center;gap:12px;border:1px solid rgba(0,0,0,.08);border-radius:14px;padding:10px;background:#fff;transition:opacity .25s ease,transform .25s ease;
    }
    #favoritesPanel .favorite-item-image{width:74px;height:74px;flex:0 0 auto;border-radius:12px;overflow:hidden;background:#f6f6f4}
    #favoritesPanel .favorite-item-image img{width:100%;height:100%;object-fit:cover;display:block}

    #favoritesPanel .favorite-item-details{display:flex;flex-direction:column;gap:6px;min-width:0;flex:1}
    #favoritesPanel .favorite-item-title{font-size:15px;font-weight:700;color:#000;line-height:1.3;margin:0;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
    #favoritesPanel .favorite-item-variant{font-size:12px;color:rgba(0,0,0,.6);margin:0;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
    #favoritesPanel .favorite-item-footer{display:flex;align-items:center;gap:10px;justify-content:flex-start}
    #favoritesPanel .favorite-item-price{font-size:15px;font-weight:700;white-space:nowrap}

    /* "в корзину" в избранном */
    #favoritesPanel .fav-mini-add{
      width:28px;height:28px;border-radius:999px;border:1px solid rgba(0,0,0,.12);background:#fff;color:#111;cursor:pointer;
      display:inline-grid;place-items:center;margin-left:8px;transition:transform .12s ease,box-shadow .12s ease,background .2s ease,border-color .2s ease,color .2s ease;
    }
    #favoritesPanel .fav-mini-add i{font-size:14px;line-height:1}
    #favoritesPanel .fav-mini-add:hover{transform:translateY(-1px);box-shadow:0 2px 8px rgba(0,0,0,.08);background:#000;color:#fff;border-color:#000}

    /* минималистичный круглый крестик удаления */
    #favoritesPanel .fav-mini-remove{
      position:relative;width:28px;height:28px;border-radius:999px;border:1px solid rgba(0,0,0,.12);background:#fff;cursor:pointer;
      display:inline-grid;place-items:center;margin-left:8px;transition:transform .12s ease,box-shadow .12s ease,background .2s ease,border-color .2s ease;
    }
    #favoritesPanel .fav-mini-remove::before,
    #favoritesPanel .fav-mini-remove::after{
      content:"";position:absolute;width:12px;height:1.5px;background:rgba(0,0,0,.7);border-radius:1px;
    }
    #favoritesPanel .fav-mini-remove::before{transform:rotate(45deg)}
    #favoritesPanel .fav-mini-remove::after{transform:rotate(-45deg)}
    #favoritesPanel .fav-mini-remove:hover{transform:translateY(-1px);box-shadow:0 2px 8px rgba(0,0,0,.08);background:#fafafa;border-color:rgba(0,0,0,.2)}

    /* состояние сердечек на карточках */
    .product-card .favorite-btn[aria-pressed="true"] i{color:#d75a5a}
    .product-card .favorite-btn.is-favorite i{font-weight:900}
    .product-card .favorite-btn[aria-pressed="false"] i{color:#111}

    @media (max-width:480px){#favoritesPanel .favorite-item{align-items:flex-start}}
  </style> <div class="favorites-empty" id="favoritesEmpty">Пока пусто. Добавляйте товары сердечком на карточке.</div> <div class="favorites-list" id="favoritesList"></div> <div class="favorites-mini-actions" id="favoritesMiniActions" style="display:none;"> <button class="fav-mini-clear" id="favoritesClearMini" type="button"> <i class="fa-regular fa-trash-can"></i><span>Очистить</span> </button> </div> <script>
  (function(){
    try{
      var panel = document.getElementById('favoritesPanel');
      if(!panel) return;

      var list = document.getElementById('favoritesList');
      var empty = document.getElementById('favoritesEmpty');
      var miniActions = document.getElementById('favoritesMiniActions');
      var clearMini = document.getElementById('favoritesClearMini');

      function money(v){ return (Number(v)||0).toLocaleString('ru-RU') + ' ₽'; }
      var KEY = 'favorites';

      function read(){ try{ return JSON.parse(localStorage.getItem(KEY) || '[]'); }catch(e){ return []; } }
      function write(arr){ try{ localStorage.setItem(KEY, JSON.stringify(arr)); }catch(e){} }
      function slug(s){
        s = String(s||'').toLowerCase();
        s = s.replace(/\s+/g,'-').replace(/[^a-z0-9\-_\u0400-\u04FF]+/g,'').replace(/\-+/g,'-');
        return s.slice(0,96);
      }

      /* Сбор данных из карточки (цена — ТОЛЬКО новая/итоговая) */
      function buildFromCard(card){
        var titleEl = card ? card.querySelector('.product-title') : null;
        var title = titleEl ? (titleEl.textContent||'').trim() : 'Товар';

        var aroma='', volume='', wick='';
        var variantBlocks = card ? card.querySelectorAll('.product-variants') : [];
        for (var i=0;i<variantBlocks.length;i++){
          var wrap = variantBlocks[i];
          var lblEl = wrap.querySelector('.variants-label');
          var label = lblEl ? (lblEl.textContent||'').toLowerCase() : '';
          var sel = wrap.querySelector('.variant-select');
          var val = sel && sel.options[sel.selectedIndex] ? (sel.options[sel.selectedIndex].textContent||'').trim() : '';
          if(!val) continue;
          if (label.indexOf('аромат')>-1) aroma = val;
          else if (label.indexOf('объём')>-1 || label.indexOf('объем')>-1) volume = val;
          else if (label.indexOf('фитил')>-1) wick = val;
        }

        var variantText = '';
        if (aroma) variantText += 'Аромат: ' + aroma;
        if (wick) variantText += (variantText?' · ':'') + 'Фитиль: ' + wick;
        if (!wick && volume) variantText += (variantText?' · ':'') + 'Объём: ' + volume;

        var price = 0;
        var selects = card ? card.querySelectorAll('.product-variants .variant-select') : [];
        var prefSel = null;
        for (i=0;i<selects.length;i++){
          var l = selects[i].closest('.product-variants');
          var lab = l ? l.querySelector('.variants-label') : null;
          var text = lab ? (lab.textContent||'').toLowerCase() : '';
          if (text.indexOf('объём')>-1 || text.indexOf('объем')>-1 || text.indexOf('фитил')>-1){ prefSel = selects[i]; break; }
        }
        if (!prefSel && selects.length) prefSel = selects[0];
        if (prefSel){
          var opt = prefSel.options[prefSel.selectedIndex];
          if (opt && opt.getAttribute('data-price')) price = Number(opt.getAttribute('data-price'))||0;
        }
        if (!price){
          var pn = card ? card.querySelector('.price-new') : null;
          if (pn) price = Number((pn.textContent||'').replace(/[^\d]/g,''))||0;
        }

        var imgEl = card ? (card.querySelector('.gallery-images img.is-active, .gallery-images img[data-active="true"]') ||
                            card.querySelector('.gallery-images img') || card.querySelector('img')) : null;
        var image = imgEl ? (imgEl.currentSrc || imgEl.src || '') : '';

        var id = slug(title + '|' + (aroma||'') + '|' + (wick||volume||''));
        return { id:id, title:title, image:image, variant:variantText, unitPrice:price };
      }

      function exists(id){
        var favs = read();
        for (var i=0;i<favs.length;i++){ if (favs[i].id===id) return true; }
        return false;
      }

      function render(){
        if (!list || !empty) return;
        var favs = read();
        list.innerHTML = '';
        if (!favs.length){
          empty.style.display='block';
          if (miniActions) miniActions.style.display='none';
          return;
        }
        empty.style.display='none';
        if (miniActions) miniActions.style.display='flex';

        var frag = document.createDocumentFragment();
        for (var i=0;i<favs.length;i++){
          var it = favs[i];
          var el = document.createElement('div');
          el.className = 'favorite-item';
          el.setAttribute('data-id', it.id);
          el.innerHTML =
            '<div class="favorite-item-image"><img src="'+(it.image||'')+'" alt=""></div>'+
            '<div class="favorite-item-details">'+
              '<h4 class="favorite-item-title">'+it.title+'</h4>'+
              '<p class="favorite-item-variant">'+(it.variant||'')+'</p>'+
              '<div class="favorite-item-footer">'+
                '<span class="favorite-item-price">'+money(it.unitPrice)+'</span>'+
                '<button class="fav-mini-add" type="button" title="В корзину"><i class="fa-solid fa-cart-shopping"></i></button>'+
                '<button class="fav-mini-remove favorite-item-remove" type="button" aria-label="Удалить"></button>'+
              '</div>'+
            '</div>';
          frag.appendChild(el);
        }
        list.appendChild(frag);
      }

      function syncHearts(){
        var favs = read();
        var cards = document.querySelectorAll('.product-card');
        for (var i=0;i<cards.length;i++){
          var card = cards[i];
          var btn = card.querySelector('.favorite-btn');
          if (!btn) continue;
          var item = buildFromCard(card);
          var active = exists(item.id);
          if (active){ btn.classList.add('is-favorite'); btn.setAttribute('aria-pressed','true'); }
          else { btn.classList.remove('is-favorite'); btn.setAttribute('aria-pressed','false'); }
          var icon = btn.querySelector('i');
          if (icon){
            icon.classList.add('fa-heart');
            if (active){ icon.classList.remove('far'); icon.classList.add('fas'); }
            else { icon.classList.add('far'); icon.classList.remove('fas'); icon.style.color = '#111'; }
          }
        }
      }

      function add(item){
        var favs = read();
        if (exists(item.id)) return;
        favs.unshift(item);
        write(favs);
        render(); syncHearts(); hideLegacyEmpty();
      }

      function removeById(id){
        var favs = read();
        var next = [];
        for (var i=0;i<favs.length;i++){ if (favs[i].id!==id) next.push(favs[i]); }
        write(next);
        render(); syncHearts(); hideLegacyEmpty();
      }

      /* экспорт */
      window.updateFavoritesList = function(){ render(); syncHearts(); hideLegacyEmpty(); };
      window.addToFavoritesFromCard = function(card){
        var item = buildFromCard(card);
        exists(item.id) ? removeById(item.id) : add(item);
      };

      /* 1) Сердечко на карточке — мгновенно */
      document.addEventListener('click', function(e){
        var target = e.target;
        var btn = target && target.closest ? target.closest('.favorite-btn') : null;
        if (!btn) return;
        var card = btn.closest ? btn.closest('.product-card') : null;
        if (!card) return;
        e.preventDefault();
        var item = buildFromCard(card);
        exists(item.id) ? removeById(item.id) : add(item);
      });

      /* 2) Смена вариантов — синхронизируем сердечки */
      document.addEventListener('change', function(e){
        var el = e.target;
        if (el && el.closest && el.closest('.product-card .variant-select')) syncHearts();
      });

      /* 3) Действия в панели избранного */
      if (list){
        list.addEventListener('click', function(e){
          var target = e.target;

          var rm = target && (target.closest ? target.closest('.fav-mini-remove, .favorite-item-remove') : null) : null;
          if (rm){
            var wrap = target.closest ? target.closest('.favorite-item') : null;
            var id = wrap ? wrap.getAttribute('data-id') : null;
            if (id) removeById(id);
            return;
          }

          var addBtn = target && (target.closest ? target.closest('.fav-mini-add') : null) : null;
          if (addBtn){
            var w = target.closest ? target.closest('.favorite-item') : null;
            var id2 = w ? w.getAttribute('data-id') : null;
            var favs = read();
            var it = null;
            for (var i=0;i<favs.length;i++){ if (favs[i].id===id2){ it=favs[i]; break; } }
            if (!it) return;
            try{
              if (typeof window.tcart__addProduct === 'function'){
                var product = { name: it.title, price: it.unitPrice, amount: 1, img: it.image, options: [] };
                if (it.variant){
                  var parts = it.variant.split('·');
                  for (var j=0;j<parts.length;j++){
                    var p = (parts[j]||'').trim();
                    var kv = p.split(':');
                    if (kv.length>1){
                      product.options.push({ option: (kv[0]||'Опция').trim(), variant: (kv[1]||'').trim(), price: 0 });
                    }
                  }
                }
                window.tcart__addProduct(product);
              } else if (typeof window.addToCart === 'function'){
                window.addToCart({ id: it.id, title: it.title, image: it.image, variant: it.variant, unitPrice: it.unitPrice });
              }
            }catch(err){}
          }
        });
      }

      /* 4) Очистка — очищаем и сердечки */
      if (clearMini){
        clearMini.addEventListener('click', function(){
          write([]); render(); syncHearts(); hideLegacyEmpty();
        });
      }

      /* 5) Прячем только внутри панели любое "Ваше избранное пока пусто" */
      function hideLegacyEmpty(){
        var nodes = panel.querySelectorAll('*');
        for (var i=0;i<nodes.length;i++){
          var n = nodes[i];
          var t = (n.textContent||'').trim();
          if (t === 'Ваше избранное пока пусто' || t.indexOf('Ваше избранное пока пусто')>-1){
            n.style.display = 'none';
          }
        }
      }

      function init(){ render(); syncHearts(); hideLegacyEmpty(); }
      if (document.readyState !== 'loading') init(); else document.addEventListener('DOMContentLoaded', init);
    }catch(err){}
  })();
  </script> </div> <!-- CART PANEL --> <div class="side-panel" id="cartPanel"> <div class="panel-header"> <h2 class="section-title" style="margin-bottom:0;">Корзина</h2> <button class="close-panel" aria-label="Закрыть">&times;</button> </div> <div class="cart-list" id="cartContainer"></div> <div class="cart-summary"> <span>Итого:</span> <strong id="cartTotal">0 ₽</strong> </div> <div style="text-align:center; margin-top:10px;"> <button class="add-to-cart" style="max-width:300px; margin:0 auto;" id="checkoutBtn">Оформить заказ</button> </div> </div> <!-- PRODUCT MODAL --> <div class="modal" id="productModal"> <div class="modal-content"> <button class="close-modal" aria-label="Закрыть">&times;</button> <div class="modal-body"> <div class="modal-gallery" id="modalGallery"></div> <div class="modal-info"> <h2 class="modal-title" id="modalTitle"></h2> <div class="modal-price" id="modalPrice"></div> <p class="modal-description" id="modalDescription"></p> <div class="modal-variants" id="modalVariants"></div> <button class="modal-add-to-cart" id="modalAddToCart">в корзину</button> </div> </div> </div> </div> <!-- HS: Safe ST100 opener (single, ES5) --> <script>
(function(){
  try{
    var SELECTORS = [
      '.js-hs-order',
      '[data-hs="checkout"]',
      '.cart-checkout',
      '.t706__cartwin-bottom .t706__cartwin-bottom-btn'
    ].join(',');

    function openST100(){
      try { if (typeof window.tcart__openPopup === 'function') { window.tcart__openPopup('order'); return; } } catch(e){}
      try { if (typeof window.tcart__openOrder === 'function') { window.tcart__openOrder(); return; } } catch(e){}
      var a = document.querySelector('a[href="#order"]');
      if (!a) {
        a = document.createElement('a');
        a.href = '#order';
        a.style.position = 'absolute';
        a.style.left = '-9999px';
        a.style.top  = '-9999px';
        a.setAttribute('aria-hidden','true');
        document.body.appendChild(a);
      }
      a.dispatchEvent(new MouseEvent('click', {bubbles:true, cancelable:true}));
    }

    window.addEventListener('click', function(e){
      var t = e.target;
      var btn = t && t.closest ? t.closest(SELECTORS) : null;
      if (!btn) return;
      e.preventDefault();
      e.stopImmediatePropagation();
      openST100();
    }, true);
  }catch(err){}
})();
</script> <style>
/* === Фирменная кнопка "в корзину" внутри модалки товара === */
#productModal .modal-add-to-cart {
  background-color: #816856 !important;
  color: #fff !important;
  border: none;
  border-radius: 6px;
  padding: 12px 24px;
  font-size: 16px;
  font-family: 'Circe', sans-serif;
  cursor: pointer;
  transition: background-color 0.3s ease, transform 0.15s ease;
  box-shadow: 0 4px 14px rgba(0, 0, 0, 0.1);
}
#productModal .modal-add-to-cart:hover { background-color: #b99f94 !important; }
#productModal .modal-add-to-cart:active { transform: scale(0.98); }
</style> <!-- PATCH: мобильный крестик модалки — бежевый по умолчанию, чёрный по классу --> <style id="hsModalCloseMobileColor">
  @media (max-width: 768px){
    :root{
      --accent: #816856;                 /* фирменный бежево-коричневый */
      --modal-close-color-mobile: var(--accent);
    }

    /* Бежевый крестик по умолчанию */
    #productModal .close-modal{
      color: var(--modal-close-color-mobile) !important;
      position: absolute; top: 8px; right: 8px;
      width: 36px; height: 36px; border-radius: 999px;
      background: #fff; border: 1px solid rgba(0,0,0,.12);
      display: grid; place-items: center;
      font-size: 22px; line-height: 1;
      box-shadow: 0 4px 14px rgba(0,0,0,.08);
      transition: transform .12s ease, box-shadow .2s ease, color .2s ease;
      z-index: 3;
    }
    #productModal .close-modal:hover{ transform: translateY(-1px); box-shadow: 0 6px 18px rgba(0,0,0,.12); }

    /* Для чёрного крестика добавьте класс .is-dark или data-variant="dark" на кнопку */
    #productModal .close-modal.is-dark,
    #productModal .close-modal[data-variant="dark"]{
      color: #111 !important;
    }
  }
</style> <script>
/* === Modal "В корзину" → ST100 (ES5, final price only) === */
(function () {
  try{
    var OPEN_CART_ON_ADD = false;

    function numberify(v){
      var s = String(v || '').replace(/\u00A0/g,' ').replace(/[^\d.,-]/g,'').replace(',', '.');
      var n = parseFloat(s); return isNaN(n) ? 0 : n;
    }

    function toAbs(url){
      if (!url) return '';
      if (/^https?:\/\//i.test(url)) return url;
      if (url.indexOf('//') === 0) return location.protocol + url;
      if (url.charAt(0) === '/') return location.origin + url;
      return location.origin + '/' + url.replace(/^\.?\//,'');
    }

    function bgUrl(el){
      var gi = el ? getComputedStyle(el).backgroundImage : '';
      var m = gi && gi.match(/url\(["']?(.+?)["']?\)/i);
      return m ? m[1] : '';
    }

    document.addEventListener('click', function (e) {
      var card = e.target && e.target.closest ? e.target.closest('.product-card') : null;
      if (!card) return;

      var tEl = card.querySelector('.product-title');
      var t = tEl ? (tEl.textContent||'').trim() : '';
      if (t) window.__hs_lastCardTitle = t;

      var imgEl = card.querySelector('.gallery-images img.is-active, .gallery-images img[data-active="true"]') ||
                  card.querySelector('.gallery-images img, .product-image img, img');
      var src = '';
      if (imgEl) {
        src = imgEl.currentSrc || imgEl.src || imgEl.getAttribute('src') || '';
        if (!src && imgEl.srcset) src = imgEl.srcset.split(',')[0].trim().split(' ')[0];
      }
      if (!src) {
        var bg = card.querySelector('.product-image, [class*="bgimg"], .bg');
        if (bg) src = bgUrl(bg);
      }
      if (src) window.__hs_lastCardImageUrl = toAbs(src);
    }, true);

    function getModal(){
      return document.getElementById('productModal') || document.querySelector('.product-modal');
    }
    function cleanTitle(t){
      t = String(t||'');
      t = t.replace(/\s*\(.*?\)\s*/g,' ').replace(/\s+[—-].*$/,'').replace(/\s{2,}/g,' ').trim();
      return t || 'Товар';
    }
    function getTitle(modal){
      var fromCard = window.__hs_lastCardTitle;
      if (fromCard) return cleanTitle(fromCard);
      var el = modal.querySelector('.modal-product-title, .product-title, [data-product-title]');
      return cleanTitle(el ? el.textContent : 'Товар');
    }
    function getImage(modal){
      if (window.__hs_lastCardImageUrl) return window.__hs_lastCardImageUrl;
      var imgEl = modal.querySelector('.gallery-images img.is-active, .gallery-images img[data-active="true"], .modal-product-image, .gallery-images img') ||
                  modal.querySelector('img');
      var src = '';
      if (imgEl) {
        src = imgEl.currentSrc || imgEl.src || imgEl.getAttribute('src') || '';
        if (!src && imgEl.srcset) src = imgEl.srcset.split(',')[0].trim().split(' ')[0];
      }
      if (!src) {
        var bg = modal.querySelector('.modal-product-image, .gallery-images .bg, .js-product-img, [class*="bgimg"]');
        if (bg) src = bgUrl(bg);
      }
      return toAbs(src);
    }
    function classify(labelRaw, valueRaw){
      var l = String(labelRaw||'').toLowerCase();
      var v = String(valueRaw||'').toLowerCase();
      if (/аромат|fragrance|scent/.test(l)) return 'aroma';
      if (/фитил|fitil|wick|хлопк|дерев/.test(l) || /фитил|хлопк|дерев|wick|cotton|wood/.test(v)) return 'wick';
      if (/объе?м|volume|ml|мл/.test(l) || /^\s*\d+([.,]\d+)?\s*(ml|мл)?\s*$/i.test(valueRaw||'')) return 'volume';
      return 'other';
    }
    function formatVolume(val){
      var m = String(val||'').match(/(\d+(?:[.,]\d+)?)/);
      return m ? m[1].replace(',', '.') + ' мл' : (val||'');
    }
    function collectOptions(modal){
      var picks = { aroma:null, wick:null, volume:null, rest:[] };
      var sels = modal.querySelectorAll('.variant-select, select[data-title], select[name*="variant"], select[data-attr]');
      for (var i=0;i<sels.length;i++){
        var sel = sels[i];
        var label = sel.getAttribute('data-title') || sel.getAttribute('aria-label') || sel.name || sel.id || '';
        var opt = sel.options && sel.options[sel.selectedIndex] ? sel.options[sel.selectedIndex] : null;
        var val = opt ? (opt.textContent||'').trim() : '';
        if (!val) continue;
        var kind = classify(label, val);
        if (kind==='aroma' && !picks.aroma) picks.aroma = val;
        else if (kind==='wick' && !picks.wick) picks.wick = val;
        else if (kind==='volume' && !picks.volume) picks.volume = formatVolume(val);
        else picks.rest.push({ option: label || 'Опция', variant: val });
      }
      var radios = modal.querySelectorAll('[data-title] input[type="radio"]:checked');
      for (i=0;i<radios.length;i++){
        var r = radios[i];
        var wrap = r.closest ? r.closest('[data-title], .option') : null;
        var lbl = wrap ? wrap.getAttribute('data-title') : 'Опция';
        var labEl = wrap ? wrap.querySelector('label[for="'+r.id+'"]') : null;
        var txt = labEl ? (labEl.textContent||'').trim() : (r.value||'');
        if (!txt) continue;
        kind = classify(lbl, txt);
        if (kind==='aroma' && !picks.aroma) picks.aroma = txt;
        else if (kind==='wick' && !picks.wick) picks.wick = txt;
        else if (kind==='volume' && !picks.volume) picks.volume = formatVolume(txt);
        else picks.rest.push({ option: lbl||'Опция', variant: txt });
      }
      var res = [];
      if (picks.aroma) res.push({ option:'Аромат', variant:picks.aroma, price:0 });
      if (picks.wick) res.push({ option:'Фитиль', variant:picks.wick, price:0 });
      else if (picks.volume) res.push({ option:'Объём', variant:picks.volume, price:0 });
      return res;
    }

    function getPrice(modal){
      var price = 0;
      var opts = modal.querySelectorAll('select option:checked');
      for (var i=0;i<opts.length;i++){
        var o = opts[i];
        if (o.getAttribute('data-price')) price = numberify(o.getAttribute('data-price'));
      }
      if (!price){
        var p = modal.querySelector('[data-price-current], .modal-price, .product-price, .js-product-price');
        if (p) price = numberify(p.textContent);
      }
      return price || 0;
    }

    function waitST100(cb){
      if (typeof window.tcart__addProduct === 'function') return cb();
      var t0 = Date.now();
      var iv = setInterval(function(){
        if (typeof window.tcart__addProduct === 'function'){ clearInterval(iv); cb(); }
        if (Date.now() - t0 > 12000){ clearInterval(iv); }
      }, 60);
    }

    document.addEventListener('click', function (e) {
      var btn = e.target && e.target.closest ? e.target.closest('#productModal .modal-add-to-cart, .product-modal .modal-add-to-cart') : null;
      if (!btn) return;

      var modal = getModal(); if (!modal) return;

      var name   = getTitle(modal);
      var img    = getImage(modal);
      var price  = getPrice(modal);
      var qtyEl  = modal.querySelector('.quantity-input, input[name="quantity"], [data-qty]');
      var amount = qtyEl ? Number(qtyEl.value) || 1 : 1;
      var options = collectOptions(modal);

      var product = { name:name, price:price, amount:amount, img:img, options:options };

      var orig = btn.textContent;
      btn.disabled = true; btn.textContent = 'Добавляю...';

      waitST100(function(){
        try{
          window.tcart__addProduct(product);
          if (OPEN_CART_ON_ADD && typeof window.tcart__openCart === 'function') window.tcart__openCart();
          btn.textContent = 'Добавлено';
          setTimeout(function(){ btn.disabled = false; btn.textContent = orig; }, 600);
        }catch(err){
          btn.disabled = false; btn.textContent = orig;
        }
      });
    });
  }catch(err){}
})();
</script> <!-- nominify end --> </div> </div> </div> </div> <div id="rec1317507011" class="r t-rec" style=" " data-animationappear="off" data-record-type="131"> <!-- T123 --> <div class="t123"> <div class="t-container_100 "> <div class="t-width t-width_100 "> <!-- nominify begin --> <!-- BLOCK 11: JavaScript (FINALE: toasts + "Добавлено!" + уменьшенная ароматическая пирамида + скидочные цены в модалке) --> <script>
/* ======================== ГЛОБАЛЬНОЕ СОСТОЯНИЕ ======================== */
let favoriteItems = JSON.parse(localStorage.getItem('favorites')) || [];
let cartItems = JSON.parse(localStorage.getItem('cart')) || [];

// Миграция, если старый формат
if (Array.isArray(cartItems) && cartItems.length && typeof cartItems[0] !== 'object') {
  cartItems = [];
  localStorage.setItem('cart', JSON.stringify(cartItems));
}
function saveState(){
  localStorage.setItem('favorites', JSON.stringify(favoriteItems));
  localStorage.setItem('cart', JSON.stringify(cartItems));
}

const fmt = n => (Number(n) || 0).toLocaleString('ru-RU') + ' ₽';
const num = t => Number(String(t).replace(/[^\d]/g,'') || 0);
/* Юникод-вариант смайла, чтобы не зависеть от кодировки файла */
const EMOJI_HEART = '\uD83D\uDC9C';

/* ======================== КНОПКИ «ИНСТРУКЦИЯ» ДЛЯ FAQ (чуть меньше, без иконки, чёрный текст) ======================== */
(function ensureFaqBtnStyles(){
  const css = `
    .hs-faq-btn-wrap{ margin-top:10px; display:flex; }
    .hs-faq-btn-wrap + .hs-faq-btn-wrap{ margin-top:8px; } /* вторая кнопка ближе */
    .hs-faq-btn,
    .hs-faq-btn:visited{
      display:inline-flex; align-items:center; gap:0;
      padding:8px 12px;                 /* ЧУТЬ МЕНЬШЕ */
      border-radius:999px;
      background:#fff;
      border:1px solid #E8DED4;
      text-decoration:none;
      font:inherit;                      /* типографика как в модалке */
      font-size:14px;                    /* ЧУТЬ МЕНЬШЕ */
      line-height:1.2;
      color:#000 !important;             /* ЧЁРНЫЙ текст */
      box-shadow:0 3px 10px rgba(0,0,0,.06);
      transition:
        transform .12s ease,
        box-shadow .12s ease,
        background-color .12s ease,
        border-color .12s ease;
      will-change: transform;
    }
    .hs-faq-btn:hover{
      background:#F6F0EA;
      box-shadow:0 6px 18px rgba(0,0,0,.10);
      transform:translateY(-1px);
    }
    .hs-faq-btn:active{
      transform:translateY(0);
      box-shadow:0 2px 8px rgba(0,0,0,.06);
    }
    .hs-faq-btn:focus-visible{
      outline:2px solid rgba(129,104,86,.35);
      outline-offset:2px;
    }
    .hs-faq-btn svg{ display:none !important; }   /* прячем кругляш/иконку */
    .hs-faq-btn span{ color:inherit; font:inherit; }
    /* Подсветка целевого аккордеона на странице FAQ при авто-раскрытии */
    .hs-faq-highlight{ box-shadow:0 0 0 2px #8168561f inset; border-radius:12px; }
  `;
  let st = document.getElementById('hsFaqBtnStyles');
  if (st) st.textContent = css;
  else {
    st = document.createElement('style');
    st.id = 'hsFaqBtnStyles';
    st.textContent = css;
    document.head.appendChild(st);
  }
})();

/* Авто-раскрытие нужного аккордеона на странице /faq (хлопковый/деревянный/диффузор) */
(function faqAutoOpenHelper(){
  const want = (() => {
    const hash = (location.hash || '').replace(/^#/, '');
    const sp = new URLSearchParams(hash);
    const viaHash = sp.get('open');
    const viaSS = sessionStorage.getItem('hs_faq_open');
    return viaHash || viaSS || null;
  })();

  if (!/\/faq\/?$/.test(location.pathname)) return;
  if (!want) return;

  const MAP = {
    'cotton-wick': {
      id: 'faq-cotton-wick',
      data: 'cotton-wick',
      title: 'Инструкция по использованию свечей с хлопковым фитилём'
    },
    'wood-wick': {
      id: 'faq-wood-wick',
      data: 'wood-wick',
      title: 'Инструкция по использованию свечей с деревянным фитилём'
    },
    'home-diffuser': {
      id: 'faq-home-diffuser',
      data: 'home-diffuser',
      title: 'Инструкция по использованию диффузоров для дома'
    }
  };

  const conf = MAP[want];

  function textIncludes(node, txt){
    return (node?.innerText || node?.textContent || '').toLowerCase().includes(String(txt).toLowerCase());
  }

  function tryOpen(el){
    if (!el) return false;

    // <details>
    const details = el.closest('details');
    if (details){
      details.open = true;
      details.classList.add('hs-faq-highlight');
      details.scrollIntoView({behavior:'smooth', block:'start'});
      setTimeout(()=> details.classList.remove('hs-faq-highlight'), 1800);
      return true;
    }

    // Популярные аккордеоны
    const clickableHeader =
      el.closest('.t-accordion__item')?.querySelector('.t-accordion__header') ||
      el.closest('.t776__accordion')?.querySelector('.t776__tab-title') ||
      el.closest('[data-accordion]')?.querySelector('[data-accordion-control]') ||
      el.closest('.js-accordion')?.querySelector('.js-accordion-title') ||
      el;

    if (clickableHeader){
      const content =
        clickableHeader.parentElement?.querySelector('.t-accordion__content') ||
        clickableHeader.parentElement?.querySelector('.t776__tab-content') ||
        clickableHeader.parentElement?.querySelector('[data-accordion-content]');
      const isOpen = content && (content.style.display !== 'none' && content.offsetHeight > 0);
      if (!isOpen) clickableHeader.click();
      (content || clickableHeader).classList.add('hs-faq-highlight');
      (content || clickableHeader).scrollIntoView({behavior:'smooth', block:'start'});
      setTimeout(()=> (content || clickableHeader).classList.remove('hs-faq-highlight'), 1800);
      return true;
    }
    return false;
  }

  window.addEventListener('DOMContentLoaded', ()=>{
    let target = null;

    if (conf){
      target =
        document.getElementById(conf.id) ||
        document.querySelector(`[data-faq="${conf.data}"]`);
      if (!target && conf.title){
        target =
          Array.from(document.querySelectorAll('summary, .t-accordion__title, .t-accordion__header, .t776__tab-title, [data-accordion-control], .js-accordion-title, h3, h4, button'))
            .find(n => textIncludes(n, conf.title));
      }
    } else {
      // Фолбэк: ищем любой из заголовков
      const titles = Object.values(MAP).map(x => x.title);
      target =
        Array.from(document.querySelectorAll('summary, .t-accordion__title, .t-accordion__header, .t776__tab-title, [data-accordion-control], .js-accordion-title, h3, h4, button'))
          .find(n => titles.some(t => textIncludes(n, t)));
    }

    if (tryOpen(target)){
      sessionStorage.removeItem('hs_faq_open');
      const h = (location.hash || '').replace(/^#/, '');
      const sp = new URLSearchParams(h);
      if (sp.get('open')) {
        sp.delete('open');
        const newHash = sp.toString();
        history.replaceState(null, '', newHash ? ('#' + newHash) : location.pathname + location.search);
      }
    }
  });
})();

/* ======================== КОРЗИНА ======================== */
function addToCart({id, title, image, variant, volume, unitPrice}) {
  const keyOf = (x) => `${x.id}__${x.variant}__${x.volume}`;
  const idx = cartItems.findIndex(x => keyOf(x) === keyOf({id, variant, volume}));
  if (idx > -1) cartItems[idx].qty += 1;
  else cartItems.push({ id, title, image, variant, volume, unitPrice, qty: 1 });
  updateCartCounter();
  updateCartSection();
  saveState();
  return true;
}

function updateCartCounter(){
  const el = document.querySelector('.cart-icon-container .icon-badge');
  const totalQty = cartItems.reduce((s,i)=> s + (i.qty||0), 0);
  if (el) el.textContent = totalQty;
}
function updateFavoriteCounter(){
  const badge = document.querySelector('.favorite-icon .icon-badge');
  if (!badge) return;
  badge.textContent = favoriteItems.length;
  const icon = document.querySelector('.favorite-icon');
  if (favoriteItems.length > 0){
    icon?.classList.add('active');
    icon?.querySelector('i')?.classList.replace('far','fas');
  } else {
    icon?.classList.remove('active');
    icon?.querySelector('i')?.classList.replace('fas','far');
  }
}

/* ======================== ГЛОБАЛЬНЫЕ СТИЛИ (цены, избранное) ======================== */
(function ensurePriceStyles(){
  if(!document.getElementById('hsPriceStylesGlobal')){
    const st = document.createElement('style');
    st.id = 'hsPriceStylesGlobal';
    st.textContent = `
      .hs-price{display:flex;align-items:baseline;gap:10px;font-size:20px;color:#7a6d66}
      .hs-price .price-old{text-decoration:line-through;opacity:.6}
      .hs-price .price-new{font-weight:600;color:#5a4a42}
    `;
    document.head.appendChild(st);
  }
})();

/* Круглый минималистичный крестик удаления (избранное) */
(function ensureFavRemoveStyles(){
  if(!document.getElementById('hsFavRemoveStyles')){
    const st = document.createElement('style');
    st.id = 'hsFavRemoveStyles';
    st.textContent = `
      .favorite-item-remove{
        width: clamp(28px, 5.4vw, 32px);
        height: clamp(28px, 5.4vw, 32px);
        border-radius: 999px;
        border: 1px solid #E8DED4;
        background: #FFFFFF;
        color: #816856;
        display: inline-grid;
        place-items: center;
        box-shadow: 0 2px 8px rgba(0,0,0,.06);
        transition: transform .12s ease, box-shadow .12s ease, background-color .12s ease, border-color .12s ease;
        vertical-align: middle;
      }
      .favorite-item-remove:hover{ background: #F6F0EA; box-shadow: 0 4px 12px rgba(0,0,0,.08); }
      .favorite-item-remove:active{ transform: scale(.96); }
      .favorite-item-remove:focus-visible{ outline:2px solid #816856; outline-offset:2px; }
      .favorite-item-remove .x-ic{ width: 12px; height: 12px; display:block; }
      @media (prefers-reduced-motion: reduce){ .favorite-item-remove{ transition: none; } }
    `;
    document.head.appendChild(st);
  }
})();

/* Узкая капсула "Очистить" (избранное) — чёрный текст */
(function ensureFavClearStyles(){
  const css = `
    .favorites-clear-wrap{
      margin-top: 12px;
      display: flex;
      justify-content: flex-end;
    }
    .favorites-clear-btn{
      width: auto;
      padding: 8px 14px;
      border-radius: 999px;
      border: 1px dashed #E8DED4;
      background: #FFFFFF;
      color: #000;
      font-size: 14px;
      line-height: 1;
      cursor: pointer;
      box-shadow: 0 2px 8px rgba(0,0,0,.05);
      transition: background-color .12s ease, transform .12s ease, box-shadow .12s ease, border-color .12s ease;
    }
    .favorites-clear-btn:hover{
      background:#F6F0EA;
      box-shadow:0 4px 12px rgba(0,0,0,.08);
      border-color:#D9CBBD;
    }
    .favorites-clear-btn:active{ transform: scale(.99); }
    .favorites-clear-btn:focus-visible{ outline:2px solid #816856; outline-offset:2px; }
    @media (prefers-reduced-motion: reduce){ .favorites-clear-btn{ transition:none; } }
  `;
  const existing = document.getElementById('hsFavClearStyles');
  if (existing) {
    existing.textContent = css;
  } else {
    const st = document.createElement('style');
    st.id = 'hsFavClearStyles';
    st.textContent = css;
    document.head.appendChild(st);
  }
})();

/* === УМЕНЬШЕННАЯ АРОМАТИЧЕСКАЯ ПИРАМИДА (слегка уменьшенный шрифт, тёмный текст) === */
(function ensureAromaPyramidSmall(){
  const css = `
    #aromaPyramid{
      max-width: 420px !important;
      margin: 20px auto 16px !important; /* немного места снизу под текст */
      --ap-color:#3A2E28;
      --ap-color-sub:#4A3B34;
      font-family: 'Gotham','Gotham Book','Helvetica Neue',Arial,sans-serif !important;
      overflow: visible !important; /* не режем нижние слои и текст */
    }
    #aromaPyramid .pyramid-triangle{
      width: 140px !important; height: 90px !important; margin: 10px auto !important;
      background: linear-gradient(180deg, #e8ded4, #f6f0ea);
      clip-path: polygon(50% 0%, 0% 100%, 100% 100%);
      opacity:.85;
    }
    #aromaPyramid .pyramid-layer{
      padding: 10px 14px !important;
      font-size: 14px !important;
      line-height: 1.48 !important;
      border-radius: 12px !important;
      margin: 8px 0 !important;
      color: var(--ap-color) !important;
      background:#fff;
      border:1px solid #E8DED4;
      box-shadow:0 2px 8px rgba(0,0,0,.04);
    }
    #aromaPyramid .pyramid-layer-title{
      font-size: 15px !important;
      line-height: 1.3 !important;
      font-weight: 700 !important;
      letter-spacing: .2px !important;
      color: var(--ap-color) !important;
      margin-bottom:4px;
    }
    #aromaPyramid .pyramid-layer-notes{
      font-size: 13.6px !important;
      line-height: 1.5 !important;
      opacity: .98 !important;
      letter-spacing: .1px !important;
      color: var(--ap-color) !important;
    }
    #aromaPyramid .pyramid-connector{
      width: 2px !important; height: 16px !important; margin: 8px auto !important;
      border-radius: 2px !important; background:#c9b9ae;
    }
    @media (max-width: 480px){
      #aromaPyramid{ max-width: 340px !important; }
      #aromaPyramid .pyramid-triangle{ width: 110px !important; height: 70px !important; }
      #aromaPyramid .pyramid-layer-title{ font-size: 14px !important; }
      #aromaPyramid .pyramid-layer-notes{ font-size: 13.2px !important; }
    }
  `;
  const existing = document.getElementById('hsAromaPyramidSmall');
  if (existing) {
    existing.textContent = css;
  } else {
    const st = document.createElement('style');
    st.id = 'hsAromaPyramidSmall';
    st.textContent = css;
    document.head.appendChild(st);
  }
})();

/* ======================== ХЕЛПЕРЫ ЦЕН ======================== */
function ensurePriceSlots(el){
  if(!el) return null;
  el.classList.add('hs-price');
  if(!el.querySelector('.price-old') || !el.querySelector('.price-new')){
    el.innerHTML = '<span class="price-old"></span> <span class="price-new"></span>';
  }
  return el;
}
function renderPrice(el, newPrice, oldPrice){
  const holder = ensurePriceSlots(el);
  if(!holder) return;
  holder.querySelector('.price-old').textContent = oldPrice ? fmt(oldPrice) : '';
  holder.querySelector('.price-new').textContent = fmt(newPrice ?? 0);
}

/* ======================== ПРИ ЗАГРУЗКЕ ДОКУМЕНТА ======================== */
document.addEventListener('DOMContentLoaded', function(){

  /* ------ Меню ------ */
  const menuToggle = document.querySelector('.menu-toggle');
  const navContainer = document.querySelector('.nav-container');
  menuToggle?.addEventListener('click', () => navContainer?.classList.toggle('active'));
  document.querySelectorAll('.nav-link').forEach(l => {
    l.addEventListener('click', ()=> navContainer?.classList.remove('active'));
  });

  /* ------ Карусель героя (без автопрокрутки, только стрелки) ------ */
  const carousel = document.getElementById('carousel');
  const slides = document.querySelectorAll('.carousel-slide');
  const prevButton = document.querySelector('.carousel-button.prev');
  const nextButton = document.querySelector('.carousel-button.next');
  const slideInfos = document.querySelectorAll('.slide-info');
  let currentIndex = 0;
  const totalSlides = slides.length;

  function updateCarousel(){
    const translateValue = -currentIndex * 100;
    if (carousel) carousel.style.transform = `translateX(${translateValue}%)`;
    slideInfos.forEach((info, idx)=>{
      if(idx === currentIndex){
        info.style.animation = 'slideUpFadeIn 0.8s forwards';
      } else {
        info.style.animation = 'none';
        info.style.opacity = '0';
        info.style.transform = 'translateY(20px)';
      }
    });
  }
  function nextSlide(){
    if (!totalSlides) return;
    currentIndex = (currentIndex + 1) % totalSlides;
    updateCarousel();
  }
  function prevSlide(){
    if (!totalSlides) return;
    currentIndex = (currentIndex - 1 + totalSlides) % totalSlides;
    updateCarousel();
  }

  prevButton?.addEventListener('click', prevSlide);
  nextButton?.addEventListener('click', nextSlide);

  updateCarousel();

  /* ------ Избранное ------ */
  const galleries = document.querySelectorAll('.product-gallery');

  function updateFavoriteButtonState(card, variant){
    const btn = card.querySelector('.favorite-btn');
    const id = card.getAttribute('data-id');
    const isFavorite = favoriteItems.some(i => i.id === id && i.variant === variant);
    if (isFavorite){
      btn?.classList.add('active');
      btn?.querySelector('i')?.classList.replace('far','fas');
    } else {
      btn?.classList.remove('active');
      btn?.querySelector('i')?.classList.replace('fas','far');
    }
  }

  // Инициализация сердечек при загрузке
  galleries.forEach(g=>{
    const card = g.closest('.product-card');
    const variantSelect = card?.querySelector('.variant-select');
    const variantText = variantSelect?.options[variantSelect.selectedIndex]?.text || '';
    if (card) updateFavoriteButtonState(card, variantText);
  });

  // Клик по сердцу — сохраняем только итоговую цену
  galleries.forEach(g=>{
    const btn = g.querySelector('.favorite-btn');
    const card = g.closest('.product-card');
    const id = card?.getAttribute('data-id');
    btn?.addEventListener('click', function(e){
      e.stopPropagation();
      const title = card.querySelector('.product-title')?.textContent || '';
      const priceNode = card.querySelector('.product-price');
      let finalPrice = '';
      if (priceNode){
        const newEl = priceNode.querySelector?.('.price-new');
        finalPrice = (newEl && newEl.textContent.trim()) ? newEl.textContent.trim() : (priceNode.textContent || '').trim();
      }
      const image = card.querySelector('.gallery-image')?.src || '';
      const variantSelect = card.querySelector('.variant-select');
      const variant = variantSelect?.options[variantSelect.selectedIndex]?.text || '';
      const i = favoriteItems.findIndex(x => x.id === id && x.variant === variant);
      if(i === -1){
        favoriteItems.push({ id, title, price: finalPrice, image, variant });
        btn.classList.add('active');
        btn.querySelector('i').classList.replace('far','fas');
        btn.style.transform = 'scale(1.2)';
        setTimeout(()=> btn.style.transform='scale(1)', 300);
      } else {
        favoriteItems.splice(i, 1);
        btn.classList.remove('active');
        btn.querySelector('i').classList.replace('fas','far');
      }
      updateFavoriteCounter();
      saveState();
    });
  });

  // Смена вариантов: актуализируем сердечко и цену в карточке
  document.querySelectorAll('.variant-select').forEach(select=>{
    select.addEventListener('change', function(){
      const card = this.closest('.product-card');
      if (!card) return;
      const selects = card.querySelectorAll('.product-variants .variant-select');
      const variant = selects[0]?.options[selects[0].selectedIndex]?.text || '';
      updateFavoriteButtonState(card, variant);
      const opt = this.options[this.selectedIndex];
      const priceAttr = opt?.getAttribute('data-price');
      const oldPriceAttr = opt?.getAttribute('data-old-price');
      const priceEl = card.querySelector('.product-price');
      if (priceAttr && priceEl){
        if (priceEl.classList.contains('hs-price')) {
          renderPrice(priceEl, priceAttr, oldPriceAttr);
        } else {
          priceEl.textContent = fmt(Number(priceAttr));
        }
      }
    });
  });

  /* ------ Добавление в корзину из карточки ------ */
  function getCardData(card){
    const id = card.getAttribute('data-id');
    const title = card.querySelector('.product-title')?.textContent || '';
    const image = card.querySelector('.gallery-image')?.src || '';
    const selects = card.querySelectorAll('.product-variants .variant-select'); // [0] — аромат, [1] — объём/фитиль
    const variant = selects[0]?.options[selects[0].selectedIndex]?.text || '';
    const volumeOpt = selects[1]?.options[selects[1].selectedIndex];
    const volume = volumeOpt?.value || '';
    const unitPrice = volumeOpt?.getAttribute('data-price')
      ? Number(volumeOpt.getAttribute('data-price'))
      : num(card.querySelector('.product-price')?.querySelector?.('.price-new')?.textContent || card.querySelector('.product-price')?.textContent);
    return { id, title, image, variant, volume, unitPrice };
  }
  document.querySelectorAll('.add-to-cart').forEach(btn=>{
    btn.addEventListener('click', function(e){
      e.stopPropagation();
      const card = this.closest('.product-card');
      if (!card) return;
      addToCart(getCardData(card));
      // Локальный фидбек (дублируется и патчем ниже, но оставляем для бэкапа)
      const orig = this.textContent;
      const w = this.offsetWidth;
      this.style.width = w + 'px';
      this.textContent = 'Добавлено!';
      this.style.backgroundColor = '#b99f94';
      setTimeout(()=>{
        this.textContent = orig;
        this.style.backgroundColor = '#5a4a42';
        this.style.width='';
      }, 1200);
    });
  });

  /* ------ Модалка товара ------ */
  const modal = document.getElementById('productModal');
  const closeModalBtn = document.querySelector('.close-modal');
  const modalGallery = document.getElementById('modalGallery');
  const modalTitle = document.getElementById('modalTitle');
  const modalPrice = document.getElementById('modalPrice');
  const modalDescription = document.getElementById('modalDescription');
  const modalVariants = document.getElementById('modalVariants');
  const modalAddToCartBtn = document.getElementById('modalAddToCart');

  // Закрыть по крестику
  closeModalBtn?.addEventListener('click', ()=> modal.style.display='none');

  // Закрыть по клику на оверлей (вне контента)
  modal?.addEventListener('click', (e)=>{
    if (e.target === modal) modal.style.display='none';
  });

  // Закрыть по ESC
  document.addEventListener('keydown', (e)=>{
    if(e.key === 'Escape' && modal && modal.style.display === 'block'){
      modal.style.display = 'none';
    }
  });

  // ====== ОПИСАНИЯ (обновлено) ======
  const DESC = {
    oil: `Масляные духи с роликовым аппликатором ${EMOJI_HEART}

Держатся около 3–6 часов (в зависимости от времени года и интенсивности повседневной жизни).
Пожалуйста, наносите духи на кожу, избегая попадания на одежду. Духи в своём составе имеют масла, поэтому важно дать им впитаться — достаточно 10–15 минут, чтобы на одежде не оставались масляные следы.

Роллер позволяет наносить духи точечно: запястья, локтевой сгиб, ключицы, шея.

Рекомендуем хранить флакон вертикально — из-за роликового шарика возможны лёгкие подтёки. Во время экстремальной доставки духи тоже могут немного протечь — после получения протрите флакон, и он готов к использованию.`,

    spray: `Спрей-духи в объёме 5 или 10 мл — самый стойкий и интенсивный формат парфюма во всём нашем ассортименте.
Экономичный расход: достаточно 1–2 пшиков, чтобы аромат остался с вами надолго.

Держатся около 12 часов (в зависимости от времени года и интенсивности повседневной жизни).
Пожалуйста, наносите духи на кожу, избегая попадания на одежду. В составе есть ароматическое масло, поэтому дайте аромату впитаться 10–15 минут, чтобы не осталось следов.

Чтобы получить максимум от аромата, распыляйте на чистую, слегка увлажнённую кожу на точки пульса (запястья, шея, сгиб локтя) и не растирайте — так верхние ноты звучат ярче и дольше.`,

    solid: `Прекрасная альтернатива классическому парфюму! Миниатюрные баночки удобно носить с собой и брать в путешествия.
Очень экономичный расход — одной баночки хватает примерно на 2 месяца. Подойдут тем, кто не любит интенсивные запахи.

Мы рекомендуем наносить твёрдые духи на запястья, шею, ключицы, углубления за мочками ушей и в сгиб локтя. Если нанести духи на волосы, аромат продержится дольше и будет тянуться за вами ненавязчивым шлейфом.`,

    candle30: `Отличный вариант для тех, кто хочет познакомиться с новым ароматом! Эти свечи удобно брать с собой в поездки — они буквально умещаются в ладошке

Общее время горения свечи — 4 часа.

Лайфхак: наши мини-свечи можно использовать в качестве аромасаше. Снимите крышку, поместите баночку в шкаф, комод или любое другое закрытое пространство и оставьте там. Открытая свеча будет наполнять ароматом выбранное вами место`,

    candle100: `Ароматические свечи в минималистичном дизайне с хлопковым или деревянным фитилём.

Свеча способна наполнить комнату ароматом всего за 15 минут — проверено не раз!
Общее время горения свечи — 14 часов.

Вы можете выбрать любой аромат и создать себе ту атмосферу, которую пожелаете: утро в лесной чаще, полдень у побережья океана, обед со свежевыпеченным хлебом, ужин с бокалом розового шампанского.

Все эти ароматы можно найти в нашей линейке, чтобы в любой момент наколдовать себе необходимое настроение. Ведь не зря на крышечках наших свечей красуется девиз «Зажги свою фантазию»`,

    diffuser: `Если вам хочется поддерживать в своём доме аромат морозного можжевельника, тёплой древесины или сочного персика, то наши диффузоры идеально подойдут для этих целей!
    
В наборе с диффузором поставляется 5 фибровых палочек, с помощью которых вы сможете контролировать интенсивность аромата.

Весь набор укомплектовывается в стильную белую коробочку, поэтому идеально подойдёт в качестве премиального подарка.`
  };

  const DESC_BY_ID = {
    '1': DESC.oil,
    '2': DESC.spray,
    '3': DESC.solid,
    '4': DESC.candle30,   // «малышка» = 30 мл
    '5': DESC.candle100,  // 100 мл
    '6': DESC.diffuser    // диффузор
  };

  /* === НОВАЯ ПЛАШКА "СОСТАВ" В МОДАЛКЕ (ВЫШЕ ПЛАШКИ АРОМАТА) === */
  const COMPOSITION = {
    oil: `Премиальные ароматы производства США, фракция кокосового масла, силиконовое масло. Не содержат спирт!`,
    spray: `Премиальные ароматические масла производства США и косметический спирт.
Если у вас очень чувствительная кожа — рекомендуем выбрать масляные духи.`,
    solid: `Натуральный соевый вокс производства Великобритании, масло кокоса, масло виноградной косточки и премиальные ароматы из США.`
  };

  const COMPOSITION_BY_ID = {
    '1': COMPOSITION.oil,
    '2': COMPOSITION.spray,
    '3': COMPOSITION.solid
  };

  function pickComposition(id, title){
    const t = String(title || '').toLowerCase();
    if (COMPOSITION_BY_ID[String(id)]) return COMPOSITION_BY_ID[String(id)];
    if (t.includes('маслян') || t.includes('ролик')) return COMPOSITION.oil;
    if (t.includes('спрей')) return COMPOSITION.spray;
    if (t.includes('твёрд') || t.includes('твердые духи')) return COMPOSITION.solid;
    return '';
  }

  function ensureCompositionElement(){
    if (!modalDescription) return null;
    let box = modalDescription.querySelector('#modalComposition');
    if (!box){
      box = document.createElement('div');
      box.id = 'modalComposition';
      box.className = 'modal-composition-box';
      modalDescription.appendChild(box);
    }
    return box;
  }

  function updateModalComposition(id, title){
    const box = ensureCompositionElement();
    if (!box) return;
    const text = pickComposition(id, title);
    if (!text){
      box.style.display = 'none';
      box.innerHTML = '';
      return;
    }
    box.style.display = '';
    box.innerHTML = `
      <div class="modal-composition-title">Состав</div> <div class="modal-composition-text">${linkifyMultiline(text)}</div>
    `;
  }

  function linkifyMultiline(text){
    // Экранируем и делаем ссылки кликабельными, переносы сохраняем
    const esc = String(text||'')
      .replace(/&/g,'&amp;')
      .replace(/</g,'&lt;')
      .replace(/>/g,'&gt;')
      .replace(/"/g,'&quot;')
      .replace(/'/g,'&#039;');
    const withLinks = esc.replace(/(https?:\/\/[^\s)]+)/g, '<a href="$1" target="_blank" rel="noopener">$1</a>');
    return withLinks.replace(/\n/g,'<br>');
  }

  function pickDescription(id, title){
    const t = String(title||'').toLowerCase();
    if (DESC_BY_ID[String(id)]) return DESC_BY_ID[String(id)];
    if (t.includes('диффузор') || t.includes('diffuser') || t.includes('аромадиффузор')) return DESC.diffuser;
    if (t.includes('30 мл') || t.includes('30ml') || t.includes('мини') || t.includes('малыш')) return DESC.candle30;
    if (t.includes('100 мл') || t.includes('100ml')) return DESC.candle100;
    if (t.includes('маслян') || t.includes('ролик')) return DESC.oil;
    if (t.includes('спрей')) return DESC.spray;
    if (t.includes('твёрд') || t.includes('твердые духи')) return DESC.solid;
    return 'Подробное описание товара';
  }

  // Создаём кнопку для перехода в FAQ и авто-раскрытия нужного пункта (без иконки, чёрный текст)
  function appendFaqButton(targetEl, openKey, labelText){
    if (!targetEl) return;
    const wrap = document.createElement('div');
    wrap.className = 'hs-faq-btn-wrap';
    const a = document.createElement('a');
    a.className = 'hs-faq-btn';
    a.href = `https://home-secret.shop/faq#open=${encodeURIComponent(openKey)}`;
    a.innerHTML = `<span>${labelText || 'Инструкция по применению'}</span>`;
    a.addEventListener('click', ()=>{
      sessionStorage.setItem('hs_faq_open', openKey);
    }, {passive:true});
    wrap.appendChild(a);
    targetEl.appendChild(wrap);
  }

  /* ======================== ПЛАШКА ОПИСАНИЯ АРОМАТА В МОДАЛКЕ ======================== */

  // Нормализатор строки (используем ниже и для пирамиды, и для описаний)
  function norm(s){
    return String(s||'')
      .toLowerCase()
      .replace(/&/g,'и')
      .replace(/[«»"']/g,'')
      .replace(/[-–—]/g,' ')
      .replace(/\s+/g,' ')
      .trim();
  }

  // Карта описаний ароматов (из ТЗ + новые ароматы)
  const AROMA_DESCRIPTION_BY_NAME = (()=>{
    const raw = {
      'Груша в бренди': `Яркий приторный аромат с едва уловимой терпкой нотой специй. Алкоголь в аромате почти не чувствуется, его перекрывает сладость груши.`,
      'Дух шамана': `Унисекс-аромат, похожий на мужской парфюм. Свежий и довольно «тяжёлый». Отличный вариант, если ищете аромат для мужчины.`,
      'Заснеженный можжевельник': `На первый план выходят цитрусовые ноты, которые быстро перекрываются сладковатым запахом можжевельника. Преобладают хвойные ноты со сладким оттенком.`,
      'Горячий хлеб': `Пахнет ровно так, как и называется: свежеиспечённый хлеб. В аромате чувствуется слегка кисловатый запах дрожжей, как у тёплой хлебной корочки.`,
      'Персиковый нектар': `Не приторный аромат, в котором ярко чувствуются зелёные ноты. Больше напоминает запах незрелого, ещё зелёного персика. Подойдёт тем, кто хочет сладкий аромат, но не любит ванильную приторность.`,
      'Смородина & мята': `Сладкий аромат со спокойными нотами мяты. Запах спелой ягоды красной и чёрной смородины с лёгким оттенком свежести. Не приторный, но сам по себе довольно «громкий».`,
      'Дубовый мох & янтарь': `Спокойный древесный аромат, не яркий. Чувствуются травяные ноты, но преобладает запах древесной коры. Идеален для тех, кто не любит яркие ароматы и предпочитает «фоновую» ароматизацию.`,
      'Летние закаты': `Унисекс-аромат, довольно «тяжёлый», с яркими нотами пачули. На втором плане хорошо слышен древесный запах, но пачули остаётся на первом. Тёплый аромат, который красиво раскрывается на коже.`,
      'Розовые кристаллы': `Сладость, возведённая в абсолют. Для тех, кто очень любит приторные ароматы и сладкую вату. Хорошо ощущаются ноты малины и немного клубники.`,
      'Египетский янтарь': `Тёплый аромат с яркими нотами кожи и сандала. Унисекс — подойдёт и мужчинам, и девушкам. Лёгкие ноты специй, в целом — древесный аромат с едва уловимой сладостью и специями.`,
      'Морская соль & орхидея': `Свежий, зелёный аромат. Хорошо чувствуется зелень, а цветочные ноты уходят на дальний план и почти не ощущаются. Нравится многим за счёт своей необычности, отлично подходит в качестве подарка.`,
      'Вино Тосканы': `Яркий сладкий аромат спелого винограда. Хорошо слышны специи и древесные ноты. Не похож на виноградный сок — более сложный, напоминает благородное терпкое вино.`,
      'Антикварная библиотека': `Будто держите в руках очень древнюю книгу: благородный запах старой бумаги, дерева и кожи. В аромате преобладают древесные и кожаные ноты с налётом таинственности.`,
      'Мох & папоротник': `Аромат леса после дождя: травяные ноты, свежесть, ощущение тёмного, загадочного леса. Более свежий, чем остальные древесные ароматы, и часто становится личным фаворитом.`,
      'Розовое шампанское': `Искрящийся аромат с заметными алкогольными нотами. На заднем плане ощущается роза, специи почти не слышны. Подойдёт тем, кто хочет добавить в образ яркую изюминку.`,
      'Табак & ваниль': `Унисекс-аромат, где на первый план выходит терпкий запах специй и табачного листа. На фоне слышны древесные ноты. В целом — тёплый, сложный и терпкий аромат. Не похож на одноимённый парфюм Tom Ford.`,
      'Чистый хлопок': `Лёгкий свежий аромат, напоминающий запах свежевыстиранного постельного белья. Тёплый, не резкий, на коже раскрывается мягким лёгким шлейфом.`,
      'Карамельный попкорн': `Очень яркий приторный аромат сладкого попкорна, который хочется съесть за просмотром фильма. Осторожно: может спровоцировать тягу к сладкому!`,
      'Чао-какао': `Яркий приторный запах горячего шоколада. Аромат детства и ностальгии, будто кружка какао и тёплый плед в один флакон.`,

      /* НОВЫЕ АРОМАТЫ ДЛЯ МОДАЛКИ */
      'Снежная пихта': `Яркий хвойный аромат, который напомнит об атмосфере Нового года и свежего зимнего леса. На заднем плане ощущаются лёгкие цитрусовые ноты, добавляющие аромату свежести и объёма.`,
      'Манго & кокосовое молоко': `Яркий сладкий фруктовый аромат, напоминающий коктейль «Пина колада». Тропический, солнечный и игривый — отлично подойдёт тем, кто хочет всегда ощущать лето.`,
      'Грейпфрут & мята': `Сладковато-ягодный аромат с выраженным запахом мяты. Не приторный: свежая мята выводится на первый план и балансирует сладость, создавая ощущение прохлады.`
    };
    const map = {};
    Object.keys(raw).forEach(name => {
      map[norm(name)] = raw[name];
    });
    return map;
  })();

  function getAromaDescriptionByName(label){
    const n = norm(label || '');
    if (!n) return '';
    if (AROMA_DESCRIPTION_BY_NAME[n]) return AROMA_DESCRIPTION_BY_NAME[n];
    const entries = Object.entries(AROMA_DESCRIPTION_BY_NAME);
    const found = entries.find(([k]) => n.includes(k) || k.includes(n));
    return found ? found[1] : '';
  }

  function ensureAromaNoteElement(){
    if (!modalDescription) return null;
    let box = modalDescription.querySelector('#modalAromaNote');
    if (!box){
      box = document.createElement('div');
      box.id = 'modalAromaNote';
      box.className = 'modal-aroma-note';
      modalDescription.appendChild(box);
    }
    return box;
  }

  function updateModalAromaNoteFromSelect(selectEl){
    const box = ensureAromaNoteElement();
    if (!box) return;
    if (!selectEl){
      box.style.display = 'none';
      box.innerHTML = '';
      return;
    }
    const opt = selectEl.options[selectEl.selectedIndex];
    const aromaName = opt ? (opt.textContent || opt.innerText || '').trim() : '';
    const desc = getAromaDescriptionByName(aromaName);
    if (!desc){
      box.style.display = 'none';
      box.innerHTML = '';
      return;
    }
    box.style.display = '';
    box.innerHTML = `
      <div class="modal-aroma-note-title">${aromaName}</div> <div class="modal-aroma-note-text">${desc}</div>
    `;
  }

  // ==== ОТКРЫТИЕ МОДАЛКИ ПО КАРТОЧКЕ ====
  document.querySelectorAll('.product-card').forEach(card=>{
    card.addEventListener('click', function(e){
      if(e.target.closest('.add-to-cart') || e.target.closest('.favorite-btn') || e.target.closest('.variant-select')) return;

      const id = this.getAttribute('data-id');
      const title = this.querySelector('.product-title')?.textContent || '';

      // Галерея
      const galleryImages = this.querySelectorAll('.gallery-image');
      modalGallery.innerHTML = '';
      const img = document.createElement('img');
      img.src = (galleryImages.length > 1 ? galleryImages[1].src : galleryImages[0]?.src || '');
      img.alt = title;
      Object.assign(img.style, { width:'100%', height:'100%', objectFit:'cover' });
      img.loading = 'lazy';
      img.decoding = 'async';
      modalGallery.appendChild(img);

      modalTitle.textContent = title;

      // ОПИСАНИЕ: умный выбор + кликабельные ссылки
      const picked = pickDescription(id, title);
      modalDescription.innerHTML = linkifyMultiline(picked);
      modalDescription.style.whiteSpace = 'pre-line';

      // НОВАЯ ПЛАШКА "СОСТАВ" ДЛЯ КОНКРЕТНОГО ТОВАРА (НАД ПЛАШКОЙ АРОМАТА)
      updateModalComposition(id, title);

      // СТАРТОВАЯ ПЛАШКА АРОМАТА ПО ВЫБРАННОМУ В КАРТОЧКЕ АРОМАТУ
      const aromaSelectInCard = this.querySelector('.product-variants .variant-select');
      if (aromaSelectInCard){
        updateModalAromaNoteFromSelect(aromaSelectInCard);
      } else {
        updateModalAromaNoteFromSelect(null);
      }

      // === ВСТАВКА КНОПОК «ИНСТРУКЦИЯ» ДЛЯ СВЕЧЕЙ 30 МЛ и 100 МЛ ===
      if (
        String(id) === '4' || String(id) === '5' ||
        /(^|\s)(30\s*мл|100\s*мл|малыш)/i.test(title)
      ) {
        appendFaqButton(
          modalDescription,
          'cotton-wick',
          'Инструкция по применению (хлопковый фитиль)'
        );
        appendFaqButton(
          modalDescription,
          'wood-wick',
          'Инструкция по применению (деревянный фитиль)'
        );
      }

      // === ВСТАВКА КНОПКИ «ИНСТРУКЦИЯ» ДЛЯ ДИФФУЗОРА ===
      if (
        String(id) === '6' ||
        /диффуз/i.test(title) || /diffuser/i.test(title) || /аромадиффузор/i.test(title)
      ) {
        appendFaqButton(
          modalDescription,
          'home-diffuser',
          'Инструкция по применению (аромадиффузор)'
        );
      }

      // Варианты (клонируем селекты из карточки)
      const variantsContainer = this.querySelectorAll('.product-variants');
      modalVariants.innerHTML = '';
      variantsContainer.forEach(v => modalVariants.appendChild(v.cloneNode(true)));

      // Селекты внутри модалки (0 — аромат, 1 — объём/формат)
      const modalSelects = modalVariants.querySelectorAll('.variant-select');
      const modalAromaSelect = modalSelects[0] || null;

      // Цена в модалке (новая/старая считается, но перечёркнутая скрыта стилями)
      function getActiveOptionFromModal(){
        const sels = modalVariants.querySelectorAll('.variant-select');
        const src = sels[1] || sels[0];
        return src ? src.options[src.selectedIndex] : null;
      }
      function syncModalPrice(){
        const opt = getActiveOptionFromModal();
        const newPrice = opt?.getAttribute('data-price');
        const oldPrice = opt?.getAttribute('data-old-price');
        renderPrice(modalPrice, newPrice, oldPrice);
      }

      renderPrice(
        modalPrice,
        this.querySelector('.product-variants .variant-select:nth-of-type(2) option:checked')?.getAttribute('data-price')
          || this.querySelector('.product-variants .variant-select option:checked')?.getAttribute('data-price') || 0,
        this.querySelector('.product-variants .variant-select:nth-of-type(2) option:checked')?.getAttribute('data-old-price')
          || this.querySelector('.product-variants .variant-select option:checked')?.getAttribute('data-old-price') || ''
      );

      // Связываем селекты в модалке с ценой и плашкой аромата
      modalSelects.forEach(select=>{
        select.addEventListener('change', ()=>{
          syncModalPrice();
          if (select === modalAromaSelect){
            updateModalAromaNoteFromSelect(modalAromaSelect);
          }
        });
        select.addEventListener('input', ()=>{
          syncModalPrice();
          if (select === modalAromaSelect){
            updateModalAromaNoteFromSelect(modalAromaSelect);
          }
        });
      });

      // Стартовый пересчёт цены и плашки аромата (по данным из модалки)
      setTimeout(()=>{
        syncModalPrice();
        if (modalAromaSelect){
          updateModalAromaNoteFromSelect(modalAromaSelect);
        } else {
          updateModalAromaNoteFromSelect(null);
        }
      }, 0);

      // Кнопка модалки
      modalAddToCartBtn.onclick = ()=>{
        const selects = modalVariants.querySelectorAll('.variant-select');
        const variant = selects[0]?.options[selects[0].selectedIndex]?.text || '';
        const volumeOpt = selects[1]?.options[selects[1].selectedIndex];
        const volume = volumeOpt?.value || '';
        const unitPrice = volumeOpt?.getAttribute('data-price') ? Number(volumeOpt.getAttribute('data-price')) : num(modalPrice.textContent);
        const image = img.src;
        addToCart({ id, title, image, variant, volume, unitPrice });

        const w = modalAddToCartBtn.offsetWidth;
        modalAddToCartBtn.style.width = w + 'px';
        modalAddToCartBtn.textContent = 'Добавлено!';
        modalAddToCartBtn.style.backgroundColor = '#b99f94';
        setTimeout(()=>{
          modalAddToCartBtn.textContent='в корзину';
          modalAddToCartBtn.style.backgroundColor='#5a4a42';
          modalAddToCartBtn.style.width='';
        },1200);
      };

      modal.style.display = 'block';
    });
  });

  /* ------ Панели ------ */
  const favoritesPanel = document.getElementById('favoritesPanel');
  const cartPanel = document.getElementById('cartPanel');
  const accountPanel = document.getElementById('accountPanel');
  const panelOverlay = document.getElementById('panelOverlay');
  const closePanelBtns = document.querySelectorAll('.close-panel');
  const headerFavorite = document.getElementById('headerFavorite');
  const headerCart = document.getElementById('headerCart');
  const headerAccount = document.getElementById('headerAccount');

  function openPanel(panel){
    panel?.classList.add('active');
    panelOverlay?.classList.add('active');
    document.body.style.overflow = 'hidden';
  }
  headerFavorite?.addEventListener('click', ()=>{ openPanel(favoritesPanel); updateFavoritesList(); });
  headerCart?.addEventListener('click', ()=>{ openPanel(cartPanel); updateCartSection(); });
  headerAccount?.addEventListener('click', ()=>{ openPanel(accountPanel); });

  function closePanels(){
    favoritesPanel?.classList.remove('active');
    cartPanel?.classList.remove('active');
    accountPanel?.classList.remove('active');
    panelOverlay?.classList.remove('active');
    document.body.style.overflow = '';
  }
  closePanelBtns.forEach(btn=> btn.addEventListener('click', closePanels));
  panelOverlay?.addEventListener('click', closePanels);

  // Табы аккаунта
  document.querySelectorAll('.auth-tab').forEach(tab=>{
    tab.addEventListener('click', ()=>{
      document.querySelectorAll('.auth-tab').forEach(t => t.classList.remove('active'));
      tab.classList.add('active');
      const target = tab.getAttribute('data-target');
      document.querySelectorAll('.auth-form').forEach(f => f.classList.toggle('active', f.id === target));
    });
  });

  // Список избранного
  function updateFavoritesList(){
    const list = document.getElementById('favoritesList');
    if (!list) return;
    list.innerHTML = '';

    if (favoriteItems.length === 0){
      list.innerHTML = `
        <div style="text-align:center; padding:40px 20px;"> <i class="far fa-heart" style="font-size:50px; color:#e6e0d8; margin-bottom:20px;"></i> <p style="color:#7a6d66;">Ваше избранное пока пусто</p> </div>`;
      return;
    }

    favoriteItems.forEach((item, index)=>{
      const el = document.createElement('div');
      el.className = 'favorite-item';
      el.innerHTML = `
        <div class="favorite-item-image"> <img src="${item.image}" alt="${item.title}" loading="lazy" decoding="async"> </div> <div class="favorite-item-details"> <div class="favorite-item-title">${item.title}</div> <div class="favorite-item-variant">${item.variant}</div> <div class="favorite-item-price">${item.price}</div> </div> <button class="favorite-item-remove" data-index="${index}" aria-label="Удалить из избранного" title="Удалить"> <svg class="x-ic" viewBox="0 0 24 24" aria-hidden="true"> <path d="M6 6l12 12M18 6l-12 12" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round"/> </svg> </button>`;
      list.appendChild(el);
    });

    // Кнопка "Очистить"
    const clearWrap = document.createElement('div');
    clearWrap.className = 'favorites-clear-wrap';
    clearWrap.innerHTML = `<button type="button" class="favorites-clear-btn">Очистить</button>`;
    list.appendChild(clearWrap);

    // Снять один элемент
    list.querySelectorAll('.favorite-item-remove').forEach(btn=>{
      btn.addEventListener('click', (e)=>{
        e.stopPropagation();
        const idx = Number(btn.getAttribute('data-index'));
        const removed = favoriteItems[idx];
        const row = btn.closest('.favorite-item');
        row.style.opacity='0';
        row.style.transform='translateX(20px)';
        setTimeout(()=>{
          favoriteItems.splice(idx,1);
          updateFavoritesList();
          updateFavoriteCounter();
          const card = document.querySelector(`.product-card[data-id="${removed?.id||''}"]`);
          if(card) updateFavoriteButtonState(card, removed.variant);
          saveState();
        },200);
      });
    });

    // Очистить всё
    clearWrap.querySelector('.favorites-clear-btn').addEventListener('click', ()=>{
      list.querySelectorAll('.favorite-item').forEach(row=>{
        row.style.opacity='0';
        row.style.transform='translateY(6px)';
      });
      setTimeout(()=>{
        favoriteItems = [];
        saveState();
        updateFavoriteCounter();
        // Сброс сердечек на карточках
        document.querySelectorAll('.product-card .favorite-btn').forEach(b=>{
          b.classList.remove('active');
          b.querySelector('i')?.classList.replace('fas','far');
        });
        updateFavoritesList();
        if (typeof window.showToastHS === 'function') window.showToastHS('Избранное очищено', 'remove');
      }, 180);
    });
  }

  // Корзина
  function updateCartSection(){
    const wrap = document.getElementById('cartContainer');
    const totalEl = document.getElementById('cartTotal');
    if (!wrap || !totalEl) return;

    wrap.innerHTML = '';
    if(cartItems.length === 0){
      wrap.innerHTML = '<p style="text-align:center; padding:50px;">Ваша корзина пока пуста</p>';
      totalEl.textContent = fmt(0);
      return;
    }

    cartItems.forEach((it, idx)=>{
      const lineTotal = it.unitPrice * it.qty;
      const row = document.createElement('div');
      row.className = 'cart-item';
      row.innerHTML = `
        <div class="cart-item-image"><img src="${it.image}" alt="${it.title}" loading="lazy" decoding="async"></div> <div class="cart-item-info"> <div class="cart-item-title">${it.title}</div> <div class="cart-item-meta">${it.variant}${it.volume ? ' · ' + it.volume : ''}</div> <div class="cart-line"> <div class="qty-control"> <button class="qty-btn dec" data-index="${idx}" aria-label="Уменьшить">−</button> <span class="qty-value">${it.qty}</span> <button class="qty-btn inc" data-index="${idx}" aria-label="Увеличить">+</button> </div> <div class="cart-line-price">${fmt(lineTotal)}</div> </div> </div> <button class="remove-item" data-index="${idx}" aria-label="Удалить">×</button>`;
      wrap.appendChild(row);
    });

    wrap.querySelectorAll('.qty-btn.inc').forEach(btn=>{
      btn.addEventListener('click', ()=>{
        const i = Number(btn.getAttribute('data-index'));
        cartItems[i].qty += 1;
        updateCartCounter();
        updateCartSection();
        saveState();
      });
    });
    wrap.querySelectorAll('.qty-btn.dec').forEach(btn=>{
      btn.addEventListener('click', ()=>{
        const i = Number(btn.getAttribute('data-index'));
        cartItems[i].qty = Math.max(1, cartItems[i].qty - 1);
        updateCartCounter();
        updateCartSection();
        saveState();
      });
    });
    wrap.querySelectorAll('.remove-item').forEach(btn=>{
      btn.addEventListener('click', ()=>{
        const i = Number(btn.getAttribute('data-index'));
        cartItems.splice(i,1);
        updateCartCounter();
        updateCartSection();
        saveState();
      });
    });

    const total = cartItems.reduce((s,i)=> s + i.unitPrice * i.qty, 0);
    totalEl.textContent = fmt(total);
  }

  // Оформление (заглушка)
  document.getElementById('checkoutBtn')?.addEventListener('click', function(){
    if(cartItems.length === 0){
      alert('Ваша корзина пуста');
      return;
    }
    alert('Заказ успешно оформлен! Спасибо за покупку.');
    cartItems = [];
    updateCartCounter();
    updateCartSection();
    saveState();
  });

  // Якоря плавно
  document.querySelectorAll('a[href^="#"]').forEach(a=>{
    a.addEventListener('click', function(e){
      const target = document.querySelector(this.getAttribute('href'));
      if(target){
        e.preventDefault();
        window.scrollTo({ top: target.offsetTop - 80, behavior: 'smooth' });
      }
    });
  });

  // Отзывы — пагинация (1 на мобиле, 3 на десктопе)
  const reviews = document.querySelectorAll('.review');
  const prevReviewBtn = document.querySelector('.prev-review');
  const nextReviewBtn = document.querySelector('.next-review');
  let currentReviewIndex = 0;
  const perPage = ()=> window.innerWidth < 768 ? 1 : 3;

  function updateReviews(){
    const p = perPage();
    reviews.forEach((review, index)=>{
      review.style.display = (index >= currentReviewIndex && index < currentReviewIndex + p) ? 'block' : 'none';
    });
    if (prevReviewBtn) prevReviewBtn.disabled = currentReviewIndex === 0;
    if (nextReviewBtn) nextReviewBtn.disabled = (currentReviewIndex + p) >= reviews.length;
  }
  prevReviewBtn?.addEventListener('click', ()=>{
    currentReviewIndex = Math.max(0, currentReviewIndex - perPage());
    updateReviews();
  });
  nextReviewBtn?.addEventListener('click', ()=>{
    currentReviewIndex = Math.min(reviews.length - perPage(), currentReviewIndex + perPage());
    updateReviews();
  });
  window.addEventListener('resize', updateReviews);
  updateReviews();

  // Стартовые счётчики
  updateFavoriteCounter();
  updateCartCounter();

  /* ======================== КАК ВЫБРАТЬ АРОМАТ? (ПИРАМИДА) ======================== */
  const aromaList = [
    { key:'citrus', name:'Чистый хлопок',
      pyramid:[
        {level:'top', title:'Верхние ноты',   notes:'Лайм, липа'},
        {level:'middle', title:'Сердечные ноты', notes:'Лаванда, сандал, огуречная вода'},
        {level:'base', title:'Базовые ноты',  notes:'Морская соль, хлопок'}
      ]},

    { key:'vanilla', name:'Манго & кокосовое молоко',
      pyramid:[
        {level:'top',    title:'Апельсин, ананас'},
        {level:'middle', title:'Персик, манго'},
        {level:'base',   title:'Сахар, кокосовое молоко'}
      ]},

    { key:'floral', name:'Снежная пихта',
      pyramid:[
        {level:'top',    title:'Цедра лимона, кипарис'},
        {level:'middle', title:'Вечнозеленое растение, кедр'},
        {level:'base',   title:'Пихта, янтарь, мох'}
      ]},

    { key:'woody', name:'Вино Тосканы',
      pyramid:[
        {level:'top',    title:'Яблочный сок'},
        {level:'middle', title:'Изабелла, мускат'},
        {level:'base',   title:'Табачный лист, кора'}
      ]},

    { key:'fresh', name:'Горячий хлеб',
      pyramid:[
        {level:'top',    title:'Корочка свежего хлеба'},
        {level:'middle', title:'Тост на гриле'},
        {level:'base',   title:'Кумин'}
      ]},

    { key:'pear-brandy', name:'Груша в бренди',
      pyramid:[
        {level:'top',    title:'Корица, гвоздика'},
        {level:'middle', title:'Персик, яблоко, яблочный сидр'},
        {level:'base',   title:'Сахар, бренди'}
      ]},

    { key:'oakmoss-amber', name:'Дубовый мох & янтарь',
      pyramid:[
        {level:'top',    title:'Шалфей, апельсин, грейфрут'},
        {level:'middle', title:'Лаванда'},
        {level:'base',   title:'Дубовый мох, янтарь, бобы тонка'}
      ]},

    { key:'pink-champagne', name:'Розовое шампанское',
      pyramid:[
        {level:'top',    title:'Бергамот'},
        {level:'middle', title:'Дамасская роза, фиалка'},
        {level:'base',   title:'Гвоздика, кедр'}
      ]},

    { key:'antique-library', name:'Антикварная библиотека',
      pyramid:[
        {level:'top',    title:'Ягоды можжевельника'},
        {level:'middle', title:'Пачули, табачный лист, роза'},
        {level:'base',   title:'Сандаловое дерево, кожа'}
      ]},

    { key:'peach-nectar', name:'Персиковый нектар',
      pyramid:[
        {level:'top',    title:'Амаретто, лайм, банан'},
        {level:'middle', title:'Папайя, персик, манго, груша, зеленые листья'},
        {level:'base',   title:'Бобы тонка'}
      ]},

    { key:'grapefruit-mint', name:'Грейпфрут & мята',
      pyramid:[
        {level:'top',    title:'Грейпфрут, ревень, мята'},
        {level:'middle', title:'Лаванда, роза, яблоко'},
        {level:'base',   title:'Ваниль'}
      ]},

    { key:'ciao-cacao', name:'Чао-какао',
      pyramid:[
        {level:'top',    title:'Шоколадный пломбир'},
        {level:'middle', title:'Марципан, маршмэллоу'},
        {level:'base',   title:'Сливки, ваниль, брауни'}
      ]},

    { key:'moss-fern', name:'Мох & папоротник',
      pyramid:[
        {level:'top',    title:'Кипарисовый мох, мята'},
        {level:'middle', title:'Папоротник, бамбук, огурец'},
        {level:'base',   title:'Морская соль, кедр'}
      ]},

    { key:'shaman-spirit', name:'Дух шамана',
      pyramid:[
        {level:'top',    title:'Петитгрейн, озон'},
        {level:'middle', title:'Морская соль, слива, эвкалипт'},
        {level:'base',   title:'Пудра, сандаловое дерево, темный мускус'}
      ]},

    { key:'pink-crystals', name:'Розовые кристаллы',
      pyramid:[
        {level:'top',    title:'Клубника, малина, черная смородина'},
        {level:'middle', title:'Фрезия, сахар'},
        {level:'base',   title:'Светлый мускус, ваниль, бобы тонка'}
      ]},

    { key:'summer-sunsets', name:'Летние закаты',
      pyramid:[
        {level:'top',    title:'Морская соль, апельсиновая корка, трава'},
        {level:'middle', title:'Эвкалипт, шалфей, море'},
        {level:'base',   title:'Пачули, тиковое дерево, мох'}
      ]},

    { key:'caramel-popcorn', name:'Карамельный попкорн',
      pyramid:[
        {level:'top',    title:'Масло, морская соль'},
        {level:'middle', title:'Попкорн, кокос'},
        {level:'base',   title:'Ваниль, карамель'}
      ]},

    { key:'sea-salt-orchid', name:'Морская соль & орхидея',
      pyramid:[
        {level:'top',    title:'Озон, апельсин'},
        {level:'middle', title:'Морская соль, фрезия, зеленые листья'},
        {level:'base',   title:'Бобы тонка, легкий мускус, амбра'}
      ]},

    { key:'egyptian-amber', name:'Египетский янтарь',
      pyramid:[
        {level:'top',    title:'Озон, жасмин'},
        {level:'middle', title:'Кожа, пачули, сандаловое дерево, бобы тонка'},
        {level:'base',   title:'Амбра, темный мускус, светлый мускус, пудра'}
      ]},

    { key:'tobacco-vanilla', name:'Табак & ваниль',
      pyramid:[
        {level:'top',    title:'Цедра лимона'},
        {level:'middle', title:'Табачный лист, кожа, лаванда'},
        {level:'base',   title:'Кора, ваниль, корица, гвоздика'}
      ]},

    { key:'currant-mint', name:'Смородина & мята',
      pyramid:[
        {level:'top',    title:'Озон, лимонная цедра, красная смородина'},
        {level:'middle', title:'Можжевельник, герань'},
        {level:'base',   title:'Мята перечная, черная смородина'}
      ]},

    { key:'snowy-juniper', name:'Заснеженный можжевельник',
      pyramid:[
        {level:'top',    title:'Цитрусы, камфора, озон'},
        {level:'middle', title:'Вишня, красная смородина, сосна, груша'},
        {level:'base',   title:'Шалфей, можжевельник'}
      ]}
  ];

  /* --- НОРМАЛИЗАТОР ДАННЫХ ДЛЯ ПИРАМИДЫ (чтобы ноты показывались всегда) --- */
  const LEVELS_ORDER = ['top','middle','base'];
  const LEVEL_LABELS_RU = {
    top: 'Верхние ноты',
    middle: 'Сердечные ноты',
    base: 'Базовые ноты'
  };
  function normalizePyramid(pyr){
    if (!Array.isArray(pyr)) return [];
    return pyr.slice(0,3).map((raw, i)=>{
      const fallbackLevel = LEVELS_ORDER[i] || 'top';
      if (typeof raw === 'string'){
        return { level: fallbackLevel, title: LEVEL_LABELS_RU[fallbackLevel], notes: raw };
      }
      const level = raw.level || fallbackLevel;
      const hasNotes = typeof raw.notes === 'string' && raw.notes.trim() !== '';
      const notes = hasNotes ? raw.notes : (raw.title || '');
      const title = hasNotes ? (raw.title || LEVEL_LABELS_RU[level]) : LEVEL_LABELS_RU[level];
      return { level, title, notes };
    });
  }

  function findAroma(keyOrName){
    const n = norm(keyOrName);
    let found = aromaList.find(a => a.key === n);
    if (found) return found;
    found = aromaList.find(a => norm(a.name) === n);
    if (found) return found;
    return aromaList.find(a => norm(a.name).includes(n)) || null;
  }

  /* --- РЕНДЕР ПИРАМИДЫ (треугольник + 3 слоя + коннекторы) --- */
  function buildAromaPyramid(keyMaybe, nameMaybe){
    const container = document.getElementById('aromaPyramid');
    if (!container) return;
    const data = findAroma(keyMaybe) || findAroma(nameMaybe) || aromaList[0];
    if (!data) return;

    container.innerHTML = '';

    const triangle = document.createElement('div');
    triangle.className = 'pyramid-triangle';
    triangle.setAttribute('aria-hidden','true');
    container.appendChild(triangle);

    const levels = normalizePyramid(data.pyramid);
    levels.forEach((level, idx)=>{
      const layer = document.createElement('div');
      layer.className = `pyramid-layer ${level.level}`;
      layer.innerHTML = `
        <div class="pyramid-layer-title">${level.title}</div> <div class="pyramid-layer-notes">${level.notes}</div>`;
      container.appendChild(layer);

      if (idx < levels.length - 1){
        const connector = document.createElement('div');
        connector.className = 'pyramid-connector';
        container.appendChild(connector);
      }
    });
  }

  const aromaSelect = document.getElementById('aromaSelect');
  const getSelectedName = () => aromaSelect?.options[aromaSelect.selectedIndex]?.text?.trim();
  const initialKey = aromaSelect?.value;
  const initialName = getSelectedName();
  buildAromaPyramid(initialKey, initialName);

  aromaSelect?.addEventListener('change', function(){
    buildAromaPyramid(this.value, getSelectedName());
  });
  aromaSelect?.addEventListener('input', function(){
    buildAromaPyramid(this.value, getSelectedName());
  });

  /* --- РАЗЖИМАЕМ РОДИТЕЛЕЙ ПИРАМИДЫ, ЧТОБЫ НИЧЕГО НЕ ОБРЕЗАЛОСЬ --- */
  (function relaxAromaPyramidParents(){
    const pyramid = document.getElementById('aromaPyramid');
    if (!pyramid) return;
    let el = pyramid;
    // поднимаемся вверх по дереву (HTML-блок, tn-atom, t396__elem, t396__artboard и т.д.)
    for (let i = 0; i < 5 && el; i++){
      el.style.overflow = 'visible';
      if (el.style.maxHeight && el.style.maxHeight !== 'none') {
        el.style.maxHeight = 'none';
      }
      if (el.style.height && el.style.height !== 'auto') {
        el.style.height = 'auto';
      }
      el = el.parentElement;
    }
  })();

}); // DOMContentLoaded конец

/* ======================== 11.1: TOASTS (мини-уведомления) ======================== */
(function(){
  if (window.__hs_toasts_bound) return;
  window.__hs_toasts_bound = true;

  // CSS тостов
  if (!document.getElementById('hsToastStylesInline')) {
    const st = document.createElement('style');
    st.id = 'hsToastStylesInline';
    st.textContent = `
      .hs-toast-global{
        position:fixed;
        left:50%;
        bottom:calc(env(safe-area-inset-bottom,0px) + 24px);
        transform:translate(-50%,12px);
        background:#fff;
        color:var(--toast-color,#816856);
        border:1px solid rgba(0,0,0,.08);
        border-radius:14px;
        padding:12px 14px;
        display:flex;
        align-items:center; gap:10px;
        box-shadow:0 18px 48px rgba(0,0,0,.12), 0 6px 18px rgba(0,0,0,.06);
        opacity:0; pointer-events:none;
        transition:opacity .25s ease, transform .25s ease;
        z-index:3000;
        min-width:220px; max-width:min(92vw,420px);
      }
      .hs-toast-global.show{ opacity:1; transform:translate(-50%,0); }
      .hs-toast-icon{ width:22px; height:22px; display:grid; place-items:center; flex:0 0 22px; }
      .hs-toast-icon svg{ width:20px; height:20px; display:block; }
      .hs-toast-icon .fill{ fill:currentColor; opacity:.18; }
      .hs-toast-text{ font:15px/1.35 'Gotham Book','Helvetica Neue',Arial,sans-serif; color:#241d1a; }
      @media (max-width:420px){ .hs-toast-text{ font-size:14px; } }
      @media (prefers-reduced-motion: reduce){ .hs-toast-global{ transition:none; } }
    `;
    document.head.appendChild(st);
  }

  function ensureToast(){
    let el = document.getElementById('hsToastGlobal');
    if (!el) {
      el = document.createElement('div');
      el.className = 'hs-toast-global';
      el.id = 'hsToastGlobal';
      el.setAttribute('role','status');
      el.setAttribute('aria-live','polite');
      el.setAttribute('aria-atomic','true');
      el.innerHTML = '<span class="hs-toast-icon" aria-hidden="true"></span><div class="hs-toast-text">Готово</div>';
      document.body.appendChild(el);
    }
    return el;
  }

  if (typeof window.showToastHS !== 'function') {
    let hideTmr = null;
    window.showToastHS = function(message, type){
      const icon = (t)=>{
        if(t==='fav'){
          return '<svg viewBox="0 0 24 24"><path class="fill" d="M12 21s-6.7-4.24-9.14-7.5C.2 11.36 1.2 7.9 4.1 6.66 6.3 5.7 8.7 6.3 10 8a4.6 4.6 0 0 1 4 0c1.3-1.7 3.7-2.3 5.9-1.34 2.9 1.24 3.9 4.7 1.24 6.84C18.7 16.76 12 21 12 21z"/><path d="M12 20.2S5.7 16.3 3.1 13.1c-2.1-2.5-1.2-6.3 1.9-7.6 2.1-.9 4.6-.3 6 1.5a.75.75 0 0 0 1 0c1.4-1.8 3.9-2.4 6-1.5 3.1 1.3 4 5.1 1.9 7.6-2.6 3.2-8.9 7.1-8.9 7.1z" fill="none" stroke="currentColor" stroke-width="1.6" stroke-linecap="round" stroke-linejoin="round"/></svg>';
        }
        if(t==='cart'){
          return '<svg viewBox="0 0 24 24"><path class="fill" d="M4 8h16l-1.4 11.2A2 2 0 0 1 16.62 21H7.38a2 2 0 0 1-1.98-1.8L4 8z"/><path d="M8 8V7a4 4 0 0 1 8 0v1M4 8h16l-1.4 11.2A2 2 0 0 1 16.62 21H7.38a2 2 0 0 1-1.98-1.8L4 8z" fill="none" stroke="currentColor" stroke-width="1.6" stroke-linecap="round" stroke-linejoin="round"/></svg>';
        }
        return '<svg viewBox="0 0 24 24"><circle class="fill" cx="12" cy="12" r="10"/><path d="M7 12.5l3.2 3.2L17 9" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round"/></svg>';
      };
      const colors = { fav:'#e63946', cart:'#816856', remove:'#7a6d66', info:'#816856' };
      const el = ensureToast();
      el.style.setProperty('--toast-color', colors[type] || colors.info);
      el.querySelector('.hs-toast-icon').innerHTML = icon(type);
      el.querySelector('.hs-toast-text').textContent = message || 'Готово';
      el.classList.add('show');
      clearTimeout(hideTmr);
      hideTmr = setTimeout(()=> el.classList.remove('show'), 1800);
    };
  }

  // Toast для избранного
  document.addEventListener('click', function(e){
    const fav = e.target.closest('.favorite-btn');
    if (!fav) return;
    setTimeout(()=>{
      const isActive = fav.classList.contains('active');
      window.showToastHS(isActive ? 'Добавлено в избранное' : 'Удалено из избранного', isActive ? 'fav' : 'remove');
    }, 0);
  }, true);

  // Toast для корзины
  document.addEventListener('click', function(e){
    const cartBtn = e.target.closest('.add-to-cart, #modalAddToCart');
    if (!cartBtn) return;
    setTimeout(()=> window.showToastHS('Товар добавлен в корзину', 'cart'), 0);
  }, true);
})();

/* ======================== 11.2: FEEDBACK «ДОБАВЛЕНО!» ======================== */
(function(){
  if (window.__hs_btn_feedback_bound) return;
  window.__hs_btn_feedback_bound = true;

  if (!document.getElementById('hsBtnFeedbackStylesInline')) {
    const st = document.createElement('style');
    st.id = 'hsBtnFeedbackStylesInline';
    st.textContent = `
      .btn-busy { pointer-events: none; opacity: .92; }
      @media (prefers-reduced-motion: reduce){ .btn-busy { transition: none !important; } }
    `;
    document.head.appendChild(st);
  }

  const DURATION = 1200; // мс

  function setAddedState(btn){
    if (!btn || btn.dataset.busy === '1') return;
    const current = (btn.textContent || '').trim();
    if (!btn.dataset.originalText) {
      btn.dataset.originalText = current.toLowerCase().includes('добавлено') ? 'в корзину' : current;
    }
    const w = btn.offsetWidth;
    btn.style.width = w + 'px';
    btn.dataset.busy = '1';
    btn.classList.add('btn-busy');
    if (!current.toLowerCase().includes('добавлено')) {
      btn.textContent = 'Добавлено!';
    }
    setTimeout(() => {
      btn.textContent = btn.dataset.originalText || 'в корзину';
      btn.classList.remove('btn-busy');
      btn.style.width = '';
      btn.dataset.busy = '0';
    }, DURATION);
  }

  document.addEventListener('click', function(e){
    const btn = e.target.closest('.add-to-cart, #modalAddToCart');
    if (!btn) return;
    setTimeout(() => setAddedState(btn), 0);
  }, true);

  if (typeof window.addToCart === 'function' && !window.addToCart.__hs_feedback_patch){
    const orig = window.addToCart;
    window.addToCart = function(){
      const ret = orig.apply(this, arguments);
      const active = document.activeElement && (document.activeElement.matches('.add-to-cart, #modalAddToCart') ? document.activeElement : null);
      const modalBtn = document.getElementById('modalAddToCart');
      setTimeout(() => setAddedState(active || modalBtn || document.querySelector('.add-to-cart')), 0);
      return ret;
    };
    window.addToCart.__hs_feedback_patch = true;
  }
})();
</script> <style id="hsFaqBtnMatchModalText">
  /* Кнопки инструкции в модалке наследуют цвет шрифта модалки */
  .hs-faq-btn,
  .hs-faq-btn:visited{
    color: inherit !important;
  }
  .hs-faq-btn span{
    color: inherit !important;
  }
</style> <style id="hsFaqBtnSpacingTweak">
  /* Чуть уменьшили отступ кнопки от текста и между кнопками */
  .hs-faq-btn-wrap{ margin-top:20px !important; }
  .hs-faq-btn-wrap + .hs-faq-btn-wrap{ margin-top:15px !important; }
</style> <style id="hsProductModalTypography">
  /* Выделяем название товара и цену в модалке, убираем перечёркнутую цену */
  #productModal #modalTitle{
    font-size: 20px;      /* десктоп */
    line-height: 1.3;
    font-weight: 600;
  }
  #productModal #modalPrice{
    font-size: 18px;      /* десктоп */
    line-height: 1.3;
    font-weight: 600;
    color: #5a4a42;
  }
  #productModal #modalPrice .price-old{
    display: none !important; /* перечёркнутую цену в модалке скрываем */
  }
</style> <style id="hsProductModalCompact">
  /* Более компактные отступы внутри модалки товара */
  #productModal #modalGallery{
    margin-bottom: 14px;
  }

  #productModal #modalTitle{
    margin-bottom: 6px;
  }

  #productModal #modalPrice{
    margin-bottom: 10px;
  }

  #productModal #modalDescription{
    margin-top: 6px;
    margin-bottom: 10px;
  }

  #productModal #modalVariants{
    margin-top: 6px;
    margin-bottom: 12px;
  }

  #productModal #modalAddToCart{
    margin-top: 10px;
  }

  /* Чуть сушим всё это на мобилке */
  @media (max-width: 600px){
    /* если модалка сидит внутри t-popup */
    #productModal .t-popup__container,
    #productModal .modal-content{
      padding: 16px 16px 18px !important;
    }

    #productModal #modalTitle{
      font-size: 18px;   /* мобилка, чуть меньше */
      line-height: 1.25;
    }

    #productModal #modalPrice{
      font-size: 16px;   /* мобилка, чуть меньше */
      line-height: 1.25;
    }

    #productModal #modalDescription{
      font-size: 13px;
      line-height: 1.45;
    }

    #productModal #modalAddToCart{
      margin-top: 8px;
    }

    #productModal .hs-faq-btn-wrap{
      margin-top: 12px !important;
    }
    #productModal .hs-faq-btn-wrap + .hs-faq-btn-wrap{
      margin-top: 8px !important;
    }
  }
</style> <style id="hsModalAromaNoteStyles">
  /* Плашка с описанием аромата и плашка "Состав" в модалке */
  #productModal #modalAromaNote{
    margin-top: 10px;
    padding: 10px 12px;
    border-radius: 12px;
    background: #f7f5f2;
    border: 1px solid #e8ded4;
    font-size: 13px;
    line-height: 1.5;
    color: #3b332f;
  }
  #productModal #modalAromaNote .modal-aroma-note-title{
    font-weight: 600;
    margin-bottom: 4px;
  }
  #productModal #modalAromaNote .modal-aroma-note-text{
    font-size: 13px;
  }

  /* Новая плашка "Состав" над описанием аромата */
  #productModal .modal-composition-box{
    margin-top: 8px;
    padding: 10px 12px;
    border-radius: 12px;
    background: #f7f5f2;
    border: 1px solid #e8ded4;
    font-size: 13px;
    line-height: 1.5;
    color: #3b332f;
  }
  #productModal .modal-composition-title{
    font-weight: 600;
    margin-bottom: 4px;
  }
  #productModal .modal-composition-text{
    font-size: 13px;
  }

  @media (max-width: 600px){
    #productModal #modalAromaNote{
      margin-top: 8px;
      padding: 9px 10px;
      font-size: 12.5px;
    }
    #productModal .modal-composition-box{
      margin-top: 6px;
      padding: 9px 10px;
      font-size: 12.5px;
    }
  }
</style> <style id="hsProductModalParagraphSpacing">
  /* Более плотные абзацы в описании/составе товаров в модалке */
  #productModal #modalDescription,
  #productModal #modalAromaNote,
  #productModal .modal-composition-box{
    line-height: 1.35;
  }

  #productModal #modalDescription p,
  #productModal #modalAromaNote p,
  #productModal .modal-composition-box p{
    margin-top: 0;
    margin-bottom: 6px;
  }

  #productModal #modalDescription p:last-child,
  #productModal #modalAromaNote p:last-child,
  #productModal .modal-composition-box p:last-child{
    margin-bottom: 0;
  }
</style> <!-- nominify end --> </div> </div> </div> </div> <div id="rec1317712901" class="r t-rec" style=" " data-animationappear="off" data-record-type="131"> <!-- T123 --> <div class="t123"> <div class="t-container_100 "> <div class="t-width t-width_100 "> <!-- nominify begin --> <!-- T123 — Add to ST100 WITHOUT auto popup (universal) --> <script>
(function(){
  const qs  = (sel, root=document) => root.querySelector(sel);
  const qsa = (sel, root=document) => Array.prototype.slice.call(root.querySelectorAll(sel));

  const normalizePrice = (v) => {
    if (typeof v === 'number' && isFinite(v)) return Math.max(0, Math.round(v*100)/100);
    if (v === 0 || v === '0') return 0;
    if (!v) return 0;
    const s = String(v).replace(/\u00A0/g,' ').replace(/\s/g,'').replace(',', '.').replace(/[^\d.\-]/g,'');
    let n = parseFloat(s);
    if (!isFinite(n) || isNaN(n)) n = 0;
    return n < 0 ? 0 : Math.round(n*100)/100;
  };

  const toAbs = (url) => {
    if (!url) return '';
    if (/^https?:\/\//i.test(url)) return url;
    if (url.startsWith('//')) return location.protocol + url;
    if (url.startsWith('/'))  return location.origin + url;
    return location.origin + '/' + url.replace(/^\.?\//,'');
  };

  const getBgUrl = (el) => {
    const m = getComputedStyle(el).backgroundImage.match(/url\(["']?(.+?)["']?\)/i);
    return m ? m[1] : '';
  };

  function isPopupVisible(){ return !!document.querySelector('.t706__cartwin.t706__cartwin_showed, .t706__cartwin_showed'); }
  function closePopupIfOpen(){
    try {
      if (!isPopupVisible()) return;
      if (typeof window.tcart__closePopup === 'function'){ window.tcart__closePopup(); return; }
      const closeBtn = document.querySelector('.t706__cartwin-close, .t706__close');
      if (closeBtn) closeBtn.click();
    } catch(e){}
  }
  function suppressAutoPopupOnce(durationMs=450){
    const t0 = Date.now();
    let rafId = requestAnimationFrame(function tick(){
      if (Date.now() - t0 <= durationMs){
        if (isPopupVisible()) closePopupIfOpen();
        rafId = requestAnimationFrame(tick);
      }
    });
    const mo = new MutationObserver(() => {
      if (isPopupVisible()) closePopupIfOpen();
      if (Date.now() - t0 > durationMs) { mo.disconnect(); cancelAnimationFrame(rafId); }
    });
    mo.observe(document.documentElement, { childList:true, subtree:true, attributes:true, attributeFilter:['class'] });
    setTimeout(() => { mo.disconnect(); cancelAnimationFrame(rafId); }, durationMs+50);
  }

  function waitST100Ready(timeoutMs=1500){
    return new Promise((resolve, reject) => {
      const t0 = Date.now();
      (function tick(){
        if (typeof window.tcart__addProduct === 'function') return resolve();
        if (Date.now() - t0 > timeoutMs) return reject(new Error('ST100 API не готов'));
        requestAnimationFrame(tick);
      })();
    });
  }

  const isAroma  = (label,val='') => /аромат|fragrance|scent/i.test(label);
  const isWick   = (label,val='') => /фитил|fitil|wick|хлопк|дерев/i.test(label) || /фитил|wick|cotton|wood|хлопк|дерев/i.test(val);
  const isVolume = (label,val='') => /объе?м|volume|ml|мл/i.test(label) || /^\s*\d+(?:[.,]\d+)?\s*(ml|мл)?\s*$/i.test(val);
  const toMl     = (val) => { const m = String(val||'').match(/(\d+(?:[.,]\d+)?)/); return m ? m[1].replace(',', '.') + ' мл' : (val||''); };
  const cleanWick= (v) => String(v||'').replace(/\s*\([^)]*\)\s*$/,'').replace(/\s*(?:№|#)?\d+(?:[.,]\d+)?\s*(?:мм|mm|шт|pcs)?\s*$/i,'').trim();

  function parseCard(btn){
    const card  = btn.closest('.product-card') || btn.closest('[data-product-card]') || document;
    const title = (qs('.product-title', card)?.textContent || btn.getAttribute('data-title') || 'Товар').trim();

    const selects = qsa('.variant-select, select[data-title], select[name*="variant"], select[data-attr]', card);
    const sel1 = selects[0] || null; // Аромат
    const sel2 = selects[1] || null; // Фитиль/Объём (+ цена)

    const aroma = sel1 ? (sel1.options[sel1.selectedIndex]?.textContent?.trim() || sel1.value || '') :
                         (btn.getAttribute('data-aroma') || '');

    let wick = '', volume = '', price = 0;

    if (sel2) {
      const label2 = sel2.getAttribute('data-title') || sel2.getAttribute('aria-label') || sel2.name || '';
      const opt2   = sel2.options[sel2.selectedIndex];
      const raw2   = (opt2?.textContent || opt2?.value || '').trim();

      if (isWick(label2, raw2))   wick   = cleanWick(raw2);
      else if (isVolume(label2, raw2)) volume = toMl(raw2);

      price = normalizePrice(opt2?.getAttribute('data-price') || 0);
    }

    if (!price) {
      price = normalizePrice(
        btn.getAttribute('data-price') ||
        qs('.product-price, .js-product-price', card)?.textContent || 0
      );
    }

    // Картинка
    let imgEl = qs('.gallery-images img.is-active, .gallery-images img[data-active="true"]', card)
             || qs('.gallery-images img, .product-image img, img', card);
    let imgSrc = imgEl ? (imgEl.currentSrc || imgEl.src || imgEl.getAttribute('src') || imgEl.dataset?.original || imgEl.dataset?.src || '') : '';
    if (!imgSrc){
      const bg = qs('.product-image, [class*="bgimg"], .bg', card);
      if (bg) imgSrc = getBgUrl(bg);
    }

    // SKU: берём только «человеческий», НЕ числовой id
    const skuRaw = qs('[data-product-sku]', card)?.textContent?.trim()
                || card.getAttribute('data-sku')
                || btn.getAttribute('data-sku')
                || '';
    const sku = /^\s*\d+\s*$/.test(skuRaw) ? '' : skuRaw; // если только цифры — не отправляем

    return { title, aroma, wick, volume, price, img: toAbs(imgSrc), sku };
  }

  function addOneToST100(product){
    if (typeof window.tcart__addProduct !== 'function') return;

    const options = [];
    if (product.aroma)  options.push({ option: 'Аромат',  variant: product.aroma,       price: 0 });
    if (product.wick)   options.push({ option: 'Фитиль', variant: product.wick,        price: 0 });
    else if (product.volume) options.push({ option: 'Объём',   variant: product.volume, price: 0 });

    const payload = {
      name: product.title,
      price: product.price,
      amount: 1,
      quantity: 1,
      img: product.img || '',
      options
      // sku умышленно НЕ отправляем, чтобы в корзине не выводилась лишняя цифра
    };

    window.tcart__addProduct(payload);
  }

  document.addEventListener('click', async function(e){
    const btn = e.target.closest('.add-to-cart, [data-add-to-cart], .js-add-to-cart, a[href^="#order"]');
    if (!btn) return;

    e.preventDefault();
    e.stopPropagation();

    const data = parseCard(btn);
    if (!data.price) { console.warn('[ST100] Нет цены — товар не добавлён'); return; }

    suppressAutoPopupOnce(450);

    try {
      await waitST100Ready(1500);
      addOneToST100(data);
    } catch(err){
      console.warn('[ST100] Не удалось добавить:', err && err.message);
    }
  }, true);
})();
</script> <!-- nominify end --> </div> </div> </div> </div> <div id="rec1317715031" class="r t-rec" style=" " data-animationappear="off" data-record-type="131"> <!-- T123 --> <div class="t123"> <div class="t-container_100 "> <div class="t-width t-width_100 "> <!-- nominify begin --> <!-- T123 — Hide native Tilda cart icon but keep ST100 working --> <style>
  /* Скрываем все версии иконки корзины Тильды (старые/новые классы) */
  .t706__carticon,
  .t706__carticon_showed,
  .t706__carticon-counter,
  .t-store__carticon,
  .t-store__carticon-counter,
  .t-menucart,
  .t-menucart__link,
  .t-menucart__counter,
  a[href="#order"].t-menucart__link {
    display: none !important;
    opacity: 0 !important;
    visibility: hidden !important;
    pointer-events: none !important;
  }
</style> <script>
(function(){
  /* На некоторых темах Тильда может добавить иконку позже — подстрахуемся */
  var SELECTORS = [
    '.t706__carticon',
    '.t706__carticon_showed',
    '.t706__carticon-counter',
    '.t-store__carticon',
    '.t-store__carticon-counter',
    '.t-menucart',
    '.t-menucart__link',
    '.t-menucart__counter',
    'a[href="#order"].t-menucart__link'
  ];

  function hideIcons(){
    document.querySelectorAll(SELECTORS.join(',')).forEach(function(el){
      // доп.маскировка, если где-то переопределят display
      el.style.opacity = '0';
      el.style.pointerEvents = 'none';
      el.style.width = '0';
      el.style.height = '0';
      el.style.overflow = 'hidden';
      el.style.position = 'fixed';
      el.style.zIndex = '-1';
    });
  }

  if (document.readyState !== 'loading') hideIcons();
  else document.addEventListener('DOMContentLoaded', hideIcons);

  // Если Тильда перерисует DOM — скрываем повторно
  try {
    var mo = new MutationObserver(function(){ hideIcons(); });
    mo.observe(document.documentElement, { childList: true, subtree: true });
  } catch(e){}
})();
</script> <!-- nominify end --> </div> </div> </div> </div> <div id="rec1317715891" class="r t-rec" style=" " data-animationappear="off" data-record-type="131"> <!-- T123 --> <div class="t123"> <div class="t-container_100 "> <div class="t-width t-width_100 "> <!-- nominify begin --> <!-- T123 — Header cart badge synced with ST100 --> <style>
  /* Если на контейнер иконки ещё не стоит позиционирование — добавим.
     (Если у вас уже есть свой стиль, можно убрать этот блок) */
  .hs-header-cart,
  #headerCart,
  .cart-icon-container {
    position: relative;
    display: inline-flex;
    align-items: center;
  }

  /* Бейдж (если его нет — скрипт создаст .icon-badge) */
  .icon-badge {
    position: absolute;
    right: -6px;
    top: -6px;
    min-width: 16px;
    height: 16px;
    padding: 0 4px;
    border-radius: 10px;
    background: #111;
    color: #fff;
    font: 600 10px/16px system-ui, -apple-system, Segoe UI, Roboto, sans-serif;
    text-align: center;
    white-space: nowrap;
    transform: translateZ(0); /* crisper text */
  }
</style> <script>
(function(){
  // Где искать контейнер вашей иконки (берите первый подходящий).
  // РЕКОМЕНДАЦИЯ: повесьте на ваш контейнер класс .hs-header-cart.
  var TARGET_SELECTORS = [
    '.hs-header-cart',       // ← поставьте этот класс на вашу иконку — самый надёжный вариант
    '#headerCart',
    '.cart-icon-container',
    '.header .cart-icon',
    '.nav-icons .cart-icon',
    '.menu-cart',
    '.header-cart'
  ];

  function $(sel, root){ return (root||document).querySelector(sel); }

  function findHeaderIcon(){
    for (var i=0;i<TARGET_SELECTORS.length;i++){
      var el = $(TARGET_SELECTORS[i]);
      if (el) return el;
    }
    return null;
  }

  // Чтение количества из ST100 / tcart / вашего fallback-хранилища
  function readCount(){
    try{
      // 1) Живой объект ST100
      if (window.tcart && Array.isArray(window.tcart.products)) {
        var sum = 0, arr = window.tcart.products;
        for (var i=0;i<arr.length;i++){
          var q = parseInt(arr[i].quantity, 10);
          sum += (Number.isFinite(q) && q > 0) ? q : 1;
        }
        return Math.max(sum, 0);
      }
      // 2) Локальный кеш ST100
      var raw = localStorage.getItem('tcart');
      if (raw) {
        var obj = JSON.parse(raw);
        if (obj && Array.isArray(obj.products)) {
          var sum2 = 0, p = obj.products;
          for (var j=0;j<p.length;j++){
            var q2 = parseInt(p[j].quantity, 10);
            sum2 += (Number.isFinite(q2) && q2 > 0) ? q2 : 1;
          }
          return Math.max(sum2, 0);
        }
      }
      // 3) Ваше кастомное хранилище (если использовали ранее)
      var rawHs = localStorage.getItem('cart');
      if (rawHs) {
        var hs = JSON.parse(rawHs);
        if (Array.isArray(hs)) {
          return hs.reduce(function(sum,x){
            var q3 = parseInt(x.qty || 1, 10);
            return sum + (Number.isFinite(q3) && q3 > 0 ? q3 : 1);
          }, 0);
        }
      }
    }catch(e){}
    return 0;
  }

  function ensureBadge(container){
    var b = container.querySelector('.icon-badge');
    if (!b){
      b = document.createElement('span');
      b.className = 'icon-badge';
      b.textContent = '0';
      container.appendChild(b);
    }
    return b;
  }

  // Небольшой дебаунс, чтобы не дёргать DOM слишком часто
  function debounce(fn, ms){
    var t; return function(){ var a=arguments, ctx=this; clearTimeout(t); t=setTimeout(function(){ fn.apply(ctx,a); }, ms||80); };
  }

  function updateBadge(container){
    if (!container) return;
    var badge = ensureBadge(container);
    var n = readCount();
    badge.textContent = String(n);
  }
  var updateBadgeDebounced = debounce(updateBadge, 80);

  // Патчим tcart__addProduct, чтобы обновлять бейдж сразу после добавления
  function patchAddProduct(){
    if (typeof window.tcart__addProduct === 'function' && !window.tcart__addProduct.__hsPatched) {
      var orig = window.tcart__addProduct;
      window.tcart__addProduct = function(){
        var res = orig.apply(this, arguments);
        requestAnimationFrame(function(){ updateBadgeDebounced(containerRef); });
        return res;
      };
      window.tcart__addProduct.__hsPatched = true;
    }
  }

  // Ждём готовность ST100, чтобы повесить патч (но бейдж работает и без этого)
  function waitST100(timeoutMs){
    timeoutMs = timeoutMs || 3000;
    return new Promise(function(resolve, reject){
      var t0 = Date.now();
      (function tick(){
        var ready = (typeof window.tcart__addProduct === 'function') || window.tcart || document.querySelector('.t706__carticon');
        if (ready) return resolve();
        if (Date.now() - t0 > timeoutMs) return reject();
        requestAnimationFrame(tick);
      })();
    });
  }

  var containerRef = null;

  function init(){
    containerRef = findHeaderIcon();
    if (!containerRef) {
      // ждём появления шапки
      var mo = new MutationObserver(function(){
        containerRef = findHeaderIcon();
        if (containerRef) { mo.disconnect(); run(); }
      });
      mo.observe(document.documentElement, { childList:true, subtree:true });
    } else {
      run();
    }
  }

  function run(){
    // 1) Первый рендер
    updateBadge(containerRef);

    // 2) Обновляться при:
    //   a) изменении localStorage от ST100 или вашего кода
    window.addEventListener('storage', function(ev){
      if (ev.key === 'tcart' || ev.key === 'cart') updateBadgeDebounced(containerRef);
    });

    //   b) открытии/закрытии или перерисовке поп-апа ST100
    var moPopup = new MutationObserver(function(){ updateBadgeDebounced(containerRef); });
    moPopup.observe(document.documentElement, { childList:true, subtree:true });

    //   c) ваших собственных событий (если они есть)
    window.addEventListener('hs:cart:changed', function(){ updateBadgeDebounced(containerRef); });

    //   d) лёгкий «страховочный» интервал
    var iv = setInterval(function(){
      if (!document.body.contains(containerRef)) { clearInterval(iv); return; }
      updateBadgeDebounced(containerRef);
    }, 1200);

    // 3) Как только ST100 будет готов — пропатчим addProduct
    waitST100(4000).then(function(){ patchAddProduct(); }).catch(function(){ /* не критично */ });

    // 4) Экспорт ручного апдейта (если вдруг пригодится)
    window.hsUpdateCartBadge = function(){ updateBadge(containerRef); };
  }

  (document.readyState !== 'loading') ? init() : document.addEventListener('DOMContentLoaded', init);
})();
</script> <!-- T123 — Badge: red circle + white digits --> <style>
/* Подхватывает ваш контейнер иконки корзины в шапке */
.hs-header-cart .icon-badge,
#headerCart .icon-badge,
.cart-icon-container .icon-badge {
  background: #e60000 !important; /* КРУЖОК — красный */
  color: #ffffff !important;       /* ЦИФРЫ — белые */
  border: none !important;         /* без обводки */
  /* тонкая полировка (необязательно): */
  box-shadow: 0 0 0 1px rgba(230,0,0,.25);
}
</style> <!-- T123 — Favorite badge: red circle + white digits --> <style>
/* Бейдж на сердечке избранного */
.hs-header-fav .icon-badge,
#headerFavorite .icon-badge,
.favorite-icon .icon-badge {
  background: #e60000 !important; /* кружок — красный */
  color: #ffffff !important;       /* цифры — белые */
  border: none !important;
  box-shadow: 0 0 0 1px rgba(230,0,0,.25);
}

/* На всякий случай — позиционирование контейнера избранного */
.hs-header-fav,
#headerFavorite,
.favorite-icon {
  position: relative;
  display: inline-flex;
  align-items: center;
}
</style> <!-- nominify end --> </div> </div> </div> </div> <div id="rec1317716811" class="r t-rec" style=" " data-animationappear="off" data-record-type="131"> <!-- T123 --> <div class="t123"> <div class="t-container_100 "> <div class="t-width t-width_100 "> <!-- nominify begin --> <!-- ===== HIDE ONLY SIDE "ADDED TO CART" NOTICES (keep center) ===== --> <style>
  /* Ничего не скрываем глобально — только усилим z-index своих центральных */
  .hs-center-toast,
  .hs-modal-10 .toast{ z-index: 10050; }
</style> <script>
(function(){
  if (window.HS_HIDE_SIDE_ADDED_APPLIED) return;
  window.HS_HIDE_SIDE_ADDED_APPLIED = true;

  // Селекторы типичных тильдовских «added» элементов, НО только "боковых" версий
  // (cartwin = всплывашка у правого края / около корзины)
  const SIDE_ONLY_SELECTORS = [
    '.t706__cartwin-productadded',
    '.t706__cartwin_prodadded',
    '.t-store__cartwin__prodadded',
    '.t-store__prod-added__wrap_right',
    '.t-store__addedtocart_right',
  ].join(',');

  // Вайтлист: наши центральные уведомления — не трогаем
  const WHITELIST = ['.hs-center-toast', '.hs-modal-10 .toast'];

  function isWhitelisted(el){
    return WHITELIST.some(sel => el.closest(sel));
  }

  function isSidePosition(el){
    try{
      const r = el.getBoundingClientRect();
      const cx = r.left + r.width/2;
      // «боковое» — правее 65% ширины вьюпорта
      return cx > window.innerWidth * 0.65;
    }catch(_){ return false; }
  }

  function hideSide(el){
    el.style.setProperty('display','none','important');
    el.style.setProperty('visibility','hidden','important');
    el.style.setProperty('opacity','0','important');
  }

  function maybeHide(el){
    if (!(el instanceof Element)) return;
    if (isWhitelisted(el)) return;

    // 1) Явно боковые классы — скрываем
    if (el.matches && el.matches(SIDE_ONLY_SELECTORS)) {
      hideSide(el); return;
    }

    // 2) Эвристика по тексту + положению (правый край)
    const txt = (el.textContent || '').toLowerCase();
    if (/(добавлен|добавлено|added to cart)/.test(txt) && isSidePosition(el)){
      hideSide(el); return;
    }
  }

  // Начальный проход
  document.querySelectorAll(SIDE_ONLY_SELECTORS).forEach(hideSide);

  // Отслеживаем новые уведомления
  const mo = new MutationObserver(muts=>{
    for (const m of muts){
      m.addedNodes && m.addedNodes.forEach(node=>{
        if (node instanceof Element) {
          maybeHide(node);
          // на случай вложенной в элемент структуры
          node.querySelectorAll && node.querySelectorAll('*').forEach(maybeHide);
        }
      });
    }
  });
  mo.observe(document.body, { childList:true, subtree:true });

  // Подстраховка: если Tilda вызывает свою функцию показа — перехватим и приглушим только «боковые» варианты
  ['tcart__showAddedProduct','tcart__productAdded_show'].forEach(fnName=>{
    const orig = window[fnName];
    if (typeof orig !== 'function') return;
    window[fnName] = function(){
      try{
        const res = orig.apply(this, arguments);
        // после показа пройдёмся и скроем боковое
        setTimeout(()=> {
          document.querySelectorAll(SIDE_ONLY_SELECTORS).forEach(hideSide);
        }, 0);
        return res;
      }catch(e){
        return orig.apply(this, arguments);
      }
    };
  });
})();
</script> <!-- ===== /HIDE ONLY SIDE "ADDED TO CART" NOTICES ===== --> <!-- nominify end --> </div> </div> </div> </div> </header> <!--/header--> <div id="rec1223333771" class="r t-rec" style=" " data-animationappear="off" data-record-type="131"> <!-- T123 --> <div class="t123"> <div class="t-container_100 "> <div class="t-width t-width_100 "> <!-- nominify begin --> <!-- BLOCK 3: Hero Carousel — большие горизонтальные фото (без точек) --> <div class="carousel-container" id="hero-carousel" role="region" aria-label="Галерея: продукты и материалы"> <style>
    /* === СКОУП ТОЛЬКО ДЛЯ ЭТОГО БЛОКА (#hero-carousel) === */
    #hero-carousel{
      --slide-h: 560px;           /* единая высота фото на всех экранах */
      --radius: 16px;
      --shadow: 0 10px 26px rgba(0,0,0,.06);
      --bg: #f7f5f2;
      --card-bg:#fff;
      --line: rgba(0,0,0,.08);
      --text: #3b332f;
      --muted:#7a6d66;
      --accent:#816856;
    }
    #hero-carousel .viewport{
      position: relative;
      overflow: hidden;
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      background: var(--bg);
    }
    #hero-carousel .carousel{
      display: flex;
      transition: transform .45s ease;
      will-change: transform;
    }
    #hero-carousel .carousel-slide{
      flex: 0 0 100%;
      box-sizing: border-box;
      padding: 0;
    }
    #hero-carousel .slide-content{
      max-width: 1160px;
      margin: 0 auto;
      padding: 0;
      display: grid;
      gap: 14px;
      justify-items: center;
    }
    /* Фото: горизонтальное, целиком */
    #hero-carousel .slide-content img{
      height: var(--slide-h);
      width: 100%;
      object-fit: contain;        /* без обрезки */
      background: var(--bg);      /* подложка под «поля» */
      border-radius: var(--radius);
      display: block;
      user-select: none;
      -webkit-user-drag: none;
    }
    /* Подписи */
    #hero-carousel .slide-info{
      width: min(100%, 980px);
      background: var(--card-bg);
      border: 1px solid var(--line);
      border-radius: calc(var(--radius) - 2px);
      padding: 16px 18px;
      color: var(--text);
      line-height: 1.6;
    }
    #hero-carousel .slide-info h3{
      margin: 0 0 6px;
      font-weight: 600;
      font-size: 20px;
      letter-spacing: .2px;
    }
    #hero-carousel .slide-info p{
      margin: 0 0 8px;
      font-size: 15px;
      color: var(--text);
    }

    /* MOBILE/TABLET: уменьшенный текст на плашке, только до 1024px */
    @media (max-width: 1024px){
      #hero-carousel .slide-info{
        padding: 12px 14px;
        line-height: 1.5;
      }
      #hero-carousel .slide-info h3{
        font-size: 17px;
        margin-bottom: 4px;
      }
      #hero-carousel .slide-info p{
        font-size: 13px;
        margin-bottom: 6px;
      }
    }

    /* Кнопки навигации — работают и на мобильном */
    #hero-carousel .carousel-button{
      position: absolute;
      top: calc(var(--slide-h)/2);
      transform: translateY(-50%);
      width: 44px; height: 44px;
      border-radius: 999px;
      border: 0;
      background: rgba(0,0,0,.42);
      color: #fff;
      display: grid; place-items: center;
      cursor: pointer;
      transition: background .2s ease, transform .2s ease;
      z-index: 2;
    }
    #hero-carousel .carousel-button:hover{ background: rgba(0,0,0,.58); }
    #hero-carousel .carousel-button:active{ transform: translateY(-50%) scale(.96); }
    #hero-carousel .carousel-button.prev{ left: 10px; }
    #hero-carousel .carousel-button.next{ right: 10px; }
  </style> <div class="viewport"> <div class="carousel" id="carousel"> <!-- 1. Ароматические свечи --> <div class="carousel-slide" aria-roledescription="slide" aria-label="1 из 5"> <div class="slide-content"> <img
            src="https://static.tildacdn.com/tild3562-3236-4165-b466-626165353762/A7208378-Edit__1.jpg"
            alt="Ароматические свечи — ручная работа"
            loading="eager" fetchpriority="high" decoding="async" draggable="false"> <div class="slide-info"> <h3>Ароматические свечи</h3> <p>Ручная работа с использованием ароматов премиального качества и натурального соевого воска. Горят ровно и долго, наполняя пространство уютом.</p> <p>Наши свечи создают атмосферу тепла и гармонии. Идеальное дополнение к любому интерьеру, благодаря стильному и минималистичному дизайну.</p> </div> </div> </div> <!-- 2. Твердые духи --> <div class="carousel-slide" aria-roledescription="slide" aria-label="2 из 5"> <div class="slide-content"> <img
            src="https://static.tildacdn.com/tild6434-6331-4939-b061-376239656336/IMG_7330.jpg"
            alt="Твердые духи"
            loading="lazy" fetchpriority="low" decoding="async" draggable="false"> <div class="slide-info"> <h3>Твердые духи</h3> <p>Компактные и элегантные духи в твердой форме. Идеальны для путешествий и повседневного использования.</p> <p>Ненавязчивые ароматы, которые раскрываются на коже постепенно. В основе натуральный соевый воск и кокосовое масло.</p> </div> </div> </div> <!-- 3. Спрей-духи --> <div class="carousel-slide" aria-roledescription="slide" aria-label="3 из 5"> <div class="slide-content"> <img
            src="https://static.tildacdn.com/tild3866-3434-4433-b832-623364383161/A7209298.JPG"
            alt="Спрей-духи"
            loading="lazy" fetchpriority="low" decoding="async" draggable="false"> <div class="slide-info"> <h3>Спрей-духи</h3> <p>Легкие и стойкие парфюмерные композиции в формате спрея. Обволакивающий шлейф и естественное звучание.</p> <p>Идеальны для создания атмосферы в помещении или для личного использования. Быстрое и равномерное распыление.</p> </div> </div> </div> <!-- 4. Масляные духи --> <div class="carousel-slide" aria-roledescription="slide" aria-label="4 из 5"> <div class="slide-content"> <img
            src="https://static.tildacdn.com/tild3934-3366-4236-a438-666631333662/A7209435.JPG"
            alt="Масляные духи"
            loading="lazy" fetchpriority="low" decoding="async" draggable="false"> <div class="slide-info"> <h3>Масляные духи</h3> <p>Концентрированные масляные духи с глубоким и стойким ароматом. Наносятся на пульсирующие точки, раскрываются постепенно и сохраняются на коже до 8 часов.</p> <p>Не содержат спирт и расходуются экономично за счет удобного роллера.</p> </div> </div> </div> <!-- 5. Диффузор для дома --> <div class="carousel-slide" aria-roledescription="slide" aria-label="5 из 5"> <div class="slide-content"> <img
            src="https://static.tildacdn.com/tild3065-6666-4639-a134-376136626236/A7201768.jpg"
            alt="Диффузор для дома"
            loading="lazy" fetchpriority="low" decoding="async" draggable="false"> <div class="slide-info"> <h3>Диффузор для дома</h3> <p>Деликатные и стойкие ароматические композиции в формате диффузора. Лаконичный флакон станет аккуратным акцентом в любом интерьере.</p> <p>Идеален для создания атмосферы в помещении — дома или в офисе. Фибровые палочки быстро впитывают композицию и равномерно распределяют запах по комнате.</p> </div> </div> </div> </div> <!-- Стрелки --> <button class="carousel-button prev" aria-label="Предыдущий слайд" type="button">&#10094;</button> <button class="carousel-button next" aria-label="Следующий слайд" type="button">&#10095;</button> </div> <script>
    (function(){
      const root = document.getElementById('hero-carousel');
      if(!root) return;

      const track = root.querySelector('.carousel');
      const slides = Array.from(root.querySelectorAll('.carousel-slide'));
      const btnPrev = root.querySelector('.carousel-button.prev');
      const btnNext = root.querySelector('.carousel-button.next');

      let index = 0;

      const go = (i) => {
        index = (i + slides.length) % slides.length;
        track.style.transform = `translateX(-${index * 100}%)`;
      };

      // Листание ТОЛЬКО стрелками (десктоп + мобильный)
      btnPrev.addEventListener('click', () => go(index - 1));
      btnNext.addEventListener('click', () => go(index + 1));

      // стартовый слайд
      go(0);
    })();
  </script> </div> <!-- nominify end --> </div> </div> </div> </div> <div id="rec1223334191" class="r t-rec" style=" " data-animationappear="off" data-record-type="131"> <!-- T123 --> <div class="t123"> <div class="t-container_100 "> <div class="t-width t-width_100 "> <!-- nominify begin --> <!-- BLOCK 4: Products (FINAL, discounts applied, compact cards — 3 в ряд) --> <section class="products-section" id="products-block-4"> <style>
    /* Локальные стили только для Блока 4 */
    #products-block-4 .add-to-cart { background:#816856; }
    #products-block-4 .add-to-cart:hover { background:#b99f94; }

    /* Уменьшаем карточки и визуальные элементы, при этом на десктопе остаётся 3 в ряд */
    #products-block-4 .products-container{
      display:flex; flex-wrap:wrap; justify-content:center; gap:28px;
    }
    #products-block-4 .product-card{
      width:100%;
      max-width:340px;               /* было 380px */
      border-radius:12px;
      box-shadow:0 12px 32px rgba(0,0,0,.08);
      transition:transform .3s ease, box-shadow .3s ease;
    }
    #products-block-4 .product-card:hover{
      transform:translateY(-6px);
      box-shadow:0 18px 42px rgba(0,0,0,.12);
    }
    #products-block-4 .product-gallery{ height:360px; }  /* было около 480px в глобальных */
    #products-block-4 .favorite-btn{ width:34px; height:34px; top:14px; right:14px; }

    #products-block-4 .product-info{ padding:18px; }
    #products-block-4 .product-title{ font-size:20px; margin-bottom:8px; }
    #products-block-4 .product-price{ font-size:18px; margin-bottom:16px; }

    #products-block-4 .product-variants{ margin-bottom:18px; }
    #products-block-4 .variants-label{ font-size:13px; margin-bottom:6px; }
    #products-block-4 .variant-select{
      padding:10px 12px; font-size:14px; border-radius:6px;
    }
    #products-block-4 .add-to-cart{
      padding:10px 12px; font-size:14px; letter-spacing:.6px;
    }

    /* Стили для цен: показываем только финальную цену */
    #products-block-4 .hs-price{
      display:flex; align-items:baseline; font-size:18px; color:#5a4a42;
    }
    #products-block-4 .hs-price .price-old{ display:none; }
    #products-block-4 .hs-price .price-new{ font-weight:600; }

    /* Адаптив — на мобильных карточка на всю ширину, чуть ниже галерея */
    @media (max-width: 768px){
      #products-block-4 .product-card{ max-width:100%; }
      #products-block-4 .product-gallery{ height:320px; }
    }
  </style> <h2 class="section-title"></h2> <div class="products-container"> <!-- 1: Масляные духи — 890 → 690 --> <div class="product-card" data-id="1"> <div class="product-gallery"> <div class="gallery-images"> <img src="https://static.tildacdn.com/tild3934-3366-4236-a438-666631333662/A7209435.JPG" alt="Масляные духи" class="gallery-image" loading="lazy" decoding="async" fetchpriority="low"> <img src="https://static.tildacdn.com/tild6139-6663-4864-b661-356461313633/A7201962.jpg" alt="Масляные духи" class="gallery-image" loading="lazy" decoding="async" fetchpriority="low"> </div> <button class="favorite-btn"><i class="far fa-heart"></i></button> </div> <div class="product-info"> <h3 class="product-title">Масляные духи</h3> <div class="product-price hs-price"> <span class="price-old">890 ₽</span> <span class="price-new">690 ₽</span> </div> <div class="product-variants"> <span class="variants-label">Аромат:</span> <select class="variant-select"> <option>Дух шамана</option> <option>Снежная пихта</option> <option>Манго &amp; кокосовое молоко</option> <option>Мох &amp; папоротник</option> <option>Дубовый мох &amp; янтарь</option> <option>Персиковый нектар</option> <option>Табак &amp; ваниль</option> <option>Смородина &amp; мята</option> <option>Морская соль &amp; орхидея</option> <option>Розовые кристаллы</option> <option>Антикварная библиотека</option> <option>Заснеженный можжевельник</option> <option>Розовое шампанское</option> <option>Грейпфрут &amp; мята</option> <option>Египетский янтарь</option> <option>Груша в бренди</option> <option>Вино Тосканы</option> <option>Летние закаты</option> </select> </div> <div class="product-variants"> <span class="variants-label">Объём:</span> <select class="variant-select"> <option value="10ml" data-price="690" data-old-price="890">10 мл</option> </select> </div> <button class="add-to-cart">в корзину</button> </div> </div> <!-- 2: Спрей духи — 5 мл: 890 → 690; 10 мл: 1190 → 890 --> <div class="product-card" data-id="2"> <div class="product-gallery"> <div class="gallery-images"> <img src="https://static.tildacdn.com/tild3736-3861-4732-b132-643033326361/1.jpg" alt="Спрей духи" class="gallery-image" loading="lazy" decoding="async" fetchpriority="low"> <img src="https://static.tildacdn.com/tild3039-6264-4635-a430-336139313630/90.jpg" alt="Спрей духи" class="gallery-image" loading="lazy" decoding="async" fetchpriority="low"> </div> <button class="favorite-btn"><i class="far fa-heart"></i></button> </div> <div class="product-info"> <h3 class="product-title">Спрей-духи</h3> <!-- По умолчанию выбран 5 мл --> <div class="product-price hs-price"> <span class="price-old">890 ₽</span> <span class="price-new">690 ₽</span> </div> <div class="product-variants"> <span class="variants-label">Аромат:</span> <select class="variant-select"> <option>Дух шамана</option> <option>Снежная пихта</option> <option>Манго &amp; кокосовое молоко</option> <option>Мох &amp; папоротник</option> <option>Дубовый мох &amp; янтарь</option> <option>Персиковый нектар</option> <option>Табак &amp; ваниль</option> <option>Смородина &amp; мята</option> <option>Морская соль &amp; орхидея</option> <option>Розовые кристаллы</option> <option>Антикварная библиотека</option> <option>Заснеженный можжевельник</option> <option>Грейпфрут &amp; мята</option> <option>Египетский янтарь</option> <option>Груша в бренди</option> <option>Вино Тосканы</option> <option>Летние закаты</option> <option>Розовое шампанское</option> </select> </div> <div class="product-variants"> <span class="variants-label">Объём:</span> <select class="variant-select"> <option value="5ml" data-price="690" data-old-price="890">5 мл</option> <option value="10ml" data-price="890" data-old-price="1190">10 мл</option> </select> </div> <button class="add-to-cart">в корзину</button> </div> </div> <!-- 3: Твёрдые духи — 790 → 590 --> <div class="product-card" data-id="3"> <div class="product-gallery"> <div class="gallery-images"> <img src="https://static.tildacdn.com/tild6434-6331-4939-b061-376239656336/IMG_7330.jpg" alt="Твёрдые духи" class="gallery-image" loading="lazy" decoding="async" fetchpriority="low"> <img src="https://static.tildacdn.com/tild3765-3836-4339-b935-613431633862/IMG_7321.jpg" alt="Твёрдые духи" class="gallery-image" loading="lazy" decoding="async" fetchpriority="low"> </div> <button class="favorite-btn"><i class="far fa-heart"></i></button> </div> <div class="product-info"> <h3 class="product-title">Твёрдые духи</h3> <div class="product-price hs-price"> <span class="price-old">790 ₽</span> <span class="price-new">590 ₽</span> </div> <div class="product-variants"> <span class="variants-label">Аромат:</span> <select class="variant-select"> <option>Дух шамана</option> <option>Снежная пихта</option> <option>Манго &amp; кокосовое молоко</option> <option>Мох &amp; папоротник</option> <option>Дубовый мох &amp; янтарь</option> <option>Персиковый нектар</option> <option>Табак &amp; ваниль</option> <option>Смородина &amp; мята</option> <option>Морская соль &amp; орхидея</option> <option>Розовые кристаллы</option> <option>Антикварная библиотека</option> <option>Заснеженный можжевельник</option> <option>Чистый хлопок</option> <option>Грейпфрут &amp; мята</option> <option>Египетский янтарь</option> <option>Груша в бренди</option> <option>Вино Тосканы</option> <option>Летние закаты</option> <option>Розовое шампанское</option> </select> </div> <div class="product-variants"> <span class="variants-label">Объём:</span> <select class="variant-select"> <option value="20ml" data-price="590" data-old-price="790">20 мл</option> </select> </div> <button class="add-to-cart">в корзину</button> </div> </div> <!-- 4: Свеча 30 мл — 590 → 390 --> <div class="product-card" data-id="4"> <div class="product-gallery"> <div class="gallery-images"> <img src="https://static.tildacdn.com/tild6665-6566-4038-b833-343037383437/30_.jpg" alt="Свеча 30 мл" class="gallery-image" loading="lazy" decoding="async" fetchpriority="low"> <img src="https://static.tildacdn.com/tild3534-3938-4839-b061-393833326664/30__2.jpg" alt="Свеча 30 мл" class="gallery-image" loading="lazy" decoding="async" fetchpriority="low"> </div> <button class="favorite-btn"><i class="far fa-heart"></i></button> </div> <div class="product-info"> <h3 class="product-title">Свеча 30 мл</h3> <div class="product-price hs-price"> <span class="price-old">590 ₽</span> <span class="price-new">390 ₽</span> </div> <div class="product-variants"> <span class="variants-label">Аромат:</span> <select class="variant-select"> <option>Дух шамана</option> <option>Снежная пихта</option> <option>Манго &amp; кокосовое молоко</option> <option>Мох &amp; папоротник</option> <option>Дубовый мох &amp; янтарь</option> <option>Персиковый нектар</option> <option>Табак &amp; ваниль</option> <option>Смородина &amp; мята</option> <option>Морская соль &amp; орхидея</option> <option>Розовые кристаллы</option> <option>Антикварная библиотека</option> <option>Заснеженный можжевельник</option> <option>Чистый хлопок</option> <option>Грейпфрут &amp; мята</option> <option>Египетский янтарь</option> <option>Груша в бренди</option> <option>Вино Тосканы</option> <option>Летние закаты</option> <option>Чао-какао</option> <option>Карамельный попкорн</option> <option>Горячий хлеб</option> <option>Розовое шампанское</option> </select> </div> <div class="product-variants"> <span class="variants-label">Фитиль:</span> <select class="variant-select"> <option value="Хлопковый" data-price="390" data-old-price="590">Хлопковый</option> </select> </div> <button class="add-to-cart">в корзину</button> </div> </div> <!-- 5: Свеча 100 мл — 890 → 590 --> <div class="product-card" data-id="5"> <div class="product-gallery"> <div class="gallery-images"> <img src="https://static.tildacdn.com/tild3133-3132-4437-a264-303636356166/1.jpg" alt="Свеча 100 мл" class="gallery-image" loading="lazy" decoding="async" fetchpriority="low"> <img src="https://static.tildacdn.com/tild6362-6230-4462-a233-386130343466/2.jpg" alt="Свеча 100 мл" class="gallery-image" loading="lazy" decoding="async" fetchpriority="low"> </div> <button class="favorite-btn"><i class="far fa-heart"></i></button> </div> <div class="product-info"> <h3 class="product-title">Свеча 100 мл</h3> <div class="product-price hs-price"> <span class="price-old">890 ₽</span> <span class="price-new">590 ₽</span> </div> <div class="product-variants"> <span class="variants-label">Аромат:</span> <select class="variant-select"> <option>Дух шамана</option> <option>Снежная пихта</option> <option>Манго &amp; кокосовое молоко</option> <option>Мох &amp; папоротник</option> <option>Дубовый мох &amp; янтарь</option> <option>Персиковый нектар</option> <option>Табак &amp; ваниль</option> <option>Смородина &amp; мята</option> <option>Морская соль &amp; орхидея</option> <option>Розовые кристаллы</option> <option>Антикварная библиотека</option> <option>Заснеженный можжевельник</option> <option>Грейпфрут &amp; мята</option> <option>Египетский янтарь</option> <option>Груша в бренди</option> <option>Вино Тосканы</option> <option>Летние закаты</option> <option>Карамельный попкорн</option> <option>Чао-какао</option> <option>Горячий хлеб</option> <option>Чистый хлопок</option> <option>Розовое шампанское</option> </select> </div> <div class="product-variants"> <span class="variants-label">Фитиль:</span> <select class="variant-select"> <option value="Хлопковый" data-price="590" data-old-price="890">Хлопковый</option> <option value="Деревянный" data-price="590" data-old-price="890">Деревянный</option> </select> </div> <button class="add-to-cart">в корзину</button> </div> </div> <!-- 6: Аромадиффузор — 1490 → 1190 --> <div class="product-card" data-id="6" id="product-diffuser"> <div class="product-gallery"> <div class="gallery-images"> <img src="https://static.tildacdn.com/tild3431-3732-4934-b737-656266306564/A7201768.jpg" alt="Аромадиффузор для дома" class="gallery-image" loading="lazy" decoding="async" fetchpriority="low"> <img src="https://static.tildacdn.com/tild6430-3962-4661-a566-343833356330/A7201774.jpg" alt="Аромадиффузор для дома" class="gallery-image" loading="lazy" decoding="async" fetchpriority="low"> </div> <button class="favorite-btn"><i class="far fa-heart"></i></button> </div> <div class="product-info"> <h3 class="product-title">Аромадиффузор для дома</h3> <div class="product-price hs-price"> <span class="price-old">1490 ₽</span> <span class="price-new">1190 ₽</span> </div> <div class="product-variants"> <span class="variants-label">Аромат:</span> <select class="variant-select"> <option>Дух шамана</option> <option>Мох &amp; папоротник</option> <option>Дубовый мох &amp; янтарь</option> <option>Персиковый нектар</option> <option>Табак &amp; ваниль</option> <option>Смородина &amp; мята</option> <option>Морская соль &amp; орхидея</option> <option>Заснеженный можжевельник</option> <option>Вино Тосканы</option> </select> </div> <div class="product-variants"> <span class="variants-label">Объём:</span> <select class="variant-select"> <option value="50ml" data-price="1190" data-old-price="1490">50 мл</option> </select> </div> <button class="add-to-cart">в корзину</button> </div> </div> </div> <script>
    // Универсальные стили для цен (аккуратный фикс строки со стилями)
    (function ensurePriceStyles(){
      if(!document.getElementById('hsPriceStylesGlobal')){
        const st = document.createElement('style');
        st.id = 'hsPriceStylesGlobal';
        st.textContent = `
          .hs-price{display:flex;align-items:baseline;font-size:20px;color:#5a4a42;}
          .hs-price .price-old{display:none;}
          .hs-price .price-new{font-weight:600;}
        `;
        document.head.appendChild(st);
      }
    })();

    document.addEventListener('DOMContentLoaded', function(){
      const fmtLocal = (n)=> (Number(n)||0).toLocaleString('ru-RU') + ' ₽';

      function ensurePriceSlots(el){
        if(!el) return null;
        el.classList.add('hs-price');
        if(!el.querySelector('.price-old') || !el.querySelector('.price-new')){
          el.innerHTML = '<span class="price-old"></span> <span class="price-new"></span>';
        }
        return el;
      }

      function updateCardPrice(card){
        const priceEl = ensurePriceSlots(card.querySelector('.product-price'));
        if(!priceEl) return;

        // Источник цены — селект объёма/фитиля (обычно второй); если его нет — первый
        const selects = card.querySelectorAll('.product-variants .variant-select');
        const priceSource = selects[1] || selects[0];
        const opt = priceSource?.options[priceSource.selectedIndex];
        const newPrice = opt?.getAttribute('data-price');

        // Перерисуем аккуратно (если другие скрипты меняли textContent)
        setTimeout(()=>{
          ensurePriceSlots(priceEl);
          // Старую цену не показываем
          const oldSpan = priceEl.querySelector('.price-old');
          if (oldSpan) oldSpan.textContent = '';
          priceEl.querySelector('.price-new').textContent = fmtLocal(newPrice ?? 0);
        }, 0);
      }

      // Инициализация всех карточек на странице
      document.querySelectorAll('#products-block-4 .product-card').forEach(card=>{
        ensurePriceSlots(card.querySelector('.product-price'));
        updateCardPrice(card);
      });

      // Обновление при изменении вариантов внутри блока
      document.querySelectorAll('#products-block-4 .variant-select').forEach(sel=>{
        sel.addEventListener('change', function(){
          const card = this.closest('.product-card');
          if (card) updateCardPrice(card);
        });
      });

      // Фикс цвета кнопок (если внешний код меняет цвет)
      const NEW_COLOR = '#816856';
      document.querySelectorAll('#products-block-4 .add-to-cart').forEach(btn=>{
        btn.style.backgroundColor = NEW_COLOR;
        btn.addEventListener('click', ()=>{
          setTimeout(()=>{ btn.style.backgroundColor = NEW_COLOR; }, 1250);
        });
      });
    });
  </script> </section> <!-- nominify end --> </div> </div> </div> </div> <div id="rec1223334741" class="r t-rec" style=" " data-animationappear="off" data-record-type="131"> <!-- T123 --> <div class="t123"> <div class="t-container_100 "> <div class="t-width t-width_100 "> <!-- nominify begin --> <!-- BLOCK 6: Aroma Selector (final) --> <section class="aroma-section"> <h2 class="section-title">Как выбрать аромат?</h2> <div class="aroma-content"> <p class="aroma-intro">
      Каждый аромат — это пирамида нот, раскрывающихся на коже постепенно.
      <span class="aroma-intro-sub">Выберите аромат, чтобы увидеть его композицию:</span> </p> <div class="aroma-selector"> <select class="aroma-select" id="aromaSelect"> <option value="citrus">Чистый хлопок</option> <option value="vanilla">Манго & кокосовое молоко</option> <option value="floral">Снежная пихта</option> <option value="woody">Вино тосканы</option> <option value="fresh">Горячий хлеб</option> <option value="spicy">Груша в бренди</option> <option value="spicy">Дубовый мох & янтарь</option> <option value="spicy">Розовое шампанское</option> <option value="spicy">Антикварная библиотека</option> <option value="spicy">Персиковый нектар</option> <option value="spicy">Грейпфрут & мята</option> <option value="spicy">Чао-какао</option> <option value="spicy">Мох & папоротник</option> <option value="spicy">Дух шамана</option> <option value="spicy">Розовые кристаллы</option> <option value="spicy">Летние закаты</option> <option value="spicy">Карамельный попкорн</option> <option value="spicy">Морская соль & орхидея</option> <option value="spicy">Египетский янтарь</option> <option value="spicy">Табак & ваниль</option> <option value="spicy">Смородина & мята</option> <option value="spicy">Заснеженный можжевельник</option> </select> </div> <div class="pyramid-container"> <div class="pyramid" id="aromaPyramid"></div> </div> </div> </section> <!-- Spacing: H2 ↔ intro немного больше --> <style id="hsAromaTitleSpacing">
  .aroma-section .section-title{ margin-bottom: 12px; }
</style> <!-- Subline: новая строка; цвет как был (inherit), но жирнее --> <style id="hsAromaIntroSubline">
  .aroma-intro{ margin: 0 0 8px; }
  .aroma-intro-sub{
    display:block;
    margin-top: 1em;      /* одна строка отступа */
    font-weight: 800;     /* более жирный */
    color: inherit;       /* тот же цвет, что и у основного текста */
  }
</style> <!-- PATCH: контур селекта без изменения размера/шрифта --> <style id="hsAromaSelectContour">
  #aromaSelect{
    box-shadow: 0 0 0 2px rgba(129,104,86,.22);
    border-color: #CBB9AC;
    background-clip: padding-box;
    transition: box-shadow .15s ease, border-color .15s ease;
  }
  #aromaSelect:hover{
    box-shadow: 0 0 0 2px rgba(129,104,86,.3), 0 2px 8px rgba(0,0,0,.05);
    border-color: #BFAFA3;
  }
  #aromaSelect:focus{
    outline: none;
    box-shadow:
      0 0 0 2px #E8DED4,
      0 0 0 4px rgba(129,104,86,.28);
    border-color: #A89183;
  }
  @media (prefers-reduced-motion: reduce){
    #aromaSelect{ transition: none; }
  }
</style> <!-- PATCH: селект чуть уже --> <style id="hsAromaSelectSlightlySmaller_v2">
  #aromaSelect{ width: clamp(220px, 24vw, 260px); }
  @media (max-width: 480px){
    #aromaSelect{ width: 68vw; }
  }
</style> <!-- PATCH: выравнивание селектора и пирамиды --> <style id="hsAromaSelectAlignToPyramid">
  .aroma-selector{
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 8px;
    max-width: 420px;
    margin: 0 auto 10px;
  }
  .pyramid-container{
    max-width: 420px;
    margin: 10px auto 0;
  }
  @media (max-width: 480px){
    .aroma-selector,
    .pyramid-container{ max-width: 340px; }
  }
</style> <!-- PATCH: центр текста в закрытом селекте --> <style id="hsAromaSelectCenter">
  #aromaSelect{
    text-align: center;
    text-align-last: center;
  }
  #aromaSelect option{ text-align: left; }
</style> <style id="hsAromaIntroSubline">
  .aroma-intro{ margin: 0 0 8px; }
  .aroma-intro-sub{
    display:block;
    margin-top: 1em;   /* одна строка */
    font-weight: 600;  /* вместо 800 */
    color: inherit;    /* оставить исходный цвет */
  }
</style> <style id="hsAromaTitleSpacing">
  /* Больше отступа между "Как выбрать аромат?" и абзацем ниже */
  .aroma-section .section-title{
    margin-bottom: clamp(16px, 2.4vw, 24px);
  }
</style> <!-- nominify end --> </div> </div> </div> </div> <div id="rec1558069921" class="r t-rec" style=" " data-animationappear="off" data-record-type="131"> <!-- T123 --> <div class="t123"> <div class="t-container_100 "> <div class="t-width t-width_100 "> <!-- nominify begin --> <!-- BLOCK: Квиз-помощник выбора аромата духов/свечей --> <section id="aroma-helper"> <style>
    /* ===== СКОУП ТОЛЬКО ДЛЯ #aroma-helper ===== */
    #aroma-helper{
      --bg:#f7f5f2; --paper:#ffffff; --ink:#3b332f; --muted:#7a6d66;
      --brand:#5a4a42; --accent:#816856; --line:#e6e0d8;
      --radius:16px; --shadow:0 14px 36px rgba(0,0,0,.08);
      background:var(--bg);
      padding:40px 20px 50px;
    }
    #aroma-helper *{ box-sizing:border-box; }
    #aroma-helper .ah-wrap{ max-width:980px; margin:0 auto; }

    #aroma-helper .ah-header{ text-align:center; margin-bottom:24px; }
    #aroma-helper .ah-title{
      font-size:24px; line-height:1.3;
      color:var(--brand); margin-bottom:8px; font-weight:600;
    }
    #aroma-helper .ah-sub{
      font-size:14px; line-height:1.6; color:var(--muted);
      max-width:560px; margin:0 auto;
    }

    #aroma-helper .ah-main{ max-width:720px; margin:0 auto; }
    #aroma-helper .ah-card{
      background:var(--paper); border-radius:var(--radius);
      box-shadow:var(--shadow);
      padding:22px 18px 20px;
      border:1px solid rgba(0,0,0,.02);
    }

    /* ВОПРОСЫ */
    #aroma-helper .ah-questions-wrap{ display:block; }
    #aroma-helper .ah-questions{
      display:flex; flex-direction:column; gap:18px;
    }
    #aroma-helper .ah-question{
      padding:14px 12px 10px;
      border-radius:12px;
      border:1px solid var(--line);
      background:rgba(255,255,255,.9);
    }
    #aroma-helper .ah-q-title{
      font-size:14px; font-weight:600; color:var(--brand);
      margin-bottom:8px;
      display:flex; align-items:center; gap:6px;
    }
    #aroma-helper .ah-q-title span.q-num{
      display:inline-flex; width:20px; height:20px;
      border-radius:999px; align-items:center; justify-content:center;
      font-size:11px;
      background:rgba(129,104,86,.08); color:var(--accent);
    }

    #aroma-helper .ah-options{
      display:flex; flex-wrap:wrap; gap:8px;
    }
    #aroma-helper .ah-option{ position:relative; }
    #aroma-helper .ah-option input{
      position:absolute; opacity:0; pointer-events:none;
    }
    #aroma-helper .ah-pill{
      display:inline-flex; align-items:center; justify-content:center;
      padding:7px 11px; border-radius:999px;
      font-size:13px; line-height:1.3;
      cursor:pointer;
      border:1px solid rgba(0,0,0,.08);
      background:#f9f6f1; color:var(--muted);
      transition:all .18s ease;
      white-space:nowrap;
    }
    #aroma-helper .ah-option input:checked + .ah-pill{
      background:var(--accent); color:#fff;
      border-color:var(--accent);
      box-shadow:0 8px 22px rgba(129,104,86,.35);
      transform:translateY(-1px);
    }
    #aroma-helper .ah-option input:focus-visible + .ah-pill{
      outline:2px solid var(--accent); outline-offset:2px;
    }

    /* КНОПКИ */
    #aroma-helper .ah-actions{
      display:flex; flex-wrap:wrap; gap:10px;
      margin-top:16px;
    }
    #aroma-helper .ah-actions--result{
      margin-top:10px; justify-content:flex-start;
    }
    #aroma-helper .ah-btn-main,
    #aroma-helper .ah-btn-ghost{
      border-radius:999px;
      font-size:14px; padding:10px 18px;
      cursor:pointer; border:1px solid transparent;
      font-family:inherit;
      display:inline-flex; align-items:center; gap:6px;
      transition:all .2s ease;
      white-space:nowrap;
    }
    #aroma-helper .ah-btn-main{
      background:var(--accent); color:#fff;
      border-color:var(--accent);
      box-shadow:0 10px 24px rgba(129,104,86,.35);
    }
    #aroma-helper .ah-btn-main:hover{
      background:#a3826b; border-color:#a3826b;
      transform:translateY(-1px);
    }
    #aroma-helper .ah-btn-main:active{
      transform:translateY(0);
      box-shadow:0 4px 12px rgba(0,0,0,.25);
    }
    #aroma-helper .ah-btn-ghost{
      background:transparent; color:var(--muted);
      border-color:var(--line);
    }
    #aroma-helper .ah-btn-ghost:hover{
      background:rgba(0,0,0,.02);
    }

    /* ОШИБКА */
    #aroma-helper .ah-error{
      margin-top:10px;
      font-size:12px; color:#b0574c;
      line-height:1.5; display:none;
    }

    /* РЕЗУЛЬТАТ (на месте вопросов) */
    #aroma-helper .ah-result-screen{
      display:none; flex-direction:column; gap:14px;
    }
    #aroma-helper .ah-result-head{
      font-size:13px; letter-spacing:.12em;
      text-transform:uppercase; color:var(--muted);
    }
    #aroma-helper .ah-result-box{
      border-radius:12px;
      border:1px dashed var(--line);
      padding:16px 14px 14px;
      background:rgba(247,245,242,.9);
      display:flex; flex-direction:column; gap:10px;
    }
    #aroma-helper .ah-result-title{
      font-size:17px; font-weight:600;
      color:var(--brand);
      display:flex; align-items:center; gap:8px; flex-wrap:wrap;
    }
    #aroma-helper .ah-result-badge{
      font-size:10px; text-transform:uppercase;
      letter-spacing:.16em;
      padding:4px 8px;
      border-radius:999px;
      border:1px solid rgba(129,104,86,.2);
      color:var(--accent); background:#fff;
    }
    #aroma-helper .ah-result-text{
      font-size:13px; line-height:1.6; color:var(--muted);
    }
    #aroma-helper .ah-result-tip{
      font-size:12px; line-height:1.6; color:var(--muted);
      border-radius:10px; padding:10px 11px;
      background:#fff;
      border:1px dashed rgba(129,104,86,.3);
    }
    #aroma-helper .ah-footnote{
      font-size:11px; color:var(--muted);
      opacity:.85; line-height:1.5;
    }

    /* МЕДИА */
    @media (max-width:900px){
      #aroma-helper{
        padding:30px 16px 40px;
      }
      #aroma-helper .ah-title{ font-size:20px; }
      #aroma-helper .ah-card{
        padding:18px 14px 16px;
      }
    }
    @media (max-width:480px){
      #aroma-helper .ah-options{ gap:6px; }
      #aroma-helper .ah-pill{
        font-size:12px; padding:6px 9px;
      }
      #aroma-helper .ah-actions{
        flex-direction:column; align-items:stretch;
      }
      #aroma-helper .ah-btn-main,
      #aroma-helper .ah-btn-ghost{
        justify-content:center; width:100%;
      }
    }
  </style> <div class="ah-wrap"> <header class="ah-header"> <h2 class="ah-title">Какой аромат Home Secret подойдёт именно вам?</h2> <p class="ah-sub">
        Ответьте на несколько простых вопросов — и мы подскажем,
        с каких направлений и конкретных ароматов лучше начать знакомство
        с масляными духами, парфюмом и свечами Home Secret.
      </p> </header> <div class="ah-main"> <div class="ah-card"> <!-- ЭКРАН ВОПРОСОВ --> <div class="ah-questions-wrap" id="ah-questions-wrap"> <div class="ah-questions"> <!-- Q1: Что хотите подобрать (НЕ влияет на подбор ароматов, только текст) --> <div class="ah-question" data-question="product"> <div class="ah-q-title"> <span class="q-num">1</span> <span>Что вы сейчас хотите подобрать?</span> </div> <div class="ah-options"> <label class="ah-option"> <input type="radio" name="product" value="perfume" /> <span class="ah-pill">Духи (масляные, спрей, твёрдые)</span> </label> <label class="ah-option"> <input type="radio" name="product" value="candle" /> <span class="ah-pill">Свечу / аромат для дома</span> </label> <label class="ah-option"> <input type="radio" name="product" value="both" /> <span class="ah-pill">И духи, и свечу — посмотрю варианты</span> </label> </div> </div> <!-- Q2: Ноты (можно несколько, жёсткая привязка к ароматам) --> <div class="ah-question" data-question="notes"> <div class="ah-q-title"> <span class="q-num">2</span> <span>Какие ноты вам сейчас ближе всего? (можно несколько)</span> </div> <div class="ah-options"> <label class="ah-option"> <input type="checkbox" name="notes" value="wood" /> <span class="ah-pill">Древесные, лесные</span> </label> <label class="ah-option"> <input type="checkbox" name="notes" value="sweet" /> <span class="ah-pill">Сладкие, десертные</span> </label> <label class="ah-option"> <input type="checkbox" name="notes" value="fresh_sea" /> <span class="ah-pill">Свежие, морские</span> </label> <label class="ah-option"> <input type="checkbox" name="notes" value="fruity" /> <span class="ah-pill">Фруктовые / ягодные</span> </label> </div> </div> <!-- Q3: Интенсивность (НЕ влияет на выбор ароматов) --> <div class="ah-question" data-question="intensity"> <div class="ah-q-title"> <span class="q-num">3</span> <span>Насколько ярко вы хотите ощущать аромат на себе?</span> </div> <div class="ah-options"> <label class="ah-option"> <input type="radio" name="intensity" value="soft" /> <span class="ah-pill">Совсем мягко: только для себя</span> </label> <label class="ah-option"> <input type="radio" name="intensity" value="medium" /> <span class="ah-pill">Умеренно: чтобы чувствовали вы и близкие</span> </label> <label class="ah-option"> <input type="radio" name="intensity" value="strong" /> <span class="ah-pill">Ярко: чтобы аромат уверенно слышали</span> </label> </div> </div> </div> <div class="ah-actions"> <button type="button" class="ah-btn-main" id="ah-run">
              Подобрать аромат <span>✨</span> </button> <button type="button" class="ah-btn-ghost" id="ah-reset">
              Сбросить ответы
            </button> </div> <div class="ah-error" id="ah-error"></div> </div> <!-- ЭКРАН РЕЗУЛЬТАТА (вместо вопросов) --> <div class="ah-result-screen" id="ah-result-screen"> <div class="ah-result-head">Ваша рекомендация</div> <div class="ah-result-box"> <div class="ah-result-title"> <span id="ah-result-title-text"></span> <span class="ah-result-badge" id="ah-result-badge"></span> </div> <div class="ah-result-text" id="ah-result-desc"></div> <div class="ah-result-tip" id="ah-result-tip"></div> </div> <div class="ah-footnote">
            Это направление и подборка ароматов помогут сделать первые покупки приятными.
            Дальше можно пробовать другие ноты в этой же «семье», чтобы найти свой идеальный запах.
          </div> <div class="ah-actions ah-actions--result"> <button type="button" class="ah-btn-ghost" id="ah-again">
              Пройти ещё раз
            </button> </div> </div> </div> </div> </div> <script>
    (function(){
      const root = document.getElementById('aroma-helper');
      if(!root) return;

      const RUN_BTN       = root.querySelector('#ah-run');
      const RESET_BTN     = root.querySelector('#ah-reset');
      const AGAIN_BTN     = root.querySelector('#ah-again');
      const QUESTIONS_WRAP= root.querySelector('#ah-questions-wrap');
      const RESULT_SCREEN = root.querySelector('#ah-result-screen');
      const ERROR_EL      = root.querySelector('#ah-error');
      const TITLE_EL      = root.querySelector('#ah-result-title-text');
      const BADGE_EL      = root.querySelector('#ah-result-badge');
      const DESC_EL       = root.querySelector('#ah-result-desc');
      const TIP_EL        = root.querySelector('#ah-result-tip');

      // === Все ароматы (key -> название на сайте)
      const AROMAS = {
        citrus:           'Чистый хлопок',
        vanilla:          'Манго & кокосовое молоко',
        floral:           'Снежная пихта',
        woody:            'Вино Тосканы',
        fresh:            'Горячий хлеб',
        'pear-brandy':    'Груша в бренди',
        'oakmoss-amber':  'Дубовый мох & янтарь',
        'pink-champagne': 'Розовое шампанское',
        'antique-library':'Антикварная библиотека',
        'peach-nectar':   'Персиковый нектар',
        'grapefruit-mint':'Грейпфрут & мята',
        'ciao-cacao':     'Чао-какао',
        'moss-fern':      'Мох & папоротник',
        'shaman-spirit':  'Дух шамана',
        'pink-crystals':  'Розовые кристаллы',
        'summer-sunsets': 'Летние закаты',
        'caramel-popcorn':'Карамельный попкорн',
        'sea-salt-orchid':'Морская соль & орхидея',
        'egyptian-amber': 'Египетский янтарь',
        'tobacco-vanilla':'Табак & ваниль',
        'currant-mint':   'Смородина & мята',
        'snowy-juniper':  'Заснеженный можжевельник'
      };

      // ЖЁСТКАЯ привязка НОТА → КОНКРЕТНЫЕ АРОМАТЫ
      const NOTES_TO_KEYS = {
        // древесные / лесные (без «Вино Тосканы» и «Дух шамана»)
        wood: [
          'oakmoss-amber',   // Дубовый мох & янтарь
          'summer-sunsets',  // Летние закаты
          'antique-library', // Антикварная библиотека
          'moss-fern',       // Мох & папоротник
          'snowy-juniper',   // Заснеженный можжевельник
          'egyptian-amber',  // Египетский янтарь
          'tobacco-vanilla', // Табак & ваниль
          'floral'           // Снежная пихта
        ],
        // сладкие / десертные (сюда входит Вино Тосканы)
        sweet: [
          'pear-brandy',     // Груша в бренди
          'pink-crystals',   // Розовые кристаллы
          'caramel-popcorn', // Карамельный попкорн
          'ciao-cacao',      // Чао-какао
          'vanilla',         // Манго & кокосовое молоко
          'pink-champagne',  // Розовое шампанское
          'currant-mint',    // Смородина & мята
          'fresh',           // Горячий хлеб
          'woody',           // Вино Тосканы — сладкий виноград, специи
          'egyptian-amber',  // Египетский янтарь
          'tobacco-vanilla', // Табак & ваниль
          'peach-nectar'     // Персиковый нектар
        ],
        // свежие / морские / зелёные / хвойные (сюда относится Дух шамана)
        fresh_sea: [
          'sea-salt-orchid', // Морская соль & орхидея
          'grapefruit-mint', // Грейпфрут & мята
          'currant-mint',    // Смородина & мята
          'citrus',          // Чистый хлопок
          'floral',          // Снежная пихта
          'moss-fern',       // Мох & папоротник
          'snowy-juniper',   // Заснеженный можжевельник
          'shaman-spirit'    // Дух шамана
        ],
        // фруктовые / ягодные (сюда тоже входит Вино Тосканы)
        fruity: [
          'pear-brandy',     // Груша в бренди
          'peach-nectar',    // Персиковый нектар
          'pink-crystals',   // Розовые кристаллы
          'vanilla',         // Манго & кокосовое молоко
          'pink-champagne',  // Розовое шампанское
          'currant-mint',    // Смородина & мята
          'grapefruit-mint', // Грейпфрут & мята
          'woody'            // Вино Тосканы — сладкий виноград
        ]
      };

      // Тексты для семейств (по ощущениям от выбранных нот)
      const RESULTS = {
        cozy: {
          title: 'Тёплые уютные ароматы',
          badge: 'Ваниль • Амбра • Десерты',
          desc: 'Вам подходят мягкие, обволакивающие композиции с нотами десертов, тёплого дерева, специй и сладких фруктов. Это ароматы-объятия — они создают ощущение пледа, какао и домашнего уюта.',
          tip: ''
        },
        fresh: {
          title: 'Свежие и воздушные ароматы',
          badge: 'Цитрусы • Зелень • Морской воздух',
          desc: 'Вы тянетесь к лёгкости, чувству чистоты и «открытого окна». Вам подойдут свежие, зелёные и водные композиции, которые комфортно звучат и на коже, и в пространстве, не утомляя окружающих.',
          tip: ''
        },
        deep: {
          title: 'Глубокие атмосферные ароматы',
          badge: 'Дерево • Смолы • Табак',
          desc: 'Вам близки насыщенные, характерные ароматы с древесными, смолистыми, табачными и пряными акцентами. Это чаще всего «вечерние» ароматы, которые собирают на себе внимание и задают настроение.',
          tip: ''
        },
        clean: {
          title: 'Чистые, мягкие и спокойные ароматы',
          badge: 'Хлопок • Спокойный фон',
          desc: 'Вы любите ощущение аккуратности и свежевыстиранного белья без лишней сладости и тяжести. Подойдут мягкие, спокойные ароматы, которые ощущаются деликатно и не навязываются ни вам, ни окружающим.',
          tip: ''
        }
      };

      function collectAnswers(){
        const data = {};

        const prod = root.querySelector('input[name="product"]:checked');
        data.product = prod ? prod.value : null;

        const intensity = root.querySelector('input[name="intensity"]:checked');
        data.intensity = intensity ? intensity.value : null;

        const notesChecked = Array.from(
          root.querySelectorAll('input[name="notes"]:checked')
        ).map(i => i.value);
        data.notes = notesChecked;

        return data;
      }

      // Профиль для текста (cozy/fresh/deep/clean) — ТОЛЬКО по выбранным нотам
      function calcProfile(ans){
        const notes = Array.isArray(ans.notes)
          ? ans.notes
          : (ans.notes ? [ans.notes] : []);

        if(!notes.length){
          return 'cozy';
        }

        const score = { cozy:0, fresh:0, deep:0, clean:0 };

        notes.forEach(n=>{
          if(n === 'wood'){
            score.deep  += 2;
          } else if(n === 'sweet'){
            score.cozy  += 2;
          } else if(n === 'fresh_sea'){
            score.fresh += 2;
            score.clean += 1;
          } else if(n === 'fruity'){
            score.cozy  += 1;
            score.fresh += 0.5;
          }
        });

        let best = 'cozy';
        let bestScore = -Infinity;
        Object.keys(score).forEach(key=>{
          if(score[key] > bestScore){
            bestScore = score[key];
            best = key;
          }
        });

        return best;
      }

      // ВСЕ подходящие ароматы по выбранным нотам (ничего не режем)
      function getRecommendedAromasByNotes(notes){
        const selected = Array.isArray(notes) ? notes : [];
        const order = ['wood','sweet','fresh_sea','fruity'];
        let keys = [];

        order.forEach(code=>{
          if(selected.includes(code)){
            const list = NOTES_TO_KEYS[code] || [];
            keys = keys.concat(list);
          }
        });

        if(!keys.length){
          // если человек ничего не выбрал — показываем все ароматы
          keys = Object.keys(AROMAS);
        }

        keys = Array.from(new Set(keys)); // убираем дубли

        return keys
          .map(k => AROMAS[k])
          .filter(Boolean);
      }

      function clearAnswers(){
        const inputs = root.querySelectorAll(
          'input[name="product"], input[name="notes"], input[name="intensity"]'
        );
        inputs.forEach(i => { i.checked = false; });
      }

      function showQuestions(){
        RESULT_SCREEN.style.display = 'none';
        QUESTIONS_WRAP.style.display = 'block';
      }

      function showResultScreen(){
        QUESTIONS_WRAP.style.display = 'none';
        RESULT_SCREEN.style.display = 'flex';
      }

      function showError(msg){
        if(!ERROR_EL){
          alert(msg);
          return;
        }
        ERROR_EL.textContent = msg;
        ERROR_EL.style.display = 'block';
      }

      function clearError(){
        if(ERROR_EL){
          ERROR_EL.textContent = '';
          ERROR_EL.style.display = 'none';
        }
      }

      function showResult(profile, ans){
        const data = RESULTS[profile] || RESULTS.cozy;

        TITLE_EL.textContent = data.title;
        BADGE_EL.textContent = data.badge;
        DESC_EL.textContent  = data.desc;

        const names = getRecommendedAromasByNotes(ans.notes || []);

        let productText = 'для покупок';
        if(ans.product === 'perfume')      productText = 'для духов';
        else if(ans.product === 'candle')  productText = 'для свечей и домашних ароматов';
        else if(ans.product === 'both')    productText = 'и для духов, и для свечей';

        if(names.length){
          TIP_EL.innerHTML =
            '<strong>С чего начать:</strong> присмотритесь к ароматам ' +
            '<b>' + names.join(' · ') + '</b> — они особенно хорошо подойдут ' +
            productText.toLowerCase() + '.';
        } else {
          TIP_EL.textContent = '';
        }

        clearError();
        showResultScreen();
      }

      function resetAll(){
        clearAnswers();
        clearError();
        showQuestions();
      }

      RUN_BTN && RUN_BTN.addEventListener('click', function(){
        const ans = collectAnswers();

        if(!ans.product || !ans.intensity || !ans.notes || !ans.notes.length){
          showError('Пожалуйста, ответьте на все вопросы — так мы сможем точнее подобрать аромат.');
          return;
        }

        const profile = calcProfile(ans); // только по нотам
        showResult(profile, ans);         // и ароматы — только по нотам
      });

      RESET_BTN && RESET_BTN.addEventListener('click', resetAll);
      AGAIN_BTN && AGAIN_BTN.addEventListener('click', resetAll);
    })();
  </script> </section> <!-- nominify end --> </div> </div> </div> </div> <div id="rec1223335151" class="r t-rec" style=" " data-animationappear="off" data-record-type="131"> <!-- T123 --> <div class="t123"> <div class="t-container_100 "> <div class="t-width t-width_100 "> <!-- nominify begin --> <!-- BLOCK 7: About (статичное фото без зума и анимаций) --> <section class="about-section" id="about"> <style>
    /* Параметры блока */
    #about.about-section {
      --radius-img: 28px;
      --img-w-desktop: 360px;  /* подтверждённый размер на десктопе */
      --img-w-mobile: 280px;   /* подтверждённый размер на мобильных */
      /* Мягкая статичная тень (без агрессии) */
      --shadow-img: 0 6px 18px rgba(16, 24, 40, .08), 0 2px 6px rgba(16, 24, 40, .06);
      padding: 50px 15px;
    }

    #about .about-container {
      display: flex;
      align-items: center;
      gap: 30px;
    }

    #about .about-text h2 {
      font-size: 26px;
      margin-bottom: 16px;
      letter-spacing: 1px;
    }
    #about .about-text h2::after {
      content: "";
      display: block;
      width: 60px;
      height: 2px;
      background: currentColor;
      opacity: .2;
      margin: 10px 0 18px;
    }
    #about .about-text p {
      font-size: 15px;
      line-height: 1.55;
      margin-bottom: 14px;
    }

    /* Контейнер фото */
    #about .about-image {
      flex: 0 0 38%;
      padding: 0 !important;
      background: transparent !important;
      border: 0 !important;
      box-shadow: none !important;
    }

    /* Статичная рамка с мягкой тенью и скруглением */
    #about .photo-frame {
      max-width: var(--img-w-desktop);
      width: 100%;
      margin: 0 auto;
      border-radius: var(--radius-img);
      overflow: hidden;                 /* чтобы скруглённые края были чёткими */
      box-shadow: var(--shadow-img) !important;
      /* Жёстко отключаем любые анимации/переходы */
      transition: none !important;
      transform: none !important;
    }

    /* Сама картинка — статичная, без теней и переходов */
    #about .photo-frame img {
      display: block;
      width: 100%;
      height: auto;
      border: 0 !important;
      border-radius: 0;
      background: transparent !important;
      box-shadow: none !important;
      transition: none !important;
      transform: none !important;
    }

    /* Мобильная адаптация */
    @media (max-width: 768px) {
      #about.about-section { padding: 40px 15px; }
      #about .about-container { gap: 20px; flex-direction: column; }
      #about .about-text h2 { font-size: 22px; }
      #about .about-text p { font-size: 14px; line-height: 1.5; }
      #about .about-image { flex: 0 0 auto; }
      #about .photo-frame { max-width: var(--img-w-mobile); }
    }
  </style> <div class="about-container"> <div class="about-text"> <h2>Обо мне</h2> <p>Привет! Я – Яна, очень рада видеть вас на нашей уютной страничке!</p> <p>В начале 2021 года я начала изготавливать свечи, затем ко мне присоединилась моя мама, и сегодня мы вместе создаём не только свечи, но ещё и духи в самых разных форматах. За это время мы провели десятки экспериментов и тестов, поэтому наши свечи горят долго, наполняют комнату ароматом за считанные минуты, а парфюм раскрывается многослойно и держится на коже часами.</p> <p>Многие наши ароматы универсальны – они подходят как девушкам, так и мужчинам. Мы используем качественные ароматы и соевый воск производства США, внимательно подбираем косметические составляющие для духов и заботимся о безопасности нашей продукции.</p> </div> <figure class="about-image"> <div class="photo-frame" aria-hidden="false"> <img
          src="https://static.tildacdn.com/tild3661-6336-4538-b138-306238343438/IMG_7436.jpg"
          alt="Яна — основатель Home Secret Shop"
          loading="lazy"
          decoding="async"
          fetchpriority="low"
        > </div> </figure> </div> </section> <!-- nominify end --> </div> </div> </div> </div> <div id="rec1223335531" class="r t-rec" style=" " data-animationappear="off" data-record-type="131"> <!-- T123 --> <div class="t123"> <div class="t-container_100 "> <div class="t-width t-width_100 "> <!-- nominify begin --> <!-- BLOCK 8: Reviews — 11 отзывов, адаптивная пагинация (1 на мобиле, 3 на десктопе) --> <section class="reviews-section" id="reviews"> <div class="section-title-container"> <h2 class="reviews-title">Ваши отзывы</h2> </div> <div class="reviews-nav" aria-label="Навигация по страницам отзывов"> <button class="review-nav-btn prev-review" aria-label="Предыдущая страница">&#10094;</button> <button class="review-nav-btn next-review" aria-label="Следующая страница">&#10095;</button> </div> <div class="reviews-container"> <!-- ===== 11 отзывов (атрибут data-page не используется логикой) ===== --> <div class="review" data-page="1"> <div class="review-content"> <div class="review-meta"> <img class="review-avatar" src="https://static.tildacdn.com/tild3431-3863-4461-b235-333063623136/user530030178_ava_ma.jpg" alt="千子 五十嵐"> <div class="review-name">千子 五十嵐</div> </div> <div class="review-stars" aria-label="Оценка: 5 из 5"> <svg class="star"><use href="#rev-star" xlink:href="#rev-star"/></svg><svg class="star"><use href="#rev-star" xlink:href="#rev-star"/></svg><svg class="star"><use href="#rev-star" xlink:href="#rev-star"/></svg><svg class="star"><use href="#rev-star" xlink:href="#rev-star"/></svg><svg class="star"><use href="#rev-star" xlink:href="#rev-star"/></svg> </div> <h4 class="review-h">Достоинства</h4> <p>Уникальные ароматы, стойкие, удобно брать с собой.</p> <h4 class="review-h">Общие впечатления о товаре</h4> <p>Уже в третий раз покупаю ваши духи в «Полке Чудес» и 100% буду брать ещё! Флакона хватает надолго. Мои фавориты сейчас — «Груша в бренди» и «Розовые кристаллы».</p> </div> </div> <div class="review" data-page="1"> <div class="review-content"> <div class="review-meta"> <img class="review-avatar" src="https://static.tildacdn.com/tild3264-3864-4461-b764-633164373162/user554525032_ava_ma.jpg" alt="Ежевичное Мороженое"> <div class="review-name">Ежевичное Мороженое</div> </div> <div class="review-stars" aria-label="Оценка: 5 из 5"> <svg class="star"><use href="#rev-star"/></svg><svg class="star"><use href="#rev-star"/></svg><svg class="star"><use href="#rev-star"/></svg><svg class="star"><use href="#rev-star"/></svg><svg class="star"><use href="#rev-star"/></svg> </div> <h4 class="review-h">Достоинства</h4> <p>Потрясающие духи — ароматные и стойкие.</p> <h4 class="review-h">Общие впечатления о товаре</h4> <p>Забрала «Морская соль и орхидея» и «Мох и папоротник» из офлайн-точки в Мск — «Полка Чудес». Обязательно попробую ещё ароматы этого автора!</p> </div> </div> <div class="review" data-page="1"> <div class="review-content"> <div class="review-meta"> <img class="review-avatar" src="https://static.tildacdn.com/tild3336-3961-4261-a234-663830356336/user279927835_ava_ma.jpg" alt="Анна Яшмолкина"> <div class="review-name">Анна Яшмолкина</div> </div> <div class="review-stars" aria-label="Оценка: 5 из 5"> <svg class="star"><use href="#rev-star"/></svg><svg class="star"><use href="#rev-star"/></svg><svg class="star"><use href="#rev-star"/></svg><svg class="star"><use href="#rev-star"/></svg><svg class="star"><use href="#rev-star"/></svg> </div> <h4 class="review-h">Достоинства</h4> <p>Продуманная пирамида.</p> <h4 class="review-h">Общие впечатления о товаре</h4> <p>«Розовое шампанское» — яркая роза, потом уходит в тонкий нежный аромат. Спасибо за это чудо!</p> </div> </div> <div class="review" data-page="2"> <div class="review-content"> <div class="review-meta"> <img class="review-avatar" src="https://static.tildacdn.com/tild3539-3765-4637-a466-393838383964/user289086239_ava_ma.jpg" alt="Маргарита Файзулоева"> <div class="review-name">Маргарита Файзулоева</div> </div> <div class="review-stars" aria-label="Оценка: 5 из 5"> <svg class="star"><use href="#rev-star"/></svg><svg class="star"><use href="#rev-star"/></svg><svg class="star"><use href="#rev-star"/></svg><svg class="star"><use href="#rev-star"/></svg><svg class="star"><use href="#rev-star"/></svg> </div> <h4 class="review-h">Достоинства</h4> <p>Вкуснейшие духи, аромат держится несколько часов, расход небольшой.</p> <h4 class="review-h">Общие впечатления о товаре</h4> <p>Почувствовала его на подруге и сразу приобрела себе. Пусть весь мир пахнет виноградом!</p> </div> </div> <div class="review" data-page="2"> <div class="review-content"> <div class="review-meta"> <img class="review-avatar" src="https://static.tildacdn.com/tild3466-6533-4261-a561-366132353037/user13216166_ava_max.jpg" alt="Наталья Родионова"> <div class="review-name">Наталья Родионова</div> </div> <div class="review-stars" aria-label="Оценка: 5 из 5"> <svg class="star"><use href="#rev-star"/></svg><svg class="star"><use href="#rev-star"/></svg><svg class="star"><use href="#rev-star"/></svg><svg class="star"><use href="#rev-star"/></svg><svg class="star"><use href="#rev-star"/></svg> </div> <h4 class="review-h">Достоинства</h4> <p>Ароматы — выше ожиданий.</p> <h4 class="review-h">Общие впечатления о товаре</h4> <p>После нишевой парфюмерии не ожидала таких шикарных композиций. Любовь с первого вздоха!</p> </div> </div> <div class="review" data-page="2"> <div class="review-content"> <div class="review-meta"> <img class="review-avatar" src="https://static.tildacdn.com/tild3435-3265-4139-a565-323030653738/user555958255_ava_ma.jpg" alt="Вера Малухина"> <div class="review-name">Вера Малухина</div> </div> <div class="review-stars" aria-label="Оценка: 5 из 5"> <svg class="star"><use href="#rev-star"/></svg><svg class="star"><use href="#rev-star"/></svg><svg class="star"><use href="#rev-star"/></svg><svg class="star"><use href="#rev-star"/></svg><svg class="star"><use href="#rev-star"/></svg> </div> <h4 class="review-h">Достоинства</h4> <p>Вкусный аромат, очень жизнерадостный! Быстрая доставка.</p> <h4 class="review-h">Общие впечатления о товаре</h4> <p>Сухие духи «Заснеженный можжевельник». Поднимают настроение. Спасибо!</p> </div> </div> <div class="review" data-page="3"> <div class="review-content"> <div class="review-meta"> <img class="review-avatar" src="https://static.tildacdn.com/tild3239-3431-4964-b063-373433663034/user356651681_ava_20.jpg" alt="Диана Шушакова"> <div class="review-name">Диана Шушакова</div> </div> <div class="review-stars" aria-label="Оценка: 5 из 5"> <svg class="star"><use href="#rev-star"/></svg><svg class="star"><use href="#rev-star"/></svg><svg class="star"><use href="#rev-star"/></svg><svg class="star"><use href="#rev-star"/></svg><svg class="star"><use href="#rev-star"/></svg> </div> <h4 class="review-h">Достоинства</h4> <p>Долгая стойкость на коже, отличное соотношение цена/качество, бережная доставка и приятный сервис.</p> <h4 class="review-h">Общие впечатления о товаре</h4> <p>Я и мой мч в восторге от этих ароматов!! Долго держатся на коже, за такую цену просто находка. Каждый нашел свой аромат, для него — «Груша в бренди», для меня — «Персиковый нектар». Заметила, что на мужчинах «Груша в бренди» невероятно приятно раскрывается, на девушках чуть по-другому (все индивидуально, просто мое наблюдение ????). Свечка-малышка запала в самое сердце, с ароматом не прогадала — в комнате пахнет как в пекарне. Спасибо за сервис, бережную доставку и конфетки ????????</p> </div> </div> <!-- Новый отзыв: Арина Рожкова --> <div class="review" data-page="3"> <div class="review-content"> <div class="review-meta"> <img class="review-avatar" src="https://static.tildacdn.com/tild6261-6134-4536-b839-666632373262/00.jpg" alt="Арина Рожкова"> <div class="review-name">Арина Рожкова</div> </div> <div class="review-stars" aria-label="Оценка: 5 из 5"> <svg class="star"><use href="#rev-star"/></svg><svg class="star"><use href="#rev-star"/></svg><svg class="star"><use href="#rev-star"/></svg><svg class="star"><use href="#rev-star"/></svg><svg class="star"><use href="#rev-star"/></svg> </div> <h4 class="review-h">Достоинства</h4> <p>Упаковка и доставка без повреждений, милые вложения, душевный сервис.</p> <h4 class="review-h">Общие впечатления о товаре</h4> <p>Забрала посылочку, всё приехало в целости и сохранности, отдельное спасибо за конфетки и картиночки) Ароматы невероятные, как всегда! Ранее брала в «Полке чудес» ваш «Египетский янтарь», не могу перестать наслаждаться им. Теперь приобрела на подарок другие ароматы. Спасибо большое за ваш труд — очень давно искала духи, которые не просто передают аромат, а несут что-то особенное, уютное, сделанное с душой! Это про вас и ваш товар!</p> </div> </div> <!-- Новый отзыв: Галина Логунова --> <div class="review" data-page="3"> <div class="review-content"> <div class="review-meta"> <img class="review-avatar" src="https://static.tildacdn.com/tild3864-3134-4636-b633-316137316163/01.jpg" alt="Галина Логунова"> <div class="review-name">Галина Логунова</div> </div> <div class="review-stars" aria-label="Оценка: 5 из 5"> <svg class="star"><use href="#rev-star"/></svg><svg class="star"><use href="#rev-star"/></svg><svg class="star"><use href="#rev-star"/></svg><svg class="star"><use href="#rev-star"/></svg><svg class="star"><use href="#rev-star"/></svg> </div> <h4 class="review-h">Достоинства</h4> <p>Редкий характерный аромат без лишней сладости, глубокое раскрытие, атмосферность.</p> <h4 class="review-h">Общие впечатления о товаре</h4> <p>Здравствуйте, я купила ваши прекрасные масляные духи «Мох и папоротник». И я влюблена! Нечасто получается найти аромат, который не несёт в себе печать парфюмерной основы — горькой или слишком сладкой. Здесь его нет совершенно: этот аромат как история, он за руку проводит по влажному туманному лесу, провожает в ветхую избушку из потемневших бревен и оставляет на деревянном полу среди пыльных старых книжек. Я очень давно хотела себе такой лесной, немного хтонический аромат. Это просто чудо — теперь хочется постепенно собирать коллекцию ваших работ. Вы гений ароматов, спасибо вам, что дарите сказку.</p> </div> </div> <!-- ЕДИНЫЙ ЭТАЛОН ЗВЕЗДЫ --> <svg width="0" height="0" style="position:absolute;visibility:hidden" aria-hidden="true" focusable="false"> <defs> <symbol id="rev-star" viewBox="0 0 24 24"> <path d="M12 17.27L18.18 21L16.54 13.97L22 9.24L14.81 8.63L12 2L9.19 8.63L2 9.24L7.46 13.97L5.82 21L12 17.27Z" fill="currentColor"/> </symbol> </defs> </svg> </section> <style>
  /* Убираем внешний «большой квадрат», оставляем только внутренние карточки */
  #reviews .review{ background:transparent!important; border:0!important; box-shadow:none!important; padding:0!important; }
  /* Сетка: 1 карта на мобиле, 3 на ≥900px */
  #reviews .reviews-container{ display:grid; grid-template-columns:1fr; gap:16px; }
  @media (min-width: 900px){ #reviews .reviews-container{ grid-template-columns:repeat(3,1fr); } }
  #reviews .review[hidden]{ display:none!important; }

  /* Внутренняя карточка */
  #reviews .review-content{
    background:#fff; border:1px solid #E8DED4; border-radius:14px; box-shadow:0 8px 20px rgba(0,0,0,.06);
    padding:14px; height:100%;
  }
  #reviews .review-meta{ display:flex; align-items:center; gap:10px; margin-bottom:6px; }
  #reviews .review-avatar{ width:40px; height:40px; border-radius:50%; object-fit:cover; border:1px solid #E8DED4; background:#F4EEE6; display:block; }
  #reviews .review-name{ font-weight:700; font-size:15px; color:#000; }

  #reviews .review-stars{ display:flex; gap:6px; margin:6px 0 8px; line-height:0; color:#C4A484; }
  #reviews .review-stars .star{ width:18px; height:18px; display:inline-block; vertical-align:middle; pointer-events:none; shape-rendering:geometricPrecision; }

  #reviews .review-h{ margin:8px 0 4px; font-size:12.5px; color:#816856; font-weight:600; letter-spacing:.02em; }
  #reviews .review-content p{ margin:0 0 8px; font-size:14px; line-height:1.55; color:#000; }

  #reviews .review-nav-btn[disabled]{ opacity:.45; cursor:not-allowed; }

  /* Нормализация стиля текста внутри блока */
  #reviews, #reviews .reviews-title, #reviews .review-content, #reviews .review-content p, #reviews .review-h, #reviews .review-name{ font-style:normal!important; }
</style> <script>
/* Адаптивная пагинация: на мобиле 1 отзыв/страница, на десктопе 3 */
(function(){
  var root = document.getElementById('reviews');
  if (!root) return;

  var prev = root.querySelector('.prev-review');
  var next = root.querySelector('.next-review');
  var cards = Array.prototype.slice.call(root.querySelectorAll('.review'));

  function itemsPerPage(){
    return window.matchMedia('(min-width: 900px)').matches ? 3 : 1;
  }

  var ipp = itemsPerPage();
  var current = 1;
  var pages = Math.max(1, Math.ceil(cards.length / ipp));

  function render(){
    ipp = itemsPerPage();
    pages = Math.max(1, Math.ceil(cards.length / ipp));
    if (current > pages) current = pages;

    var start = (current - 1) * ipp;
    var end = start + ipp;

    cards.forEach(function(card, i){
      card.hidden = !(i >= start && i < end);
    });

    if (prev) prev.disabled = current === 1;
    if (next) next.disabled = current === pages;
  }

  function go(delta){
    var nextPage = current + delta;
    if (nextPage < 1 || nextPage > pages) return;
    current = nextPage;
    render();
  }

  if (prev) prev.addEventListener('click', function(){ go(-1); });
  if (next) next.addEventListener('click', function(){ go(1); });

  /* Пересчёт при ресайзе/смене ориентации */
  var t;
  window.addEventListener('resize', function(){
    clearTimeout(t); t = setTimeout(render, 120);
  });
  window.addEventListener('orientationchange', render);

  /* Небольшой свайп на мобиле */
  var touchX = null;
  root.addEventListener('touchstart', function(e){ touchX = (e.touches && e.touches[0]) ? e.touches[0].clientX : null; }, {passive:true});
  root.addEventListener('touchend', function(e){
    if (touchX == null) return;
    var dx = e.changedTouches[0].clientX - touchX;
    if (Math.abs(dx) > 40){ dx < 0 ? go(1) : go(-1); }
    touchX = null;
  }, {passive:true});

  render(); // старт
})();
</script> <!-- nominify end --> </div> </div> </div> </div> <div id="rec1275678221" class="r t-rec" style=" " data-animationappear="off" data-record-type="131"> <!-- T123 --> <div class="t123"> <div class="t-container_100 "> <div class="t-width t-width_100 "> <!-- nominify begin --> <style id="hs-aroma-tight-v4">
  :root{ --hs-brand:#816856; --hs-cream:#E8DED4; --hs-accent:#F5E7D8; }

  /* Яркое, но аккуратное выделение кнопки "Выберите аромат" */
  .hs-cta-boost{
    display:inline-flex !important; align-items:center; justify-content:center;
    padding:12px 16px; border-radius:14px;
    background:linear-gradient(180deg, var(--hs-accent), #fff) !important;
    color:#3a2f2a !important; border:2px solid var(--hs-brand) !important;
    text-decoration:none !important; box-shadow:0 10px 26px rgba(0,0,0,.10);
    transition:transform .15s ease, box-shadow .15s ease, background-color .15s ease;
  }
  .hs-cta-boost:hover{ transform:translateY(-1px); box-shadow:0 14px 34px rgba(0,0,0,.16); }
  .hs-cta-boost:active{ transform:translateY(0); }
</style> <script id="hs-aroma-tight-v4">
(function(){
  if (window.HS_AromaTightV4) return; window.HS_AromaTightV4 = true;

  const SHIFT_TITLE = 24;   // на сколько пикселей поднять заголовок
  const SHIFT_LABEL = 14;   // на сколько пикселей поднять подпись "Выберите аромат:"
  const BRAND = getComputedStyle(document.documentElement).getPropertyValue('--hs-brand') || '#816856';

  const txt = el => (el && (el.textContent || el.innerText) || '').trim();
  const isZero = el => !!(el && el.closest('.t396__artboard'));
  const imp = (el, prop, val) => { try{ el && el.style && el.style.setProperty(prop, String(val), 'important'); }catch(_){} };

  // Сдвиг элемента в Zero-block: корректируем top и data-* поля под разные брейкпоинты
  function shiftT396Up(el, px){
    const tn = el.closest('.tn-elem') || el.closest('[data-elem-id]');
    if (!tn || tn.dataset.hsShiftApplied) return;
    const keys = Object.keys(tn.dataset).filter(k=>/^fieldTop/.test(k)); // fieldTopValue, fieldTopRes960Value...
    keys.forEach(k=>{
      const v = parseFloat(tn.dataset[k]); if (isFinite(v)) tn.dataset[k] = String(Math.max(0, v - px));
    });
    // inline top
    const curTop = parseFloat((tn.style.top||'').replace('px',''));
    if (isFinite(curTop)) tn.style.top = Math.max(0, curTop - px) + 'px';
    tn.dataset.hsShiftApplied = '1';
  }

  function tightenTitle(rec){
    const title = Array.from(rec.querySelectorAll('h1,h2,h3,.section-title,.tn-atom'))
      .find(el => /как выбрать аромат/i.test(txt(el)));
    if (!title) return;
    if (isZero(title)) {
      shiftT396Up(title, SHIFT_TITLE);
    } else {
      imp(title, 'margin-top', '0px');
      imp(title, 'padding-top', '0px');
      // если у контейнера сверху большой паддинг — подрежем
      const cont = title.closest('.t-container, .container, .wrap, section, .t-rec') || rec;
      if (cont){
        const pt = parseInt(getComputedStyle(cont).paddingTop)||0;
        if (pt>0) imp(cont, 'padding-top', Math.max(10, Math.round(pt*0.5)) + 'px');
      }
    }
  }

  function tightenLabel(rec){
    const label = Array.from(rec.querySelectorAll('label, .t-input-title, .label, .tn-atom, p, span, .form__label'))
      .find(el => /выберите\s*аромат:?/i.test(txt(el)));
    if (!label) return;
    if (isZero(label)){
      shiftT396Up(label, SHIFT_LABEL);
    } else {
      imp(label, 'margin-top', '2px');
      // подожмём обёртку селекта
      const wrap = label.parentElement || label.closest('.t-input, .form-group, .select-wrap');
      if (wrap){
        const mt = parseInt(getComputedStyle(wrap).marginTop)||0;
        if (mt>0) imp(wrap, 'margin-top', Math.max(4, Math.round(mt*0.5)) + 'px');
      }
    }
    // подстветка самого select до выбора
    const select = rec.querySelector('select[aria-label*="ромат" i], select[data-label*="ромат" i], select[name*="aroma" i]');
    if (select){
      const need = !select.value || select.selectedIndex===0 || ((select.options[select.selectedIndex]||{}).disabled===true);
      if (need) imp(select, 'outline', `2px solid ${BRAND}`);
      select.addEventListener('change', ()=>{
        const empty = !select.value || select.selectedIndex===0 || ((select.options[select.selectedIndex]||{}).disabled===true);
        imp(select, 'outline', empty ? `2px solid ${BRAND}` : 'none');
      });
    }
  }

  function boostCTA(rec){
    // найдём кнопку/ссылку с текстом "Выберите аромат"
    const cta = Array.from(rec.querySelectorAll('a,button,[role="button"],.t-btn,.btn,.tn-atom'))
      .find(el => /выберите\s*аромат/i.test(txt(el)));
    if (!cta) return;
    // если это tn-atom внутри Zero-block — стилизуем сам .tn-atom
    cta.classList.add('hs-cta-boost');
    imp(cta, 'z-index', 1000);
  }

  function compactRecord(rec){
    const recWrap = rec.closest('.t-rec') || rec;
    imp(recWrap, 'padding-top', '20px');
    // немного подрежем нижний воздух, чтобы блок стал компактнее
    imp(recWrap, 'padding-bottom', '20px');
  }

  function findAromaRec(){
    // сначала по id/классам
    let rec = document.querySelector('#aroma-block, .aroma-block, .scent-block, [data-block="aroma"]');
    if (rec) return rec;
    // затем по заголовку
    const h = Array.from(document.querySelectorAll('h1,h2,h3,.section-title,.tn-atom'))
      .find(el => /как выбрать аромат/i.test(txt(el)));
    return h ? (h.closest('.t-rec') || h.closest('section') || h.parentElement) : null;
  }

  function run(){
    const rec = findAromaRec();
    if (!rec) return;
    compactRecord(rec);
    tightenTitle(rec);
    tightenLabel(rec);
    boostCTA(rec);
  }

  if (document.readyState !== 'loading') run();
  document.addEventListener('DOMContentLoaded', run);
  new MutationObserver(run).observe(document.body, { childList:true, subtree:true });
})();
</script> <!-- nominify end --> </div> </div> </div> </div> <div id="rec1306207571" class="r t-rec" style=" " data-animationappear="off" data-record-type="131"> <!-- T123 --> <div class="t123"> <div class="t-container_100 "> <div class="t-width t-width_100 "> <!-- nominify begin --> <style id="hsCutFooterGap">
  /* 1) базовые перекрытия хвостов */
  html, body{ background:#fff; }                 /* чтобы фон Tilda не «просвечивал» */
  #allrecords, .t-records{ padding-bottom:0 !important; }
  #allrecords::after, .t-records::after{ display:none !important; }

  /* последний ВИДИМЫЙ блок — без внутренних хвостов и без схлопывания */
  .t-records .t-rec:last-of-type{
    margin-bottom:0 !important;
    padding-bottom:0 !important;
    display:flow-root;
  }
  .t-records .t-rec:last-of-type .t-container,
  .t-records .t-rec:last-of-type .t-row,
  .t-records .t-rec:last-of-type .t-col{
    margin-bottom:0 !important; padding-bottom:0 !important;
  }
  /* Zero-block внутри футера */
  .t-records .t-rec:last-of-type .t396__artboard,
  .t-records .t-rec:last-of-type .t396__carrier,
  .t-records .t-rec:last-of-type .t396__filter{
    min-height:auto !important;
    padding-bottom:0 !important;
    margin-bottom:0 !important;
  }

  /* 2) динамическая «подтяжка» низа (#allrecords тянем отрицательным margin) */
  #allrecords{ --hs-bottom-pull:0px; margin-bottom:var(--hs-bottom-pull) !important; }
</style> <script id="hsCutFooterGapJS">
(function(){
  function getLastVisibleRec(){
    var recs = document.querySelectorAll('.t-records .t-rec');
    for (var i = recs.length - 1; i >= 0; i--){
      var r = recs[i], cs = getComputedStyle(r);
      if (cs.display !== 'none' && cs.visibility !== 'hidden' && r.offsetHeight > 0) return r;
    }
    return null;
  }

  function fixZeroBlockInside(rec){
    var art = rec && rec.querySelector('.t396__artboard');
    if (!art) return;
    // убираем «резиновую» высоту
    art.style.minHeight = 'auto';
    art.style.height = 'auto';
    ['paddingBottom','marginBottom'].forEach(function(p){ art.style[p] = '0'; });
  }

  function pullBottom(){
    var all = document.getElementById('allrecords') || document.querySelector('.t-records');
    if (!all) return;

    // сброс предыдущего подтягивания
    all.style.setProperty('--hs-bottom-pull', '0px');

    var last = getLastVisibleRec();
    if (!last) return;

    // подправим Zero-block, если он и даёт высоту
    fixZeroBlockInside(last);

    // считаем реальный «лишний» зазор
    var lastRect = last.getBoundingClientRect();
    var lastBottom = lastRect.bottom + window.scrollY;
    var docHeight = Math.max(
      document.body.scrollHeight, document.documentElement.scrollHeight,
      document.body.offsetHeight, document.documentElement.offsetHeight,
      document.body.clientHeight, document.documentElement.clientHeight
    );

    var gap = Math.round(docHeight - lastBottom);
    // допустимый диапазон «хвоста»: от 24 до 800px (чтобы не трогать нормальные страницы)
    if (gap >= 24 && gap <= 800){
      all.style.setProperty('--hs-bottom-pull', (-gap) + 'px');
    }
  }

  var raf;
  function schedule(){ cancelAnimationFrame(raf); raf = requestAnimationFrame(pullBottom); }

  // запуск
  if (document.readyState !== 'loading') schedule();
  else document.addEventListener('DOMContentLoaded', schedule);

  // пересчёт при изменении размеров/контента
  window.addEventListener('load', schedule);
  window.addEventListener('resize', schedule);
  // если Tilda/скрипты что-то подгрузили позже
  var mo = new MutationObserver(function(){ schedule(); });
  mo.observe(document.documentElement, { childList:true, subtree:true, attributes:true, attributeFilter:['style','class'] });
})();
</script> <!-- БЕЖЕВЫЙ ТОН ПОДТЯГИВАЕМ ИЗ САЙТА (КАРУСЕЛЬ/ТОВАРЫ) --> <style id="hsBeigeSections">
  :root{ --hs-beige:auto; } /* значение поставит JS ниже */

  /* помеченные секции будут сплошь бежевые */
  .t-records .t-rec.hs-beige-block{
    background:var(--hs-beige) !important;
  }
  .t-records .t-rec.hs-beige-block::after{ display:none !important; }
  .t-records .t-rec.hs-beige-block .t-container,
  .t-records .t-rec.hs-beige-block .t-row,
  .t-records .t-rec.hs-beige-block .t-col{
    background:transparent !important;
    margin-bottom:0 !important; padding-bottom:0 !important;
  }

  /* Zero-block внутри секции — убираем белые подложки/хвосты */
  .t-records .t-rec.hs-beige-block .t396__artboard,
  .t-records .t-rec.hs-beige-block .t396__carrier,
  .t-records .t-rec.hs-beige-block .t396__filter{
    background:transparent !important;
    min-height:auto !important; height:auto !important;
    margin-bottom:0 !important; padding-bottom:0 !important;
  }
</style> <script id="hsBeigeSectionsJS">
(function(){
  /* ==== 1) Достаём ТОЧНЫЙ бежевый из существующих блоков ==== */
  function isTransparent(c){
    return !c || c === 'transparent' || c === 'rgba(0, 0, 0, 0)';
  }
  function isTooWhite(rgb){
    // отсеиваем белый/почти белый (карточки, контейнеры)
    var m = rgb && rgb.match(/rgba?\((\d+),\s*(\d+),\s*(\d+)/i);
    if(!m) return false;
    var r=+m[1], g=+m[2], b=+m[3];
    return (r>=245 && g>=245 && b>=245);
  }
  function firstNonTransparentBg(el){
    if(!el) return null;
    var seen = 0, q=[el];
    while(q.length && seen<800){ // ограничим обход
      var n = q.shift(); seen++;
      var cs = getComputedStyle(n);
      var bg = cs.backgroundColor;
      if(!isTransparent(bg) && !isTooWhite(bg)) return bg;
      // добавляем детей
      for(var i=0;i<n.children.length;i++) q.push(n.children[i]);
    }
    return null;
  }
  function pickSiteBeige(){
    var candidates = [
      // приоритет: товары
      '#products-block-4','.products-section',
      // карусель (варианты классов из проекта)
      '.carousel-container','#carousel','.hs-c3',
      // любые секции с похожими id
      '#how-to-choose','#choose-scent','#hs-choose'
    ];
    for(var i=0;i<candidates.length;i++){
      var el = document.querySelector(candidates[i]);
      if(!el) continue;
      // пробуем сам блок
      var bg = getComputedStyle(el).backgroundColor;
      if(!isTransparent(bg) && !isTooWhite(bg)) return bg;
      // пробуем найти внутри
      bg = firstNonTransparentBg(el);
      if(bg) return bg;
    }
    // запасной вариант: ищем по заголовкам «товары»/«как выбрать аромат»
    var heads = document.querySelectorAll('h1,h2,h3,.section-title,.t-title,.t-name,.tn-atom');
    for(var j=0;j<heads.length;j++){
      var t=(heads[j].textContent||'').trim().toLowerCase();
      if(!t) continue;
      if(t.includes('товар') || t.includes('как выбрать аромат') || t.includes('карусел')){
        var rec = heads[j].closest('.t-rec');
        if(rec){
          var bg2 = getComputedStyle(rec).backgroundColor;
          if(!isTransparent(bg2) && !isTooWhite(bg2)) return bg2;
          bg2 = firstNonTransparentBg(rec);
          if(bg2) return bg2;
        }
      }
    }
    return null; // если не нашли — оставим как есть
  }

  /* ==== 2) Помечаем нужные секции под этот бежевый ==== */
  function recOf(el){ return el && el.closest ? el.closest('.t-rec') : null; }
  function markBeige(rec){
    if(!rec || rec.classList.contains('hs-beige-block')) return;
    rec.classList.add('hs-beige-block');
  }
  function apply(){
    var beige = pickSiteBeige();
    if(beige){
      document.documentElement.style.setProperty('--hs-beige', beige);
    }
    // отмечаем целевые секции
    ['products-block-4','reviews','choose-scent','how-to-choose','hs-choose']
      .forEach(function(id){
        var el = document.getElementById(id);
        if(el) markBeige(recOf(el) || el);
      });
    // и по текстам на случай других id
    var heads = document.querySelectorAll('h1,h2,h3,.section-title,.t-title,.t-name,.tn-atom');
    heads.forEach(function(h){
      var t = (h.textContent||'').trim().toLowerCase();
      if(!t) return;
      if(t.includes('как выбрать аромат') || t.includes('ваши отзывы') || t.includes('товар')){
        markBeige(recOf(h));
      }
    });
  }

  var raf; function schedule(){ cancelAnimationFrame(raf); raf=requestAnimationFrame(apply); }
  if(document.readyState!=='loading') schedule();
  else document.addEventListener('DOMContentLoaded', schedule);
  window.addEventListener('load', schedule);
  new MutationObserver(schedule).observe(document.documentElement,{
    subtree:true, childList:true, attributes:true, attributeFilter:['class','style']
  });
})();
</script> <!-- nominify end --> </div> </div> </div> </div> <div id="rec1544589761" class="r t-rec t-rec_pt_90 t-rec_pb_90" style="padding-top:90px;padding-bottom:90px; " data-animationappear="off" data-record-type="670"> <!-- T670 --> <div class="t670"> <div class="t-slds" style="visibility: hidden;"> <div class="t-container t-slds__main"> <ul class="t-slds__arrow_container t-slds__arrow_container-outside"> </ul> <div class="t-slds__container t-width t-width_9 t-margin_auto"> <div class="t-slds__items-wrapper t-slds__witharrows t-slds_animated-none"
id="carousel_1544589761" data-slider-transition="300" data-slider-with-cycle="true" data-slider-correct-height="true" data-auto-correct-mobile-width="false" data-slider-arrows-nearpic="yes" 
aria-roledescription="carousel"
aria-live="off"> </div> </div> <ul class="t-slds__bullet_wrapper"> </ul> <div class="t-slds__caption__container"> </div> </div> </div> </div> <script>t_onReady(function() {t_onFuncLoad('t670_init',function() {t670_init('1544589761',false);});});</script> <style>#rec1544589761 .t-slds__bullet_active .t-slds__bullet_body{background-color:#222 !important;}#rec1544589761 .t-slds__bullet:hover .t-slds__bullet_body{background-color:#222 !important;}</style> </div> <!--footer--> <footer id="t-footer" class="t-records" data-hook="blocks-collection-content-node" data-tilda-project-id="13964339" data-tilda-page-id="78809716" data-tilda-page-alias="footer" data-tilda-formskey="d1121d4f8ed8b2217d3e700d13964339" data-tilda-cookie="no" data-tilda-lazy="yes" data-tilda-project-lang="RU" data-tilda-root-zone="com" data-tilda-project-country="RU"> <div id="rec1317563911" class="r t-rec" style=" " data-animationappear="off" data-record-type="131"> <!-- T123 --> <div class="t123"> <div class="t-container_100 "> <div class="t-width t-width_100 "> <!-- nominify begin --> <!-- FOOTER — компактная адаптивная версия без горизонтального скролла --> <style>
  .hs-footer{
    --fg:#000;
    --line:rgba(0,0,0,.08);

    background:#fff;
    color:var(--fg);
    padding:32px 20px 26px;
    font-size:13px;
    line-height:1.45;
    border-top:1px solid var(--line);
  }

  .hs-footer a{
    color:var(--fg) !important;
    text-decoration:none;
  }
  .hs-footer a:hover{
    opacity:.75;
  }

  .hs-footer .wrap{
    max-width:920px;
    margin:0 auto;
  }

  .hs-footer .top{
    display:grid;
    grid-template-columns:1fr auto 1fr;
    gap:16px;
    align-items:flex-start;
  }

  .hs-footer .company{
    display:flex;
    flex-direction:column;
    gap:4px;
    font-size:12px;
    color:rgba(0,0,0,.55);
    text-align:left;
    align-items:flex-start;
    font-variant-numeric:tabular-nums;
  }
  .hs-footer .company-line{
    display:block;
    padding:0;
    margin:0;
    line-height:1.45;
  }
  .hs-footer .company strong{
    font-weight:600;
  }

  .hs-footer .center{
    grid-column:2;
    display:flex;
    flex-direction:column;
    align-items:center;
    gap:10px;
  }
  .hs-footer .brand{
    font-weight:600;
    letter-spacing:.04em;
    text-transform:uppercase;
    font-size:13px;
  }

  .hs-footer .soc{
    display:flex;
    gap:12px;
    justify-content:center;
  }
  .hs-footer .soc a{
    width:40px;
    height:40px;
    border-radius:999px;
    border:1px solid var(--line);
    display:flex;
    align-items:center;
    justify-content:center;
    font-size:18px;
  }

  .hs-footer .menu{
    display:flex;
    flex-direction:column;
    gap:6px;
    font-size:13px;
    text-align:right;
    align-items:flex-end;
  }

  .hs-footer .bottom{
    margin-top:18px;
    padding-top:10px;
    border-top:1px solid var(--line);
    display:flex;
    align-items:center;
    justify-content:space-between;
    gap:10px;
    flex-wrap:wrap;
    font-size:12px;
    color:rgba(0,0,0,.6);
  }
  .hs-footer .bottom-left{
    display:flex;
    flex-direction:column;
    gap:4px;
  }
  .hs-footer .bottom-right{
    text-align:right;
  }

  .hs-footer .disclaimer{
    max-width:920px;
    margin:14px auto 0;
    text-align:center;
    font-size:11px;
    color:rgba(0,0,0,.45);
    line-height:1.3;
  }

  @media (max-width:900px){
    .hs-footer{
      font-size:12.5px;
      padding:24px 16px 18px;
    }
    .hs-footer .top{
      grid-template-columns:1fr;
      text-align:center;
      gap:14px;
    }
    .hs-footer .center{
      grid-column:1;
    }
    .hs-footer .company{
      align-items:center;
      text-align:center;
    }
    .hs-footer .menu{
      align-items:center;
      text-align:center;
    }
    .hs-footer .bottom{
      justify-content:center;
      text-align:center;
    }
  }
</style> <footer class="hs-footer" id="contacts" aria-label="Футер сайта Home Secret Shop"> <div class="wrap"> <div class="top"> <!-- Реквизиты --> <div class="company" aria-label="Реквизиты компании"> <div class="company-line"><strong>ИП Ларионов Александр Сергеевич</strong></div> <div class="company-line">ИНН 540303178088</div> <div class="company-line">ОГРНИП 322547600081374</div> <div class="company-line">г. Новосибирск</div> </div> <!-- Центр: соцсети (бренд убран) --> <div class="center"> <!-- бренд убран по запросу --> <div class="soc" aria-label="Социальные сети"> <a href="https://vk.com/home_secret" target="_blank" rel="noopener noreferrer" aria-label="ВКонтакте"> <i class="fa-brands fa-vk"></i> </a> <!-- иконка Telegram удалена по запросу --> <a href="https://www.instagram.com/home_secret.shop" target="_blank" rel="noopener noreferrer" aria-label="Instagram*"> <i class="fa-brands fa-instagram"></i> </a> </div> </div> <!-- Правый столбец: меню --> <nav class="menu" aria-label="Навигация в футере"> <a href="/page72607081.html#products">Каталог</a> <a href="/page74272711.html">FAQ</a> <a href="/page74276531.html">Наши магазины</a> <a href="/page74277625.html">Доставка и оплата</a> </nav> </div> <!-- Нижняя полоса --> <div class="bottom"> <div class="bottom-left"> <div class="company-line">E-mail: <a href="mailto:home.secret.shopp@gmail.com">home.secret.shopp@gmail.com</a></div> <div class="company-line">© Все права защищены. 2025</div> </div> <div class="bottom-right">
        Сделано с любовью к ароматам
      </div> </div> <!-- Дисклеймер Instagram --> <div class="disclaimer">
      *Instagram — проект компании Meta Platforms Inc.,<br>
      деятельность которой запрещена на территории РФ
    </div> </div> </footer> <!-- nominify end --> </div> </div> </div> </div> <div id="rec1316940961" class="r t-rec" style=" " data-animationappear="off" data-record-type="131"> <!-- T123 --> <div class="t123"> <div class="t-container_100 "> <div class="t-width t-width_100 "> <!-- nominify begin --> <style>
  /* Прячем встроенную иконку личного кабинета */
  .tlk-userbar, .tlk__userbar { display: none !important; }

  /* ===== Компактный и чистый стиль меню ЛК ===== */
  .lkd {
    position: absolute;
    z-index: 999999;
    min-width: 240px;           /* было 280 */
    max-width: 92vw;
    background: #fff;
    border-radius: 10px;        /* было 12 */
    box-shadow: 0 10px 28px rgba(0,0,0,.12);
    padding: 10px 0;            /* было 14 */
    opacity: 0;
    pointer-events: none;
    transform: translateY(-6px);
    transition: opacity .15s ease, transform .15s ease;
  }
  .lkd.is-open { opacity: 1; pointer-events: auto; transform: translateY(0); }

  .lkd__header { padding: 4px 14px 8px; }
  .lkd__name   { font-weight: 700; font-size: 14px; line-height: 1.25; margin: 0 0 2px; } /* было 16 */
  .lkd__edit   { font-size: 12px; color: #8c8c8c; text-decoration: none; }                 /* было 13 */
  .lkd__sep    { height: 1px; background: #ececec; margin: 8px 0; }

  .lkd__list { list-style: none; margin: 0; padding: 0; }
  .lkd__item a,
  .lkd__item button {
    display: block;
    width: 100%;
    text-align: left;
    background: none;
    border: 0;
    font: inherit;
    padding: 9px 14px;          /* было 10x16 */
    text-decoration: none;
    color: #222;
    cursor: pointer;
    font-size: 13.5px;          /* было 14-16 */
    line-height: 1.3;
  }
  .lkd__item a:hover,
  .lkd__item button:hover { background: #f6f6f6; }

  /* Кнопка выхода — нейтральная, не «кричащая» */
  .lkd__logout { color: #444; }
  .lkd__logout:hover { background: #f6f6f6; }

  /* Гарантируем кликабельность иконки */
  #headerAccount, #headerAccount * { pointer-events: auto !important; cursor: pointer; }
</style> <script>
(function () {
  /* --- Ссылки: при необходимости поменяйте на свои --- */
  var LINKS = {
    profile:   '/members/profile',
    orders:    '/members/orders',
    purchases: '/members/purchases',
    login:     '/members/login',
    afterLogout: '/'             // куда отправлять после выхода
  };

  function ready(fn){ 
    if (document.readyState !== 'loading') fn(); 
    else document.addEventListener('DOMContentLoaded', fn);
  }

  function getProjectId() {
    var r = document.querySelector('#allrecords');
    return r && (r.dataset.tildaProjectId || r.getAttribute('data-tilda-project-id')) || '';
  }
  function getMembersProfile() {
    try {
      var raw = localStorage.getItem('tilda_members_profile' + getProjectId());
      return raw ? JSON.parse(raw) : null;
    } catch(e){ return null; }
  }
  function getUserName(p){
    if (!p) return 'Гость';
    var name = p.name || [p.firstname, p.lastname].filter(Boolean).join(' ').trim();
    return name || p.email || 'Профиль';
  }

  /* Мягкий и надёжный logout: пробуем официальный клик, затем URL, затем чистим localStorage */
  function logoutMembers(){
    try {
      var btn = document.querySelector('.tlk-userbar__logout, .tlk__userbar__logout, [data-tilda-logout]');
      if (btn) { btn.click(); return; } // триггерим родной обработчик, даже если бар скрыт
    } catch(e) {}

    // Пытаемся дернуть URL выхода (GET), не блокируя навигацию
    try { fetch('/members/logout', {credentials: 'include', mode: 'no-cors'}).catch(function(){}); } catch(e) {}

    // Чистим локальные данные Members — этого достаточно для фронтенд-гейтов
    try {
      var pid = getProjectId();
      localStorage.removeItem('tilda_members_profile' + pid);
      Object.keys(localStorage).forEach(function(k){
        if (/^tilda_?members?/i.test(k)) { try { localStorage.removeItem(k); } catch(e){} }
      });
    } catch(e){}

    setTimeout(function(){ window.location.href = LINKS.afterLogout || '/'; }, 80);
  }

  /* DOM дропдаун */
  function createDropdown(profile){
    var wrap = document.createElement('div');
    wrap.className = 'lkd';
    wrap.id = 'lkDropdown';

    var name = getUserName(profile);

    var headerHTML = profile ? (
      '<div class="lkd__header">' +
        '<div class="lkd__name">'+ name +'</div>' +
        '<a class="lkd__edit" href="'+ LINKS.profile +'">Редактировать профиль</a>' +
      '</div><div class="lkd__sep"></div>'
    ) : '';

    var list = '<ul class="lkd__list">';
    if (profile) {
      list +=
        '<li class="lkd__item"><a href="'+ (LINKS.profile || '#') +'">Личный кабинет</a></li>' +
        '<li class="lkd__item"><a href="'+ (LINKS.orders || LINKS.profile) +'">Мои заказы</a></li>' +
        '<li class="lkd__item"><a href="'+ (LINKS.purchases || LINKS.profile) +'">Купленные товары</a></li>' +
        '<div class="lkd__sep"></div>' +
        '<li class="lkd__item"><button type="button" class="lkd__logout" id="lkdLogoutBtn">Выйти</button></li>';
    } else {
      list += '<li class="lkd__item"><a href="'+ LINKS.login +'">Войти / Регистрация</a></li>';
    }
    list += '</ul>';

    wrap.innerHTML = headerHTML + list;
    document.body.appendChild(wrap);

    // навешиваем logout
    var outBtn = wrap.querySelector('#lkdLogoutBtn');
    if (outBtn) outBtn.addEventListener('click', function(e){
      e.preventDefault();
      logoutMembers();
    });

    return wrap;
  }

  /* Позиционируем под иконкой (по правому краю) */
  function positionDropdown(drop, anchor){
    var r = anchor.getBoundingClientRect();
    var top  = r.bottom + window.scrollY + 8;
    var left = r.right  + window.scrollX - drop.offsetWidth;
    if (left < 8) left = 8;
    drop.style.top  = top + 'px';
    drop.style.left = left + 'px';
  }

  ready(function(){
    var acc = document.getElementById('headerAccount');
    if (!acc) return;

    // Снимаем чужие обработчики на иконке
    var clean = acc.cloneNode(true);
    acc.parentNode.replaceChild(clean, acc);
    acc = clean;

    var profile = getMembersProfile();
    var drop = createDropdown(profile);
    var isOpen = false;

    function open(){
      positionDropdown(drop, acc);
      drop.classList.add('is-open');
      isOpen = true;
      setTimeout(function(){
        document.addEventListener('click', outside, { once:true });
      },0);
    }
    function close(){ drop.classList.remove('is-open'); isOpen = false; }
    function outside(e){ if (!drop.contains(e.target) && e.target !== acc && !acc.contains(e.target)) close(); }
    function toggle(){ isOpen ? close() : open(); }

    acc.addEventListener('click', function(e){ e.preventDefault(); toggle(); });
    window.addEventListener('resize', function(){ if (isOpen) positionDropdown(drop, acc); });
    window.addEventListener('scroll', function(){ if (isOpen) positionDropdown(drop, acc); }, {passive:true});

    // Подстраховка для несуществующих страниц
    document.addEventListener('click', function(e){
      var a = e.target.closest('.lkd__item a');
      if (!a) return;
      ['orders','purchases'].forEach(function(key){
        if (a.getAttribute('href') === LINKS[key] && !LINKS[key]) {
          a.setAttribute('href', LINKS.profile || LINKS.login || '/');
        }
      });
    });

    // Закрытие по Esc
    document.addEventListener('keydown', function(e){ if (e.key === 'Escape' && isOpen) close(); });
  });
})();
</script> <!-- nominify end --> </div> </div> </div> </div> <div id="rec1535166801" class="r t-rec" style=" " data-animationappear="off" data-record-type="131"> <!-- T123 --> <div class="t123"> <div class="t-container_100 "> <div class="t-width t-width_100 "> <!-- nominify begin --> <!-- Скрытие Made in Tilda --> <style>
  /* на всякий случай убираем нижние отступы контейнеров */
  html, body { margin-bottom:0 !important; }
  #allrecords, .t-records { padding-bottom:0 !important; }
</style> <script>
(function(){
  if (window.HS_KILL_TILDA_LABEL_BLOCK) return;
  window.HS_KILL_TILDA_LABEL_BLOCK = true;

  function hide(el){
    if (!el) return;
    el.style.setProperty('display','none','important');
    el.style.setProperty('visibility','hidden','important');
    el.style.setProperty('opacity','0','important');
    el.style.setProperty('height','0','important');
    el.style.setProperty('margin','0','important');
    el.style.setProperty('padding','0','important');
    el.setAttribute('aria-hidden','true');
  }

  function isDark(c){
    if (!c) return false;
    var m = c.match(/rgba?\((\d+),\s*(\d+),\s*(\d+)/i);
    if (!m) return false;
    var r=+m[1], g=+m[2], b=+m[3];
    var lum = (0.2126*r + 0.7152*g + 0.0722*b)/255;
    return lum < 0.08; // почти чёрный
  }

  function kill(){
    // 1) сам лейбл «Made on Tilda» и его обёртки
    var selectors = '.t-tildalаbеl, .t-tildalаbеl__wrapper, .t-tildalаbеl__container, a[href*="tilda.cc"][class*="tildalabel"]';
    document.querySelectorAll(selectors).forEach(function(node){
      var rec = node.closest('.t-rec');
      // если запись состоит только из лейбла — прячем целиком
      if (rec && rec.querySelectorAll(selectors).length && rec.querySelectorAll('*').length === rec.querySelectorAll(selectors).length){
        hide(rec);
      }
      hide(node);
    });

    // 2) чёрная полоса/контейнер вокруг лейбла (если остался)
    // проверяем последние записи: маленькая высота + тёмный фон => скрыть
    Array.from(document.querySelectorAll('#allrecords .t-rec')).reverse().slice(0,6).forEach(function(rec){
      var h = rec.getBoundingClientRect().height;
      var bg = getComputedStyle(rec).backgroundColor;
      var bgChild = rec.firstElementChild ? getComputedStyle(rec.firstElementChild).backgroundColor : '';
      if (h <= 180 && (isDark(bg) || isDark(bgChild))) hide(rec);
    });

    // 3) запасной вариант: любые верхние/нижние полосы с текстом «made on tilda»
    document.querySelectorAll('div,section,footer,header').forEach(function(el){
      if (el.offsetHeight <= 180){
        var txt = (el.textContent || '').toLowerCase();
        if ((txt.includes('made on tilda') || txt.includes('made in tilda')) && isDark(getComputedStyle(el).backgroundColor)){
          hide(el);
        }
      }
    });
  }

  if (document.readyState !== 'loading') kill();
  document.addEventListener('DOMContentLoaded', kill);
  window.addEventListener('load', kill);
  new MutationObserver(kill).observe(document.body, { childList:true, subtree:true });
})();
</script> <!-- nominify end --> </div> </div> </div> </div> </footer> <!--/footer--> </div> <!--/allrecords--> <!-- Tilda copyright. Don't remove this line --><div class="t-tildalabel " id="tildacopy" data-tilda-sign="13964339#72607081"><a href="https://tilda.cc/" class="t-tildalabel__link"><div class="t-tildalabel__wrapper"><div class="t-tildalabel__txtleft">Made on </div><div class="t-tildalabel__wrapimg"><img src="https://static.tildacdn.com/img/tildacopy.png" class="t-tildalabel__img" fetchpriority="low" alt=""></div><div class="t-tildalabel__txtright">Tilda</div></div></a></div> <!-- Stat --> <script type="text/javascript">if(!window.mainTracker) {window.mainTracker='tilda';}
window.tildastatcookie='no';setTimeout(function(){(function(d,w,k,o,g) {var n=d.getElementsByTagName(o)[0],s=d.createElement(o),f=function(){n.parentNode.insertBefore(s,n);};s.type="text/javascript";s.async=true;s.key=k;s.id="tildastatscript";s.src=g;if(w.opera=="[object Opera]") {d.addEventListener("DOMContentLoaded",f,false);} else {f();}})(document,window,'fcd795906d55a007e75c811a088893dc','script','https://static.tildacdn.com/js/tilda-stat-1.0.min.js');},2000);</script> </body> </html>